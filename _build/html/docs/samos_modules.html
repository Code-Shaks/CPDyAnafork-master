<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>SAMOS Modules &#8212; CPDyAna 01-02-2014 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=b59d7fc8"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="samos-modules">
<h1>SAMOS Modules<a class="headerlink" href="#samos-modules" title="Link to this heading">¶</a></h1>
<p>The SAMOS (Statistical Analysis of MOlecular Simulations) modules provide advanced trajectory analysis capabilities for molecular dynamics simulations. These modules offer high-performance analysis tools with support for multiple file formats and statistical methods.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>The SAMOS modules consist of:</p>
<ul class="simple">
<li><p><strong>Analysis Tools</strong>: Core statistical analysis functions for MD trajectories</p></li>
<li><p><strong>I/O Operations</strong>: Reading and writing various trajectory formats (LAMMPS, XSF, etc.)</p></li>
<li><p><strong>Plotting Utilities</strong>: Visualization functions for analysis results</p></li>
<li><p><strong>Trajectory Handling</strong>: Advanced trajectory manipulation and processing</p></li>
<li><p><strong>Utility Functions</strong>: Helper functions for common MD analysis tasks</p></li>
</ul>
</section>
<section id="core-analysis-module">
<h2>Core Analysis Module<a class="headerlink" href="#core-analysis-module" title="Link to this heading">¶</a></h2>
<p>The main analysis module provides high-level functions for common MD analyses.</p>
<section id="core-analysis-module-for-samos">
<span id="module-samos_modules.samos_analysis"></span><h3>Core Analysis Module for SAMOS<a class="headerlink" href="#core-analysis-module-for-samos" title="Link to this heading">¶</a></h3>
<p>This module provides the main analysis classes and functions for the SAMOS
(Statistical Analysis of MOlecular Simulations) package. It implements
high-performance algorithms for common molecular dynamics analysis tasks.</p>
<p>Key Features:
- Mean Square Displacement (MSD) calculations
- Radial Distribution Functions (RDF)
- Velocity Autocorrelation Functions (VAF)
- Vibrational Density of States (VDOS)
- Angular momentum analysis
- Time series analysis utilities</p>
<p>The module is designed for efficiency with large trajectory datasets and
provides both object-oriented and functional interfaces for flexibility.</p>
<dl class="simple">
<dt>Classes:</dt><dd><p>BaseAnalyzer: Abstract base class for analysis tools
DynamicsAnalyzer: Comprehensive dynamics analysis
RDF: Radial distribution function calculator
AngularSpectrum: Angular momentum analysis
TimeSeries: Time series analysis utilities</p>
</dd>
<dt>Functions:</dt><dd><p>util_msd: High-level MSD calculation interface
util_rdf_and_plot: RDF calculation with plotting
get_gaussian_density: Gaussian density field generation</p>
</dd>
</dl>
<p>Author: SAMOS Development Team
Version: 01-02-2024</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.AngularSpectrum">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">samos_modules.samos_analysis.</span></span><span class="sig-name descname"><span class="pre">AngularSpectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.AngularSpectrum" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#samos_modules.samos_analysis.BaseAnalyzer" title="samos_modules.samos_analysis.BaseAnalyzer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAnalyzer</span></code></a></p>
<p>Angular momentum spectrum analyzer.</p>
<p>This class analyzes rotational dynamics and angular momentum
distributions in molecular systems.</p>
<dl class="py method">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.AngularSpectrum.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_pairs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.AngularSpectrum.run" title="Link to this definition">¶</a></dt>
<dd><p>Calculate angular momentum spectrum.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>dict: Angular spectrum data.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.BaseAnalyzer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">samos_modules.samos_analysis.</span></span><span class="sig-name descname"><span class="pre">BaseAnalyzer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.BaseAnalyzer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract base class for molecular dynamics analysis tools.</p>
<p>This class provides a common interface for all analysis tools in SAMOS,
ensuring consistent API design and functionality across different analysis types.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>trajectory (list): List of ASE Atoms objects representing the trajectory.
verbose (bool): Whether to print progress information.</p>
</dd>
<dt>Methods:</dt><dd><p>set_trajectory: Set the trajectory for analysis
run: Perform the analysis (abstract method)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.BaseAnalyzer.run">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.BaseAnalyzer.run" title="Link to this definition">¶</a></dt>
<dd><p>Perform the analysis. Must be implemented by subclasses.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>Analysis results (format depends on specific analyzer).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.BaseAnalyzer.set_trajectory">
<span class="sig-name descname"><span class="pre">set_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.BaseAnalyzer.set_trajectory" title="Link to this definition">¶</a></dt>
<dd><p>Set the trajectory for analysis.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>trajectory (list): List of ASE Atoms objects.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.DynamicsAnalyzer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">samos_modules.samos_analysis.</span></span><span class="sig-name descname"><span class="pre">DynamicsAnalyzer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.DynamicsAnalyzer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Comprehensive analyzer for particle dynamics in molecular simulations.</p>
<p>This class provides a unified interface for calculating various dynamic
properties including MSD, VAF, and related quantities. It handles multiple
species analysis and provides statistical error estimation.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>species_of_interest (list): Chemical species to analyze.
verbosity_level (int): Level of output detail.
trajectories (list): Multiple trajectory datasets.</p>
</dd>
<dt>Methods:</dt><dd><p>get_msd: Calculate mean square displacement
get_vaf: Calculate velocity autocorrelation function
get_power_spectrum: Calculate power spectrum from VAF
get_kinetic_energies: Calculate kinetic energy time series
set_species_of_interest: Set target species for analysis</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.DynamicsAnalyzer.get_kinetic_energies">
<span class="sig-name descname"><span class="pre">get_kinetic_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decompose_system</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decompose_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decompose_species</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.DynamicsAnalyzer.get_kinetic_energies" title="Link to this definition">¶</a></dt>
<dd><p>Calculate kinetic energy time series for specified species.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>stepsize (int): Step size for sampling.
species (list, optional): Species to analyze.</p>
</dd>
<dt>Returns:</dt><dd><p>dict: Kinetic energy data for each species.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.DynamicsAnalyzer.get_msd">
<span class="sig-name descname"><span class="pre">get_msd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decomposed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.DynamicsAnalyzer.get_msd" title="Link to this definition">¶</a></dt>
<dd><p>Calculate Mean Square Displacement for specified species.</p>
<p>This method computes MSD using an efficient algorithm that handles
large trajectories. It supports both single and multiple species
analysis with automatic error estimation.</p>
<dl>
<dt>Args:</dt><dd><p>decomposed (bool): Whether to decompose MSD by directions.
atom_indices (list, optional): Specific atom indices to analyze.
stepsize_t (int, optional): Step size for trajectory sampling (default: 1).</p>
<blockquote>
<div><p>Use larger values for faster computation on large trajectories.</p>
</div></blockquote>
<dl class="simple">
<dt>species_of_interest (list, optional): List of species to analyze.</dt><dd><p>If None, uses self.species_of_interest.</p>
</dd>
</dl>
<p>t_start_fit_ps (float, optional): Start time for diffusion coefficient fit.
t_end_fit_ps (float, optional): End time for diffusion coefficient fit.
nr_of_blocks (int, optional): Number of blocks for statistical analysis.</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>TimeSeries: MSD data containing:</dt><dd><ul class="simple">
<li><p>t_list_fs: Time array in femtoseconds</p></li>
<li><p>msd_isotropic_X_mean: Mean MSD values for species X</p></li>
<li><p>msd_isotropic_X_std: Standard deviation of MSD for species X</p></li>
<li><p>slope_msd_mean: Fitted slope values (proportional to diffusion coefficient)</p></li>
<li><p>diffusion_mean_cm2_s: Calculated diffusion coefficients in cm²/s</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><p>ValueError: If no trajectory is set or species list is empty.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">analyzer</span> <span class="o">=</span> <span class="n">DynamicsAnalyzer</span><span class="p">(</span><span class="n">trajectory</span><span class="p">,</span> <span class="n">species_of_interest</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Li&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msd_data</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">get_msd</span><span class="p">(</span><span class="n">stepsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Li diffusion coefficient: </span><span class="si">{</span><span class="n">msd_data</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s1">&#39;Li&#39;</span><span class="p">)[</span><span class="s1">&#39;diffusion_mean_cm2_s&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Note:</dt><dd><p>MSD is calculated using the efficient FFT-based algorithm for
improved performance on large datasets.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.DynamicsAnalyzer.get_power_spectrum">
<span class="sig-name descname"><span class="pre">get_power_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrayname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.DynamicsAnalyzer.get_power_spectrum" title="Link to this definition">¶</a></dt>
<dd><p>Calculate power spectrum from velocity autocorrelation function.</p>
<p>The power spectrum is obtained by Fourier transform of the VAF and
represents the vibrational density of states (VDOS).</p>
<dl>
<dt>Args:</dt><dd><p>arrayname (str, optional): Name of custom velocity array to use.
stepsize_t (int, optional): Step size for trajectory sampling.
species_of_interest (list, optional): Species to analyze.
smothening (int, optional): Level of smoothing to apply.
nr_of_blocks (int, optional): Number of blocks for statistical analysis.
block_length_dt/fs/ps (int/float, optional): Block length in different units.</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>TimeSeries: Power spectrum data with:</dt><dd><ul class="simple">
<li><p>frequency: Frequency arrays in THz</p></li>
<li><p>periodogram: Power spectrum intensity</p></li>
<li><p>periodogram_mean/std/sem: Statistical metrics across blocks</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">get_power_spectrum</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Li&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot VDOS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spectrum</span><span class="p">[</span><span class="s1">&#39;frequency&#39;</span><span class="p">],</span> <span class="n">spectrum</span><span class="p">[</span><span class="s1">&#39;intensity&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.DynamicsAnalyzer.get_species_of_interest">
<span class="sig-name descname"><span class="pre">get_species_of_interest</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.DynamicsAnalyzer.get_species_of_interest" title="Link to this definition">¶</a></dt>
<dd><p>Get the current list of species being analyzed.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>list: Current species of interest.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.DynamicsAnalyzer.get_vaf">
<span class="sig-name descname"><span class="pre">get_vaf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrayname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'trapezoid'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.DynamicsAnalyzer.get_vaf" title="Link to this definition">¶</a></dt>
<dd><p>Calculate Velocity Autocorrelation Function for specified species.</p>
<p>This method computes VAF which provides insights into particle dynamics
and can be used to calculate diffusion coefficients and vibrational
density of states.</p>
<dl>
<dt>Args:</dt><dd><p>arrayname (str, optional): Name of custom velocity array to use.
integration (str): Integration method (‘trapezoid’, ‘simpson’, etc.).
stepsize_t (int, optional): Step size for trajectory sampling.
species_of_interest (list, optional): Species to analyze.
t_start_fit_dt (int, optional): Start time for statistical fitting.
t_end_fit_dt (int, optional): End time for statistical fitting.
nr_of_blocks (int, optional): Number of blocks for statistical analysis.</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>TimeSeries: VAF data containing:</dt><dd><ul class="simple">
<li><p>vaf_isotropic_X_mean: Mean VAF values for species X</p></li>
<li><p>vaf_isotropic_X_std: Standard deviation of VAF for species X</p></li>
<li><p>vaf_integral_isotropic_X_mean: Integral of VAF (proportional to diffusion)</p></li>
<li><p>diffusion_mean_cm2_s: Calculated diffusion coefficients in cm²/s</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vaf_data</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">get_vaf</span><span class="p">(</span><span class="n">stepsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Li&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># VAF at time zero should be proportional to temperature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;VAF(0) = </span><span class="si">{</span><span class="n">vaf_data</span><span class="o">.</span><span class="n">get_array</span><span class="p">(</span><span class="s1">&#39;vaf_isotropic_Li_mean&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.DynamicsAnalyzer.set_species_of_interest">
<span class="sig-name descname"><span class="pre">set_species_of_interest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species_of_interest</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.DynamicsAnalyzer.set_species_of_interest" title="Link to this definition">¶</a></dt>
<dd><p>Set the chemical species to be analyzed.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>species_list (list): List of chemical symbols (e.g., [‘Li’, ‘Na’]).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.DynamicsAnalyzer.set_trajectories">
<span class="sig-name descname"><span class="pre">set_trajectories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.DynamicsAnalyzer.set_trajectories" title="Link to this definition">¶</a></dt>
<dd><p>Set multiple trajectories for ensemble analysis.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>trajectory_list (list): List of trajectory datasets.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.DynamicsAnalyzer.set_verbosity">
<span class="sig-name descname"><span class="pre">set_verbosity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbosity</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.DynamicsAnalyzer.set_verbosity" title="Link to this definition">¶</a></dt>
<dd><p>Set the verbosity level for output.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>level (int): Verbosity level (0=quiet, 1=normal, 2=verbose).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.RDF">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">samos_modules.samos_analysis.</span></span><span class="sig-name descname"><span class="pre">RDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.RDF" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#samos_modules.samos_analysis.BaseAnalyzer" title="samos_modules.samos_analysis.BaseAnalyzer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAnalyzer</span></code></a></p>
<p>Radial Distribution Function calculator.</p>
<p>This class computes pair correlation functions (RDF) for specified
atom pairs in molecular dynamics trajectories. It supports both
partial and total RDFs with proper normalization.</p>
<dl class="simple">
<dt>Methods:</dt><dd><p>run: Calculate RDF
run_fort: Use Fortran backend for acceleration (if available)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.RDF.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_pairs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.RDF.run" title="Link to this definition">¶</a></dt>
<dd><p>Calculate radial distribution function (RDF).</p>
<p>This method computes pair correlation functions between specified atom types,
properly accounting for periodic boundary conditions.</p>
<dl>
<dt>Args:</dt><dd><p>radius (float): Maximum radial distance to consider.
species_pairs (list, optional): List of tuples with species pairs to analyze.</p>
<blockquote>
<div><p>If None, all unique pairs will be analyzed.</p>
</div></blockquote>
<p>istart (int): First frame index to include.
istop (int, optional): Last frame index to include. If None, use all frames.
stepsize (int): Step size for frame sampling.
nbins (int): Number of radial bins for the histogram.</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>AttributedArray: Results containing:</dt><dd><ul class="simple">
<li><p>rdf_X_Y: RDF values for species X and Y</p></li>
<li><p>int_X_Y: Integrated RDF (coordination number)</p></li>
<li><p>radii_X_Y: Radial distance values</p></li>
<li><p>n_pairs_X_Y: Number of atomic pairs analyzed</p></li>
<li><p>n_data_X_Y: Total number of data points used</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Note:</dt><dd><p>For non-orthogonal cells, the algorithm may need many periodic images
to properly account for all pairs within the cutoff distance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.RDF.run_fort">
<span class="sig-name descname"><span class="pre">run_fort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_pairs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.RDF.run_fort" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>radius</strong> (<em>float</em>) – The radius for the calculation of the RDF</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.TimeSeries">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">samos_modules.samos_analysis.</span></span><span class="sig-name descname"><span class="pre">TimeSeries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.TimeSeries" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AttributedArray</span></code></p>
<p>Time series analysis utilities.</p>
<p>This class provides tools for analyzing time-dependent properties
including autocorrelation functions, power spectra, and statistical
analysis.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.get_gaussian_density">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_analysis.</span></span><span class="sig-name descname"><span class="pre">get_gaussian_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'out.xsf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_exclude_from_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.get_gaussian_density" title="Link to this definition">¶</a></dt>
<dd><p>Generate Gaussian density field from atomic positions.</p>
<p>This function creates a 3D density field by placing Gaussian functions
at atomic positions. Useful for visualization and analysis of ionic
distributions.</p>
<dl>
<dt>Args:</dt><dd><p>trajectory (Trajectory): Trajectory object containing positions and cell.
element (str, optional): Element symbol to include in density calculation.
outputfile (str): Output XSF filename.
sigma (float): Gaussian width parameter in Ångstroms.
n_sigma (float): Number of sigma cutoff distance.
density (float): Grid density in points per Ångstrom.
istart (int): First frame to include.
istop (int, optional): Last frame to include. If None, use all frames.
stepsize (int): Step size for frame sampling.
indices (list, optional): Specific atom indices to include.
indices_exclude_from_plot (list, optional): Atom indices to exclude from XSF file.</p>
</dd>
<dt>Returns:</dt><dd><p>None: Writes density to XSF file.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Li density field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;trajectory.extxyz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_gaussian_density</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="s2">&quot;Li&quot;</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> 
<span class="gp">... </span>                    <span class="n">outputfile</span><span class="o">=</span><span class="s2">&quot;li_density.xsf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.util_msd">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_analysis.</span></span><span class="sig-name descname"><span class="pre">util_msd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_start_fit_ps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_end_fit_ps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nblocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.util_msd" title="Link to this definition">¶</a></dt>
<dd><p>High-level interface for MSD calculation with optional plotting.</p>
<p>This function provides a convenient way to calculate MSD from trajectory
files with automatic plotting and diffusion coefficient extraction.</p>
<dl>
<dt>Args:</dt><dd><p>trajectory_path (str): Path to trajectory file.
stepsize (int): Frame sampling interval.
species (list, optional): Species to analyze. If None, analyze all.
plot (bool): Whether to generate MSD plots.
savefig (str, optional): Filename to save plots.
t_start_fit_ps (float): Start time for diffusion coefficient fit in ps.
t_end_fit_ps (float): End time for diffusion coefficient fit in ps.
timestep (float, optional): Override timestep in fs. If None, read from file.
nblocks (int, optional): Number of blocks for error estimation.</p>
</dd>
<dt>Returns:</dt><dd><p>TimeSeries: MSD results with diffusion coefficients and optional plots.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate Li MSD with plotting</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">util_msd</span><span class="p">(</span><span class="s1">&#39;trajectory.extxyz&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                  <span class="n">stepsize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
<span class="gp">... </span>                  <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Li&#39;</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
<span class="gp">... </span>                  <span class="n">savefig</span><span class="o">=</span><span class="s1">&#39;li_msd.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;D_Li = </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s1">&#39;Li&#39;</span><span class="p">)[</span><span class="s1">&#39;diffusion_mean_cm2_s&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> cm²/s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.util_rdf_and_plot">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_analysis.</span></span><span class="sig-name descname"><span class="pre">util_rdf_and_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_pairs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">printrdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_int</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.util_rdf_and_plot" title="Link to this definition">¶</a></dt>
<dd><p>Calculate RDF with optional plotting functionality.</p>
<p>This function provides a high-level interface for RDF calculation
from trajectory files with automatic plotting capabilities.</p>
<dl>
<dt>Args:</dt><dd><p>trajectory_path (str): Path to trajectory file.
radius (float): Maximum distance for RDF calculation.
stepsize (int): Frame sampling interval.
bins (int): Number of radial bins.
species_pairs (list): Atom pairs to analyze as “A-B” strings.
plot (bool): Whether to generate RDF plots.
savefig (str, optional): Filename to save plots.
printrdf (str, optional): Prefix for RDF data output files.
no_int (bool): If True, don’t plot the integral.</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>AttributedArray: RDF data for all requested pairs, including:</dt><dd><ul class="simple">
<li><p>rdf_X_Y: RDF values for species X and Y</p></li>
<li><p>int_X_Y: Integral of RDF</p></li>
<li><p>radii_X_Y: Radial distance values</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate and plot Li-O RDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf_data</span> <span class="o">=</span> <span class="n">util_rdf_and_plot</span><span class="p">(</span><span class="s1">&#39;traj.extxyz&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">radius</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">species_pairs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Li-O&#39;</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">savefig</span><span class="o">=</span><span class="s1">&#39;li_o_rdf.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_analysis.write_xsf_header">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_analysis.</span></span><span class="sig-name descname"><span class="pre">write_xsf_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vals_per_line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfilename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_analysis.write_xsf_header" title="Link to this definition">¶</a></dt>
<dd><p>Write XSF file header for density data visualization.</p>
<p>This function writes the proper header information for XSF files
containing 3D scalar field data such as electron or ionic densities.</p>
<dl>
<dt>Args:</dt><dd><p>atoms (list): List of atomic symbols.
positions (np.ndarray): Atomic positions array.
cell (np.ndarray): Unit cell vectors (3x3 array).
data (np.ndarray): 3D grid data (can be None if providing dimensions separately).
vals_per_line (int): Number of values per line in output file.
outfilename (str, optional): Output filename. If None, prints to stdout.
<a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs: Additional parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>xdim, ydim, zdim (int): Grid dimensions if data is None</p></li>
</ul>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>None: Writes to file or stdout</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write XSF header to file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">write_xsf_header</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">density_grid</span><span class="p">,</span> 
<span class="gp">... </span>                <span class="n">outfilename</span><span class="o">=</span><span class="s1">&#39;density.xsf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<section id="key-functions">
<h3>Key Functions<a class="headerlink" href="#key-functions" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#samos_modules.samos_analysis.util_msd" title="samos_modules.samos_analysis.util_msd"><code class="xref py py-func docutils literal notranslate"><span class="pre">samos_modules.samos_analysis.util_msd()</span></code></a>: Mean Square Displacement calculation</p></li>
<li><p><a class="reference internal" href="#samos_modules.samos_analysis.util_rdf_and_plot" title="samos_modules.samos_analysis.util_rdf_and_plot"><code class="xref py py-func docutils literal notranslate"><span class="pre">samos_modules.samos_analysis.util_rdf_and_plot()</span></code></a>: Radial Distribution Function analysis</p></li>
<li><p><a class="reference internal" href="#samos_modules.samos_analysis.write_xsf_header" title="samos_modules.samos_analysis.write_xsf_header"><code class="xref py py-func docutils literal notranslate"><span class="pre">samos_modules.samos_analysis.write_xsf_header()</span></code></a>: XSF file writing utilities</p></li>
</ul>
</section>
</section>
<section id="i-o-operations-module">
<h2>I/O Operations Module<a class="headerlink" href="#i-o-operations-module" title="Link to this heading">¶</a></h2>
<p>Handles reading and writing of various trajectory and data formats.</p>
<section id="i-o-operations-module-for-samos">
<span id="module-samos_modules.samos_io"></span><h3>I/O Operations Module for SAMOS<a class="headerlink" href="#i-o-operations-module-for-samos" title="Link to this heading">¶</a></h3>
<p>This module provides comprehensive input/output functions for the SAMOS (Statistical
Analysis of MOlecular Simulations) package. It handles reading and writing of various
trajectory formats commonly used in molecular dynamics simulations.</p>
<p>Supported formats:
- LAMMPS dump files (.lammpstrj)
- Extended XYZ files (.extxyz) 
- XSF files for visualization (.xsf)
- ASE-compatible trajectory formats
- Grid data files for density analysis</p>
<p>The module includes functions for:
- Format detection and conversion
- Trajectory preprocessing and filtering
- Periodic boundary condition handling
- Unit conversions and coordinate transformations</p>
<p>Author: SAMOS Development Team
Version: 01-02-2024</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_io.get_indices">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_io.</span></span><span class="sig-name descname"><span class="pre">get_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postfix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_io.get_indices" title="Link to this definition">¶</a></dt>
<dd><p>Get atom indices for specified chemical species.</p>
<p>This function returns the indices of atoms belonging to specific
chemical species in an ASE Atoms object. Useful for selective
analysis of specific elements.</p>
<dl>
<dt>Args:</dt><dd><p>atoms (ase.Atoms): ASE Atoms object.
species (str or list): Chemical symbol(s) to search for.</p>
<blockquote>
<div><p>Can be single string (‘Li’) or list ([‘Li’, ‘Na’]).</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: Array of atom indices for the specified species.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span> <span class="o">=</span> <span class="n">read_positions_with_ase</span><span class="p">(</span><span class="s1">&#39;structure.xyz&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">li_indices</span> <span class="o">=</span> <span class="n">get_indices</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="s1">&#39;Li&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alkali_indices</span> <span class="o">=</span> <span class="n">get_indices</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Li&#39;</span><span class="p">,</span> <span class="s1">&#39;Na&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">li_indices</span><span class="p">)</span><span class="si">}</span><span class="s2"> Li atoms&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_io.get_position_indices">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_io.</span></span><span class="sig-name descname"><span class="pre">get_position_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_io.get_position_indices" title="Link to this definition">¶</a></dt>
<dd><p>Extract position indices for species across trajectory frames.</p>
<p>This function identifies and tracks atoms of specific species across
multiple trajectory frames, accounting for possible atom reordering
or addition/removal.</p>
<dl>
<dt>Args:</dt><dd><p>trajectory (list): List of ASE Atoms objects.
species (str or list): Chemical species to track.
frame_range (tuple, optional): (start, end) frame indices to process.</p>
<blockquote>
<div><p>If None, process all frames.</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>dict: Dictionary mapping frame indices to atom indices for each species.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">read_lammps_dump</span><span class="p">(</span><span class="s1">&#39;dump.lammpstrj&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Li&#39;</span><span class="p">,</span> <span class="s1">&#39;Al&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">li_indices</span> <span class="o">=</span> <span class="n">get_position_indices</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s1">&#39;Li&#39;</span><span class="p">,</span> <span class="n">frame_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Li atom tracking across </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">li_indices</span><span class="p">)</span><span class="si">}</span><span class="s2"> frames&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_io.get_thermo_props">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_io.</span></span><span class="sig-name descname"><span class="pre">get_thermo_props</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_io.get_thermo_props" title="Link to this definition">¶</a></dt>
<dd><p>Extract thermodynamic properties from simulation output files.</p>
<p>This function parses various MD output files to extract thermodynamic
quantities like temperature, pressure, energy, and volume.</p>
<dl>
<dt>Args:</dt><dd><p>filename (str): Path to simulation output file.
properties (list): List of property names to extract.</p>
<blockquote>
<div><p>Options: ‘temperature’, ‘pressure’, ‘energy’, ‘volume’, ‘enthalpy’.</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>dict: Dictionary containing time series of requested properties.</p>
</dd>
<dt>Raises:</dt><dd><p>FileNotFoundError: If the output file cannot be found.
ValueError: If requested properties are not available in the file.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">props</span> <span class="o">=</span> <span class="n">get_thermo_props</span><span class="p">(</span><span class="s1">&#39;md.log&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average temperature: </span><span class="si">{</span><span class="n">avg_temp</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> K&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_io.pos_2_absolute">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_io.</span></span><span class="sig-name descname"><span class="pre">pos_2_absolute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postype</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_io.pos_2_absolute" title="Link to this definition">¶</a></dt>
<dd><p>Convert fractional coordinates to absolute (Cartesian) coordinates.</p>
<p>This function transforms positions from fractional (scaled) coordinates
to absolute Cartesian coordinates using the provided unit cell vectors.</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>positions (np.ndarray): Position array in fractional coordinates</dt><dd><p>with shape (…, 3).</p>
</dd>
<dt>cell_vectors (np.ndarray): Unit cell vectors with shape (3, 3).</dt><dd><p>Each row represents one lattice vector [a, b, c].</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: Positions in Cartesian coordinates (same shape as input).</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Convert from fractional to Cartesian</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frac_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> 
<span class="gp">... </span>                 <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cart_pos</span> <span class="o">=</span> <span class="n">pos_2_absolute</span><span class="p">(</span><span class="n">frac_pos</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cart_pos</span><span class="p">)</span>  <span class="c1"># [[0, 0, 0], [5, 5, 5]]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_io.read_lammps_dump">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_io.</span></span><span class="sig-name descname"><span class="pre">read_lammps_dump</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermo_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermo_pe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermo_stress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_extxyz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_forces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_velocities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_keywords_dump</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_io.read_lammps_dump" title="Link to this definition">¶</a></dt>
<dd><p>Read LAMMPS dump file and convert to ASE trajectory format.</p>
<p>This function parses LAMMPS dump files containing atomic positions and converts
them to ASE Atoms objects. It handles periodic boundary conditions, atom ordering,
and provides options for format conversion.</p>
<dl>
<dt>Args:</dt><dd><p>filename (str): Path to LAMMPS dump file (.lammpstrj format).
elements (list): List of element symbols in order of atom types.</p>
<blockquote>
<div><p>Example: [‘Li’, ‘Al’, ‘P’, ‘S’, ‘O’] for types 1-5.</p>
</div></blockquote>
<p>timestep (float): Time step between frames in picoseconds (default: 0.001).
save_extxyz (bool): Whether to save trajectory in extended XYZ format.
outfile (str, optional): Output filename for saved trajectory.</p>
<blockquote>
<div><p>If None and save_extxyz=True, uses input filename with .extxyz extension.</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>list: List of ASE Atoms objects representing the trajectory frames.</p>
</dd>
<dt>Raises:</dt><dd><p>FileNotFoundError: If the LAMMPS dump file cannot be found.
ValueError: If the file format is invalid or element list is inconsistent.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read LAMMPS trajectory with 5 element types</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Li&#39;</span><span class="p">,</span> <span class="s1">&#39;Al&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">read_lammps_dump</span><span class="p">(</span><span class="s1">&#39;dump.lammpstrj&#39;</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="n">timestep</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Read </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span><span class="si">}</span><span class="s2"> frames with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2"> atoms each&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Save as extended XYZ for further analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">read_lammps_dump</span><span class="p">(</span><span class="s1">&#39;dump.lammpstrj&#39;</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> 
<span class="gp">... </span>                       <span class="n">save_extxyz</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="s1">&#39;trajectory.extxyz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Note:</dt><dd><ul class="simple">
<li><p>LAMMPS atom types are mapped to element symbols based on the order in the elements list</p></li>
<li><p>Periodic boundary conditions are automatically handled</p></li>
<li><p>The function assumes standard LAMMPS dump format with id, type, x, y, z columns</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_io.read_positions_with_ase">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_io.</span></span><span class="sig-name descname"><span class="pre">read_positions_with_ase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_io.read_positions_with_ase" title="Link to this definition">¶</a></dt>
<dd><p>Read atomic positions using ASE with automatic format detection.</p>
<p>This function provides a unified interface for reading various trajectory
formats using the ASE library. It automatically detects file formats
when possible and returns a list of Atoms objects.</p>
<dl>
<dt>Args:</dt><dd><p>filename (str): Path to trajectory file.
format (str, optional): Explicit format specification. If None,</p>
<blockquote>
<div><p>ASE will attempt to auto-detect the format.</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>list: List of ASE Atoms objects for each frame.</p>
</dd>
<dt>Raises:</dt><dd><p>FileNotFoundError: If the trajectory file cannot be found.
ValueError: If the file format cannot be determined or is unsupported.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read XYZ trajectory (auto-detection)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frames</span> <span class="o">=</span> <span class="n">read_positions_with_ase</span><span class="p">(</span><span class="s1">&#39;trajectory.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read with explicit format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frames</span> <span class="o">=</span> <span class="n">read_positions_with_ase</span><span class="p">(</span><span class="s1">&#39;OUTCAR&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;vasp-out&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span><span class="si">}</span><span class="s2"> frames&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_io.read_step_info">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_io.</span></span><span class="sig-name descname"><span class="pre">read_step_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lines</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lidx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_io.read_step_info" title="Link to this definition">¶</a></dt>
<dd><p>Read time step information from trajectory files.</p>
<p>This function extracts time step numbers and intervals from various
trajectory file formats to provide temporal information for analysis.</p>
<dl>
<dt>Args:</dt><dd><p>filename (str): Path to trajectory file.
format (str): File format (‘lammps’, ‘xyz’, ‘vasp’, etc.).</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple: (timesteps, time_interval) where:</dt><dd><ul class="simple">
<li><p>timesteps (np.ndarray): Array of time step numbers</p></li>
<li><p>time_interval (float): Time interval between steps</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">steps</span><span class="p">,</span> <span class="n">dt</span> <span class="o">=</span> <span class="n">read_step_info</span><span class="p">(</span><span class="s1">&#39;dump.lammpstrj&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;lammps&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total_time</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Simulation covers </span><span class="si">{</span><span class="n">total_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> time units&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_io.read_xsf">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_io.</span></span><span class="sig-name descname"><span class="pre">read_xsf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fold_positions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_io.read_xsf" title="Link to this definition">¶</a></dt>
<dd><p>Read XSF file and return ASE Atoms objects.</p>
<p>This function parses XSF files and converts them to ASE format for
further analysis. It handles both single structures and animated
(multi-frame) XSF files.</p>
<dl>
<dt>Args:</dt><dd><p>filename (str): Path to XSF file.</p>
</dd>
<dt>Returns:</dt><dd><p>list: List of ASE Atoms objects (single element for static structures).</p>
</dd>
<dt>Raises:</dt><dd><p>FileNotFoundError: If XSF file cannot be found.
ValueError: If file format is invalid.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">structures</span> <span class="o">=</span> <span class="n">read_xsf</span><span class="p">(</span><span class="s1">&#39;crystal.xsf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Read </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">structures</span><span class="p">)</span><span class="si">}</span><span class="s2"> structures&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">first_frame</span> <span class="o">=</span> <span class="n">structures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Formula: </span><span class="si">{</span><span class="n">first_frame</span><span class="o">.</span><span class="n">get_chemical_formula</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_io.write_grid">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_io.</span></span><span class="sig-name descname"><span class="pre">write_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfilename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vals_per_line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_io.write_grid" title="Link to this definition">¶</a></dt>
<dd><p>Write 3D grid data to file for visualization or further analysis.</p>
<p>This function outputs 3D scalar field data (such as electron density
or ionic density) in a format suitable for visualization programs.</p>
<dl>
<dt>Args:</dt><dd><p>filename (str): Output filename.
grid_data (np.ndarray): 3D grid data with shape (nx, ny, nz).
cell_vectors (np.ndarray): Unit cell vectors (3x3 array).
origin (np.ndarray, optional): Grid origin coordinates.</p>
<blockquote>
<div><p>If None, assumes origin at (0, 0, 0).</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write density grid for visualization</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">10.0</span>  <span class="c1"># 10x10x10 unit cell</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">write_grid</span><span class="p">(</span><span class="s1">&#39;density.grid&#39;</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_io.write_xsf">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_io.</span></span><span class="sig-name descname"><span class="pre">write_xsf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vals_per_line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfilename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_flattened</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_io.write_xsf" title="Link to this definition">¶</a></dt>
<dd><p>Write trajectory to XSF format for visualization.</p>
<p>XSF (XCrySDen Structure File) format is commonly used for crystal structure
visualization. This function writes a trajectory as an animated XSF file
that can be viewed in programs like XCrySDen or VESTA.</p>
<dl>
<dt>Args:</dt><dd><p>filename (str): Output XSF filename.
atoms_list (list): List of ASE Atoms objects to write.
comment (str): Comment string to include in the file header.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
<dt>Raises:</dt><dd><p>IOError: If file cannot be written.
ValueError: If atoms_list is empty or contains invalid data.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write trajectory for visualization</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frames</span> <span class="o">=</span> <span class="n">read_lammps_dump</span><span class="p">(</span><span class="s1">&#39;dump.lammpstrj&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Li&#39;</span><span class="p">,</span> <span class="s1">&#39;Al&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">write_xsf</span><span class="p">(</span><span class="s1">&#39;animation.xsf&#39;</span><span class="p">,</span> <span class="n">frames</span><span class="p">,</span> <span class="s2">&quot;Li-ion diffusion trajectory&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<section id="supported-formats">
<h3>Supported Formats<a class="headerlink" href="#supported-formats" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>LAMMPS Dump Files</strong>: <a class="reference internal" href="#samos_modules.samos_io.read_lammps_dump" title="samos_modules.samos_io.read_lammps_dump"><code class="xref py py-func docutils literal notranslate"><span class="pre">samos_modules.samos_io.read_lammps_dump()</span></code></a></p></li>
<li><p><strong>XSF Files</strong>: <a class="reference internal" href="#samos_modules.samos_io.read_xsf" title="samos_modules.samos_io.read_xsf"><code class="xref py py-func docutils literal notranslate"><span class="pre">samos_modules.samos_io.read_xsf()</span></code></a>, <a class="reference internal" href="#samos_modules.samos_io.write_xsf" title="samos_modules.samos_io.write_xsf"><code class="xref py py-func docutils literal notranslate"><span class="pre">samos_modules.samos_io.write_xsf()</span></code></a></p></li>
<li><p><strong>Trajectory Formats</strong>: Support for ASE-compatible formats</p></li>
</ul>
</section>
</section>
<section id="plotting-module">
<h2>Plotting Module<a class="headerlink" href="#plotting-module" title="Link to this heading">¶</a></h2>
<p>Visualization and plotting utilities for analysis results.</p>
<section id="samos-plotting-and-visualization-module">
<span id="module-samos_modules.samos_plotting"></span><h3>SAMOS Plotting and Visualization Module<a class="headerlink" href="#samos-plotting-and-visualization-module" title="Link to this heading">¶</a></h3>
<p>This module provides comprehensive plotting and visualization functions for
molecular dynamics analysis results. It creates publication-quality figures
for various analysis types including MSD, RDF, VAF, and spectral analysis.</p>
<dl class="simple">
<dt>Key Features:</dt><dd><ul class="simple">
<li><p>Mean Square Displacement (MSD) plotting with error bars</p></li>
<li><p>Radial Distribution Function (RDF) visualization</p></li>
<li><p>Velocity Autocorrelation Function (VAF) plots</p></li>
<li><p>Power spectrum and vibrational density of states plotting</p></li>
<li><p>Angular momentum and rotational analysis visualization</p></li>
<li><p>Customizable plot formatting and styling</p></li>
</ul>
</dd>
<dt>The module uses matplotlib for plotting with careful attention to:</dt><dd><ul class="simple">
<li><p>Publication-quality figure output</p></li>
<li><p>Consistent styling and formatting</p></li>
<li><p>Error bar representation</p></li>
<li><p>Multi-panel figure layouts</p></li>
<li><p>Color scheme management</p></li>
</ul>
</dd>
</dl>
<p>Author: SAMOS Development Team
Version: 2024</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_plotting.format_mean_err">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_plotting.</span></span><span class="sig-name descname"><span class="pre">format_mean_err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_plotting.format_mean_err" title="Link to this definition">¶</a></dt>
<dd><p>Format mean and error values for scientific notation display.</p>
<p>Creates properly formatted strings for displaying numerical results
with uncertainties, following scientific notation conventions.</p>
<dl>
<dt>Args:</dt><dd><p>mean (float): Mean value to format.
error (float): Error or uncertainty value.
precision (int, optional): Number of significant digits. Defaults to 2.</p>
</dd>
<dt>Returns:</dt><dd><p>str: Formatted string in the form “mean ± error”.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">format_mean_err</span><span class="p">(</span><span class="mf">1.234e-5</span><span class="p">,</span> <span class="mf">2.1e-6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>  <span class="c1"># &quot;1.23(21)×10⁻⁵&quot;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">format_mean_err</span><span class="p">(</span><span class="mf">0.00567</span><span class="p">,</span> <span class="mf">0.00012</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>  <span class="c1"># &quot;5.67 ± 0.12 ×10⁻³&quot;</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_plotting.my_format">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_plotting.</span></span><span class="sig-name descname"><span class="pre">my_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">real</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_plotting.my_format" title="Link to this definition">¶</a></dt>
<dd><p>Custom number formatter for matplotlib tick labels.</p>
<p>Provides consistent formatting for axis labels, handling scientific
notation and decimal places appropriately for publication figures.</p>
<dl>
<dt>Args:</dt><dd><p>x (float): Value to format.
pos (int): Position on the axis (unused but required by matplotlib).</p>
</dd>
<dt>Returns:</dt><dd><p>str: Formatted string representation of the value.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">formatter</span> <span class="o">=</span> <span class="n">FuncFormatter</span><span class="p">(</span><span class="n">my_format</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_plotting.plot_angular_spec">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_plotting.</span></span><span class="sig-name descname"><span class="pre">plot_angular_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angspec_res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_of_interest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_from_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_plotting.plot_angular_spec" title="Link to this definition">¶</a></dt>
<dd><p>Plot angular spectrum for rotational or orientational analysis.</p>
<p>Creates polar or Cartesian plots for analyzing angular distributions,
molecular orientations, or rotational dynamics.</p>
<dl>
<dt>Args:</dt><dd><p>theta_data (np.ndarray): Angular values in radians or degrees.
intensity_data (np.ndarray): Intensity or probability values.
save_path (str, optional): Path to save the figure.
figsize (tuple, optional): Figure size. Defaults to (10, 8).
polar (bool, optional): Use polar projection. Defaults to True.</p>
</dd>
<dt>Returns:</dt><dd><p>tuple: (figure, axis) objects.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensity</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">theta</span><span class="p">)</span>  <span class="c1"># p-orbital like</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_angular_spec</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">theta</span><span class="p">,</span> <span class="n">intensity</span><span class="p">,</span> <span class="n">polar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">save_path</span><span class="o">=</span><span class="s1">&#39;angular_distribution.png&#39;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_plotting.plot_msd_anisotropic">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_plotting.</span></span><span class="sig-name descname"><span class="pre">plot_msd_anisotropic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_of_interest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_from_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagonal_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_diagonal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_block_fits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_plotting.plot_msd_anisotropic" title="Link to this definition">¶</a></dt>
<dd><p>Plot anisotropic Mean Square Displacement for X, Y, Z directions.</p>
<p>Creates multi-panel plots showing directional MSD components,
useful for analyzing diffusion anisotropy in layered materials
or systems with preferred diffusion directions.</p>
<dl>
<dt>Args:</dt><dd><p>time_data (np.ndarray): Time values in picoseconds.
msd_data_x (dict): MSD data for X direction.
msd_data_y (dict): MSD data for Y direction.
msd_data_z (dict): MSD data for Z direction.
species_labels (list): Species names for legend.
save_path (str, optional): Path to save the figure.
figsize (tuple, optional): Figure size. Defaults to (12, 10).</p>
</dd>
<dt>Returns:</dt><dd><p>tuple: (figure, axes) objects for further customization.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># For layered material with anisotropic diffusion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plot_msd_anisotropic</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">time</span><span class="p">,</span> <span class="n">msd_x</span><span class="p">,</span> <span class="n">msd_y</span><span class="p">,</span> <span class="n">msd_z</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Li⁺&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">save_path</span><span class="o">=</span><span class="s1">&#39;msd_anisotropic.png&#39;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_plotting.plot_msd_isotropic">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_plotting.</span></span><span class="sig-name descname"><span class="pre">plot_msd_isotropic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_of_interest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_from_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_block_fits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_long</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_plotting.plot_msd_isotropic" title="Link to this definition">¶</a></dt>
<dd><p>Plot isotropic Mean Square Displacement with fitting lines.</p>
<p>Creates publication-quality MSD plots with linear fitting in the
diffusive regime, including error bars and diffusion coefficient
extraction.</p>
<dl>
<dt>Args:</dt><dd><p>time_data (np.ndarray): Time values in picoseconds.
msd_data (dict): Dictionary containing MSD data for different species.
species_labels (list): List of species names for legend.
colors (list, optional): Custom colors for each species.
save_path (str, optional): Path to save the figure.
figsize (tuple, optional): Figure size (width, height). Defaults to (10, 8).
show_fits (bool, optional): Whether to show linear fits. Defaults to True.</p>
</dd>
<dt>Returns:</dt><dd><p>tuple: (figure, axis) objects for further customization.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># ps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msd_li</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="n">time</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="n">time</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msd_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Li&#39;</span><span class="p">:</span> <span class="n">msd_li</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_msd_isotropic</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">time</span><span class="p">,</span> <span class="n">msd_data</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Li⁺&#39;</span><span class="p">],</span> 
<span class="gp">... </span>    <span class="n">save_path</span><span class="o">=</span><span class="s1">&#39;msd_isotropic.png&#39;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_plotting.plot_power_spectrum">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_plotting.</span></span><span class="sig-name descname"><span class="pre">plot_power_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">power_spectrum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_signals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_plotting.plot_power_spectrum" title="Link to this definition">¶</a></dt>
<dd><p>Plot power spectrum or vibrational density of states.</p>
<p>Creates frequency domain plots for vibrational analysis,
phonon density of states, and spectroscopic comparisons.</p>
<dl>
<dt>Args:</dt><dd><p>frequency_data (np.ndarray): Frequency values in THz or cm⁻¹.
spectrum_data (dict): Dictionary containing spectrum data.
species_labels (list): Species names for legend.
save_path (str, optional): Path to save the figure.
figsize (tuple, optional): Figure size. Defaults to (10, 8).
xlim (tuple, optional): X-axis limits for frequency range.
log_scale (bool, optional): Use logarithmic y-axis. Defaults to False.</p>
</dd>
<dt>Returns:</dt><dd><p>tuple: (figure, axis) objects.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># THz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">freq</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># Gaussian peak</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spectrum_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Li&#39;</span><span class="p">:</span> <span class="n">spectrum</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_power_spectrum</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">freq</span><span class="p">,</span> <span class="n">spectrum_data</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Li⁺&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">save_path</span><span class="o">=</span><span class="s1">&#39;vdos.png&#39;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_plotting.plot_rdf">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_plotting.</span></span><span class="sig-name descname"><span class="pre">plot_rdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rdf_res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_of_interest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_from_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_params2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_int</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_plotting.plot_rdf" title="Link to this definition">¶</a></dt>
<dd><p>Plot Radial Distribution Functions for multiple atom pairs.</p>
<p>Creates publication-quality RDF plots with proper normalization
and peak identification for structural analysis.</p>
<dl>
<dt>Args:</dt><dd><p>r_data (np.ndarray): Radial distance values in Angstroms.
rdf_data (dict): Dictionary containing RDF data for different pairs.
pair_labels (list): List of pair labels (e.g., [‘Li-Li’, ‘Li-O’]).
save_path (str, optional): Path to save the figure.
figsize (tuple, optional): Figure size. Defaults to (10, 8).
xlim (tuple, optional): X-axis limits.
ylim (tuple, optional): Y-axis limits.</p>
</dd>
<dt>Returns:</dt><dd><p>tuple: (figure, axis) objects.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf_data</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Li-Li&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="mf">2.5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">0.1</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;Li-O&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="mf">1.9</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">0.1</span><span class="p">)</span> 
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_rdf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">rdf_data</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Li-Li&#39;</span><span class="p">,</span> <span class="s1">&#39;Li-O&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="samos_modules.samos_plotting.plot_vaf_isotropic">
<span class="sig-prename descclassname"><span class="pre">samos_modules.samos_plotting.</span></span><span class="sig-name descname"><span class="pre">plot_vaf_isotropic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vaf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_of_interest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jmol'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#samos_modules.samos_plotting.plot_vaf_isotropic" title="Link to this definition">¶</a></dt>
<dd><p>Plot Velocity Autocorrelation Functions with diffusion analysis.</p>
<p>Creates VAF plots with integration to calculate diffusion coefficients
via the Green-Kubo relation.</p>
<dl>
<dt>Args:</dt><dd><p>time_data (np.ndarray): Time values in picoseconds.
vaf_data (dict): Dictionary containing VAF data.
species_labels (list): Species names for legend.
save_path (str, optional): Path to save the figure.
figsize (tuple, optional): Figure size. Defaults to (10, 8).
show_integral (bool, optional): Whether to show running integral.</p>
</dd>
<dt>Returns:</dt><dd><p>tuple: (figure, axis) objects.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vaf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">time</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">time</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vaf_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Li&#39;</span><span class="p">:</span> <span class="n">vaf</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_vaf_isotropic</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">time</span><span class="p">,</span> <span class="n">vaf_data</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Li⁺&#39;</span><span class="p">],</span> 
<span class="gp">... </span>    <span class="n">show_integral</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</section>
<section id="compiled-extensions">
<h2>Compiled Extensions<a class="headerlink" href="#compiled-extensions" title="Link to this heading">¶</a></h2>
<p>The SAMOS modules include several compiled extensions for high-performance calculations:</p>
<ul class="simple">
<li><p><strong>gaussian_density.pyd</strong>: Gaussian density calculations</p></li>
<li><p><strong>mdutils.pyd</strong>: MD utility functions</p></li>
<li><p><strong>rdf.pyd</strong>: Optimized RDF calculations</p></li>
</ul>
<p>These compiled modules provide significant performance improvements for computationally intensive operations.</p>
</section>
<section id="usage-examples">
<h2>Usage Examples<a class="headerlink" href="#usage-examples" title="Link to this heading">¶</a></h2>
<section id="basic-msd-analysis-with-samos">
<h3>Basic MSD Analysis with SAMOS<a class="headerlink" href="#basic-msd-analysis-with-samos" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">samos_modules.samos_analysis</span><span class="w"> </span><span class="kn">import</span> <span class="n">util_msd</span>

<span class="c1"># Calculate MSD for Li ions</span>
<span class="n">util_msd</span><span class="p">(</span>
    <span class="n">trajectory_path</span><span class="o">=</span><span class="s1">&#39;trajectory.extxyz&#39;</span><span class="p">,</span>
    <span class="n">stepsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Li&#39;</span><span class="p">],</span>
    <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">savefig</span><span class="o">=</span><span class="s1">&#39;msd_li.png&#39;</span><span class="p">,</span>
    <span class="n">t_start_fit_ps</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">t_end_fit_ps</span><span class="o">=</span><span class="mi">50</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="rdf-calculation-and-plotting">
<h3>RDF Calculation and Plotting<a class="headerlink" href="#rdf-calculation-and-plotting" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">samos_modules.samos_analysis</span><span class="w"> </span><span class="kn">import</span> <span class="n">util_rdf_and_plot</span>

<span class="c1"># Compute and plot RDF for Li-O pairs</span>
<span class="n">util_rdf_and_plot</span><span class="p">(</span>
    <span class="n">trajectory_path</span><span class="o">=</span><span class="s1">&#39;trajectory.extxyz&#39;</span><span class="p">,</span>
    <span class="n">radius</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span>
    <span class="n">stepsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">bins</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">species_pairs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Li-O&#39;</span><span class="p">,</span> <span class="s1">&#39;Li-Li&#39;</span><span class="p">],</span>
    <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">savefig</span><span class="o">=</span><span class="s1">&#39;rdf_analysis.png&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="reading-lammps-trajectories">
<h3>Reading LAMMPS Trajectories<a class="headerlink" href="#reading-lammps-trajectories" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">samos_modules.samos_io</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_lammps_dump</span>

<span class="c1"># Read LAMMPS dump file and convert to trajectory</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">read_lammps_dump</span><span class="p">(</span>
    <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;dump.lammpstrj&#39;</span><span class="p">,</span>
    <span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Li&#39;</span><span class="p">,</span> <span class="s1">&#39;Al&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">],</span>
    <span class="n">timestep</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>  <span class="c1"># ps</span>
    <span class="n">save_extxyz</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">outfile</span><span class="o">=</span><span class="s1">&#39;converted.extxyz&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">CPDyAna</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Vinay Maithani.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/docs/samos_modules.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>