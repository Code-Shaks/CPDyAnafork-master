# CPDyAna: Comprehensive Postprocessing for Dynamics Analysis

## Overview
CPDyAna is a Python toolkit for analyzing molecular dynamics (MD) trajectories generated by Quantum ESPRESSO. It provides command-line tools and Python modules to compute and visualize:

- Mean Squared Displacement (MSD)
- Velocity Autocorrelation Function (VAF)
- Vibrational Density of States (VDOS)
- Radial Distribution Function (RDF)
- Van Hove correlation functions
- Ionic density maps
CPDyAna leverages ASE, pymatgen, and SAMOS for trajectory handling and analysis.
![image](https://github.com/user-attachments/assets/6c6c8748-bba0-44b5-a0d3-e154778a8d50)

## Features
- Trajectory conversion: Reads Quantum ESPRESSO .in, .pos, .cel, and .evp files.
- Flexible analysis: CLI and Python API for MSD, VAF, VDOS, RDF, and more.
- Element-specific analysis: Compute and plot properties for selected elements.
- Batch processing: Analyze multiple trajectories in a directory.
- Publication-quality plots: Automated plotting and export.


## Installation

- Clone this repository
```shell
git clone https://github.com/Code-Shaks/CPDyAnafork-master.git
cd CPDyAna
```
- Install dependencies:

  - Python 3.8+
  - ASE
  - pymatgen
  - numpy, matplotlib, scipy
You can install dependencies with:
```shell
pip install -e .
pip install pymatgen
```

## Usage
All options are run via the main driver
```shell
CPDyAna <mode> [options]
```
Modes:
- msd – Mean Squared Displacement
- vh – Van Hove correlation
- rdf – Radial Distribution Function
- vaf – Velocity Autocorrelation Function
- vdos – Vibrational Density of States
- ionic-density – Ionic density maps

Example: Compute MSD
```shell
CPDyAna msd --data-dir ./data -T 800 -e Li
```

Example: Van Hove correlation
```shell
CPDyAna vh --data-dir ./data -T 800 -e Li --correlation Self
```

Example: Compute RDF
```shell
CPDyAna rdf --data-dir ./data -T 800 --num-frames 100 --central-atom Li --pair-atoms Al P
```

Example: Velocity Autocorrelation Function
```shell
CPDyAna vaf --data-dir ./data --element Li Al
```

Example: Vibrational Density of States
```Shell
CPDyAna vaf --data-dir ./data --elements Li Al P S
```

Example: Ionic Density
```shell
CPDyAna ionic-density --data-dir ./data --element Li --sigma 0.2
```

Helper command
```shell
CPDyAna --help
CPDyAna <mode> --help
```

## Input File requirements
- .in – Quantum ESPRESSO input file (species)
- .pos – Atomic positions (trajectory)
- .cel – Cell parameters
- .evp – (Optional) Energies and time steps
All files should be in the same directory or specified via CLI.

