# CPDyAna: Comprehensive Postprocessing for Dynamics Analysis

## Overview
CPDyAna is a Python toolkit for analyzing molecular dynamics (MD) trajectories generated by Quantum ESPRESSO. It provides command-line tools and Python modules to compute and visualize:

- Mean Squared Displacement (MSD)
- Non Gaussian Parameter (NGP)
- Velocity Autocorrelation Function (VAF)
- Vibrational Density of States (VDOS)
- Radial Distribution Function (RDF)
- Van Hove correlation functions
- Ionic density maps

![image](https://github.com/user-attachments/assets/6c6c8748-bba0-44b5-a0d3-e154778a8d50)

## Features
- Multi-format trajectory support:** Reads Quantum ESPRESSO (`.in`, `.pos`, `.cel`, `.evp`), BOMD (`.trj`), LAMMPS (`.lammpstrj`, `.dump`, `.lmp`), XSF (`.xsf`), and generic ASE-compatible formats (`.xyz`, `.extxyz`, `.traj`). Also detects VASP (`OUTCAR`, `XDATCAR`), CP2K (`.pdb`, `.xyz`), and GROMACS (`.gro`, `.xtc`) files if present.
- Flexible analysis: CLI and Python API for MSD, VAF, VDOS, RDF, and more.
- Element-specific analysis: Compute and plot properties for selected elements.
- Batch processing: Analyze multiple trajectories in a directory.
- Publication-quality plots: Automated plotting and export.

## Installation

- Clone this repository
```shell
git clone https://github.com/Code-Shaks/CPDyAnafork-master.git
cd CPDyAna
```
- Install dependencies:

  - Python 3.8+
  - ASE
  - pymatgen
  - pymatgen-analysis-diffusion
  - numpy, matplotlib, scipy
You can install dependencies with:
```shell
pip install -e .
pip install pymatgen
pip install pymatgen-analysis-diffusion
```

## Usage
All options are run via the main driver
```shell
CPDyAna <mode> [options]
```
Modes:
- msd – Mean Squared Displacement
- vh – Van Hove correlation
- ngp - Non-Gaussian Parameter
- rdf – Radial Distribution Function
- vaf – Velocity Autocorrelation Function
- vdos – Vibrational Density of States
- ionic-density – Ionic density maps

Example: MSD
```shell
CPDyAna msd --data-dir <file path> -T 800 -e Li
```

Example: Van Hove correlation
```shell
CPDyAna vh --data-dir <file path> -T 800 -e Li --correlation Self
```

Example: NGP
```shell
CPDyAna ngp --data-dir <file path> -T 800 --initial-time 0 --final-time 200 
```

Example: RDF
```shell
CPDyAna rdf --data-dir <file path> -T 800 --num-frames 100 --central-atom Li --pair-atoms Al P
```

Example: Velocity Autocorrelation Function
```shell
CPDyAna vaf --data-dir <file path> --element Li Al
```

Example: Vibrational Density of States
```Shell
CPDyAna vaf --data-dir <file path> --elements Li Al P S
```

Example: Ionic Density
```shell
CPDyAna ionic-density --data-dir <file path> --element Li --sigma 0.2
```

Helper command
```shell
CPDyAna --help
CPDyAna <mode> --help
```

## Input File requirements
- For Quantum ESPRESSO: `.in`, `.pos`, `.cel`, `.evp` (all in the same directory)
- For BOMD: `.trj`
- For LAMMPS: `.lammpstrj`, `.dump`, or `.lmp` (with optional mapping files)
- For XSF, VASP, CP2K, GROMACS, or generic: Place files in the data directory; CPDyAna will auto-detect and process them.
All files should be in the same directory or specified via CLI.

## Citing & License

