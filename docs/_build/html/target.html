

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Target Package &mdash; CPDyAna 01-02-2024 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=18cd0f04"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Usage Examples" href="usage_Examples.html" />
    <link rel="prev" title="CPDyAna Documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            CPDyAna
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Target Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#main-analysis-driver">Main Analysis Driver</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cpdyana-combined-molecular-dynamics-analysis-tool">CPDyAna – Combined Molecular Dynamics Analysis Tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.CPDyAna.Job"><code class="docutils literal notranslate"><span class="pre">Job()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.CPDyAna.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.CPDyAna.parser"><code class="docutils literal notranslate"><span class="pre">parser()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#key-functions">Key Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#data-processing">Data Processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#general-data-processing-module-for-cpdyana">General Data Processing Module for CPDyAna</a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.data_processing.data_evaluator"><code class="docutils literal notranslate"><span class="pre">data_evaluator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.data_processing.find_terms"><code class="docutils literal notranslate"><span class="pre">find_terms()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.data_processing.segmenter_func"><code class="docutils literal notranslate"><span class="pre">segmenter_func()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#lammps-data-processing">LAMMPS Data Processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lammps-data-processing-module-for-cpdyana">LAMMPS Data Processing Module for CPDyAna</a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.data_processing_lammps.calculate_time_window_lammps"><code class="docutils literal notranslate"><span class="pre">calculate_time_window_lammps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.data_processing_lammps.data_evaluator_lammps"><code class="docutils literal notranslate"><span class="pre">data_evaluator_lammps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.data_processing_lammps.detect_lammps_format"><code class="docutils literal notranslate"><span class="pre">detect_lammps_format()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.data_processing_lammps.find_terms_lammps"><code class="docutils literal notranslate"><span class="pre">find_terms_lammps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.data_processing_lammps.is_lammps_simulation"><code class="docutils literal notranslate"><span class="pre">is_lammps_simulation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.data_processing_lammps.segmenter_func_lammps"><code class="docutils literal notranslate"><span class="pre">segmenter_func_lammps()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#input-output-operations">Input/Output Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#input-file-reader-module-for-cpdyana">Input File Reader Module for CPDyAna</a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.input_reader.detect_trajectory_format"><code class="docutils literal notranslate"><span class="pre">detect_trajectory_format()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.input_reader.export_verification_trajectory"><code class="docutils literal notranslate"><span class="pre">export_verification_trajectory()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.input_reader.generate_analysis_recommendations"><code class="docutils literal notranslate"><span class="pre">generate_analysis_recommendations()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.input_reader.has_type_column"><code class="docutils literal notranslate"><span class="pre">has_type_column()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.input_reader.read_bomd_trajectory"><code class="docutils literal notranslate"><span class="pre">read_bomd_trajectory()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.input_reader.read_cel_file"><code class="docutils literal notranslate"><span class="pre">read_cel_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.input_reader.read_evp_file"><code class="docutils literal notranslate"><span class="pre">read_evp_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.input_reader.read_ion_file"><code class="docutils literal notranslate"><span class="pre">read_ion_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.input_reader.read_ion_file_universal"><code class="docutils literal notranslate"><span class="pre">read_ion_file_universal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.input_reader.read_lammps_trajectory"><code class="docutils literal notranslate"><span class="pre">read_lammps_trajectory()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.input_reader.read_pos_file"><code class="docutils literal notranslate"><span class="pre">read_pos_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.io.get_indices"><code class="docutils literal notranslate"><span class="pre">get_indices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.io.get_position_indices"><code class="docutils literal notranslate"><span class="pre">get_position_indices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.io.get_thermo_props"><code class="docutils literal notranslate"><span class="pre">get_thermo_props()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.io.iter_lammps_dump"><code class="docutils literal notranslate"><span class="pre">iter_lammps_dump()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.io.pos_2_absolute"><code class="docutils literal notranslate"><span class="pre">pos_2_absolute()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.io.read_lammps_dump"><code class="docutils literal notranslate"><span class="pre">read_lammps_dump()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.io.read_positions_with_ase"><code class="docutils literal notranslate"><span class="pre">read_positions_with_ase()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.io.read_step_info"><code class="docutils literal notranslate"><span class="pre">read_step_info()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.io.read_xsf"><code class="docutils literal notranslate"><span class="pre">read_xsf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.io.write_grid"><code class="docutils literal notranslate"><span class="pre">write_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.io.write_xsf"><code class="docutils literal notranslate"><span class="pre">write_xsf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#supported-file-types">Supported File Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bomd-support">BOMD Support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#core-calculations">Core Calculations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#calculations-module-for-cpdyana">Calculations Module for CPDyAna</a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.calculations.calc_fft"><code class="docutils literal notranslate"><span class="pre">calc_fft()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.calculations.calc_msd_tracer"><code class="docutils literal notranslate"><span class="pre">calc_msd_tracer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.calculations.calc_ngp_tracer"><code class="docutils literal notranslate"><span class="pre">calc_ngp_tracer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.calculations.calculate_msd"><code class="docutils literal notranslate"><span class="pre">calculate_msd()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.calculations.calculate_msd_lammps"><code class="docutils literal notranslate"><span class="pre">calculate_msd_lammps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.calculations.calculate_msd_qe"><code class="docutils literal notranslate"><span class="pre">calculate_msd_qe()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.calculations.calculate_ngp"><code class="docutils literal notranslate"><span class="pre">calculate_ngp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.calculations.disp_sum"><code class="docutils literal notranslate"><span class="pre">disp_sum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.calculations.msd_charged"><code class="docutils literal notranslate"><span class="pre">msd_charged()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.calculations.msd_tracer"><code class="docutils literal notranslate"><span class="pre">msd_tracer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#analysis-types">Analysis Types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#correlation-analysis">Correlation Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#correlation-analysis-module-for-cpdyana">Correlation Analysis Module for CPDyAna</a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.correrelation_analysis.Van_Hove_distinct"><code class="docutils literal notranslate"><span class="pre">Van_Hove_distinct()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.correrelation_analysis.Van_Hove_self"><code class="docutils literal notranslate"><span class="pre">Van_Hove_self()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#correlation-types">Correlation Types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#rdf-computation">RDF Computation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_rdf.build_ase_trajectory"><code class="docutils literal notranslate"><span class="pre">build_ase_trajectory()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_rdf.build_bomd_trajectory"><code class="docutils literal notranslate"><span class="pre">build_bomd_trajectory()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_rdf.build_lammps_trajectory"><code class="docutils literal notranslate"><span class="pre">build_lammps_trajectory()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_rdf.compute_rdf"><code class="docutils literal notranslate"><span class="pre">compute_rdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_rdf.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#vaf-computation">VAF Computation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_vaf.build_bomd_trajectory"><code class="docutils literal notranslate"><span class="pre">build_bomd_trajectory()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_vaf.build_trajectory"><code class="docutils literal notranslate"><span class="pre">build_trajectory()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_vaf.compute_vaf"><code class="docutils literal notranslate"><span class="pre">compute_vaf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_vaf.convert_symbols_to_atomic_numbers"><code class="docutils literal notranslate"><span class="pre">convert_symbols_to_atomic_numbers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_vaf.finite_diff_velocities"><code class="docutils literal notranslate"><span class="pre">finite_diff_velocities()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#vdos-analysis">VDOS Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotting-and-visualization">Plotting and Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#plotting-and-visualization-module-for-cpdyana">Plotting and Visualization Module for CPDyAna</a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.centers_to_edges"><code class="docutils literal notranslate"><span class="pre">centers_to_edges()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.centers_to_edges_time"><code class="docutils literal notranslate"><span class="pre">centers_to_edges_time()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.int_or_float"><code class="docutils literal notranslate"><span class="pre">int_or_float()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.msd_plot"><code class="docutils literal notranslate"><span class="pre">msd_plot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.msd_plot_lammps"><code class="docutils literal notranslate"><span class="pre">msd_plot_lammps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.msd_plot_qe"><code class="docutils literal notranslate"><span class="pre">msd_plot_qe()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.ngp_plot"><code class="docutils literal notranslate"><span class="pre">ngp_plot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.parse_cli_args"><code class="docutils literal notranslate"><span class="pre">parse_cli_args()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.plot_angular_spec"><code class="docutils literal notranslate"><span class="pre">plot_angular_spec()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.plot_power_spectrum"><code class="docutils literal notranslate"><span class="pre">plot_power_spectrum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.plot_rdf"><code class="docutils literal notranslate"><span class="pre">plot_rdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.plot_vaf_isotropic"><code class="docutils literal notranslate"><span class="pre">plot_vaf_isotropic()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.van_hove_plot"><code class="docutils literal notranslate"><span class="pre">van_hove_plot()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#probability-density-analysis">Probability Density Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#probability-density-calculation-module-for-cpdyana">Probability Density Calculation Module for CPDyAna</a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.probability_density.build_bomd_trajectory"><code class="docutils literal notranslate"><span class="pre">build_bomd_trajectory()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.probability_density.build_lammps_trajectory"><code class="docutils literal notranslate"><span class="pre">build_lammps_trajectory()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.probability_density.build_trajectory"><code class="docutils literal notranslate"><span class="pre">build_trajectory()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.probability_density.calculate_probability_density"><code class="docutils literal notranslate"><span class="pre">calculate_probability_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.probability_density.convert_symbols_to_atomic_numbers"><code class="docutils literal notranslate"><span class="pre">convert_symbols_to_atomic_numbers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.probability_density.divide_chunks"><code class="docutils literal notranslate"><span class="pre">divide_chunks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.probability_density.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.probability_density.parse_mask"><code class="docutils literal notranslate"><span class="pre">parse_mask()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#trajectory-utilities">Trajectory Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#target.trajectory.IncompatibleTrajectoriesException"><code class="docutils literal notranslate"><span class="pre">IncompatibleTrajectoriesException</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.trajectory.Trajectory"><code class="docutils literal notranslate"><span class="pre">Trajectory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.atoms"><code class="docutils literal notranslate"><span class="pre">Trajectory.atoms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.types"><code class="docutils literal notranslate"><span class="pre">Trajectory.types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.nat"><code class="docutils literal notranslate"><span class="pre">Trajectory.nat</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.cell"><code class="docutils literal notranslate"><span class="pre">Trajectory.cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.nstep"><code class="docutils literal notranslate"><span class="pre">Trajectory.nstep</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.__init__"><code class="docutils literal notranslate"><span class="pre">Trajectory.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">Trajectory.atoms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.calculate_velocities_from_positions"><code class="docutils literal notranslate"><span class="pre">Trajectory.calculate_velocities_from_positions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">Trajectory.cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.from_atoms"><code class="docutils literal notranslate"><span class="pre">Trajectory.from_atoms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.get_ase_trajectory"><code class="docutils literal notranslate"><span class="pre">Trajectory.get_ase_trajectory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.get_atom_types"><code class="docutils literal notranslate"><span class="pre">Trajectory.get_atom_types()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.get_atoms"><code class="docutils literal notranslate"><span class="pre">Trajectory.get_atoms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.get_cells"><code class="docutils literal notranslate"><span class="pre">Trajectory.get_cells()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.get_forces"><code class="docutils literal notranslate"><span class="pre">Trajectory.get_forces()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.get_indices_of_species"><code class="docutils literal notranslate"><span class="pre">Trajectory.get_indices_of_species()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.get_positions"><code class="docutils literal notranslate"><span class="pre">Trajectory.get_positions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.get_step_atoms"><code class="docutils literal notranslate"><span class="pre">Trajectory.get_step_atoms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.get_stress"><code class="docutils literal notranslate"><span class="pre">Trajectory.get_stress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.get_timestep"><code class="docutils literal notranslate"><span class="pre">Trajectory.get_timestep()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.get_types"><code class="docutils literal notranslate"><span class="pre">Trajectory.get_types()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.get_velocities"><code class="docutils literal notranslate"><span class="pre">Trajectory.get_velocities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.get_volumes"><code class="docutils literal notranslate"><span class="pre">Trajectory.get_volumes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">Trajectory.nat</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.recenter"><code class="docutils literal notranslate"><span class="pre">Trajectory.recenter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.set_atom_types"><code class="docutils literal notranslate"><span class="pre">Trajectory.set_atom_types()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.set_atoms"><code class="docutils literal notranslate"><span class="pre">Trajectory.set_atoms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.set_cells"><code class="docutils literal notranslate"><span class="pre">Trajectory.set_cells()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.set_forces"><code class="docutils literal notranslate"><span class="pre">Trajectory.set_forces()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.set_positions"><code class="docutils literal notranslate"><span class="pre">Trajectory.set_positions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.set_pot_energies"><code class="docutils literal notranslate"><span class="pre">Trajectory.set_pot_energies()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.set_stress"><code class="docutils literal notranslate"><span class="pre">Trajectory.set_stress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.set_timestep"><code class="docutils literal notranslate"><span class="pre">Trajectory.set_timestep()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.set_types"><code class="docutils literal notranslate"><span class="pre">Trajectory.set_types()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.trajectory.Trajectory.set_velocities"><code class="docutils literal notranslate"><span class="pre">Trajectory.set_velocities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">Trajectory.types</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#target.trajectory.check_trajectory_compatibility"><code class="docutils literal notranslate"><span class="pre">check_trajectory_compatibility()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#general-utilities">General Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#utility-module-for-samos-package">Utility Module for SAMOS Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.utilities.AttributedArray"><code class="docutils literal notranslate"><span class="pre">AttributedArray</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#target.utilities.AttributedArray._arrays"><code class="docutils literal notranslate"><span class="pre">AttributedArray._arrays</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.utilities.AttributedArray._attrs"><code class="docutils literal notranslate"><span class="pre">AttributedArray._attrs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.utilities.AttributedArray._nstep"><code class="docutils literal notranslate"><span class="pre">AttributedArray._nstep</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.utilities.AttributedArray.__init__"><code class="docutils literal notranslate"><span class="pre">AttributedArray.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.utilities.AttributedArray.get_array"><code class="docutils literal notranslate"><span class="pre">AttributedArray.get_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.utilities.AttributedArray.get_arraynames"><code class="docutils literal notranslate"><span class="pre">AttributedArray.get_arraynames()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.utilities.AttributedArray.get_attr"><code class="docutils literal notranslate"><span class="pre">AttributedArray.get_attr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.utilities.AttributedArray.get_attrs"><code class="docutils literal notranslate"><span class="pre">AttributedArray.get_attrs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.utilities.AttributedArray.load_file"><code class="docutils literal notranslate"><span class="pre">AttributedArray.load_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.utilities.AttributedArray.nstep"><code class="docutils literal notranslate"><span class="pre">AttributedArray.nstep</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.utilities.AttributedArray.remove_array"><code class="docutils literal notranslate"><span class="pre">AttributedArray.remove_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.utilities.AttributedArray.rescale_array"><code class="docutils literal notranslate"><span class="pre">AttributedArray.rescale_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.utilities.AttributedArray.save"><code class="docutils literal notranslate"><span class="pre">AttributedArray.save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.utilities.AttributedArray.set_array"><code class="docutils literal notranslate"><span class="pre">AttributedArray.set_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.utilities.AttributedArray.set_attr"><code class="docutils literal notranslate"><span class="pre">AttributedArray.set_attr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#target.utilities.InputError"><code class="docutils literal notranslate"><span class="pre">InputError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.utilities.apply_minimum_image"><code class="docutils literal notranslate"><span class="pre">apply_minimum_image()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.utilities.get_color"><code class="docutils literal notranslate"><span class="pre">get_color()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.utilities.get_terminal_width"><code class="docutils literal notranslate"><span class="pre">get_terminal_width()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#analysis-helpers">Analysis Helpers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#target.analysis.BaseAnalyzer"><code class="docutils literal notranslate"><span class="pre">BaseAnalyzer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#target.analysis.BaseAnalyzer.__init__"><code class="docutils literal notranslate"><span class="pre">BaseAnalyzer.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.analysis.BaseAnalyzer.run"><code class="docutils literal notranslate"><span class="pre">BaseAnalyzer.run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.analysis.BaseAnalyzer.set_trajectory"><code class="docutils literal notranslate"><span class="pre">BaseAnalyzer.set_trajectory()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#target.analysis.DynamicsAnalyzer"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#target.analysis.DynamicsAnalyzer.__init__"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.analysis.DynamicsAnalyzer.get_kinetic_energies"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer.get_kinetic_energies()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.analysis.DynamicsAnalyzer.get_power_spectrum"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer.get_power_spectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.analysis.DynamicsAnalyzer.get_species_of_interest"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer.get_species_of_interest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.analysis.DynamicsAnalyzer.get_vaf"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer.get_vaf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.analysis.DynamicsAnalyzer.set_species_of_interest"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer.set_species_of_interest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.analysis.DynamicsAnalyzer.set_trajectories"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer.set_trajectories()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.analysis.DynamicsAnalyzer.set_verbosity"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer.set_verbosity()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#target.analysis.TimeSeries"><code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.analysis.get_gaussian_density"><code class="docutils literal notranslate"><span class="pre">get_gaussian_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.analysis.write_xsf_header"><code class="docutils literal notranslate"><span class="pre">write_xsf_header()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#preprocessing">Preprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#utility-modules">Utility Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-target.json_serializable">JSON Serialization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#json-serialization-utilities-for-cpdyana">JSON Serialization Utilities for CPDyAna</a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.json_serializable.convert_to_serializable"><code class="docutils literal notranslate"><span class="pre">convert_to_serializable()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-target.const">Constants</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#physical-constants-and-unit-conversions-for-cpdyana">Physical Constants and Unit Conversions for CPDyAna</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="usage_Examples.html">Usage Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage_Examples.html#command-line-interface-examples">Command-Line Interface Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage_Examples.html#mean-square-displacement-msd">Mean Square Displacement (MSD)</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage_Examples.html#non-gaussian-parameter-ngp">Non-Gaussian Parameter (NGP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage_Examples.html#van-hove-correlation-functions">Van Hove Correlation Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage_Examples.html#radial-distribution-functions-rdf">Radial Distribution Functions (RDF)</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage_Examples.html#ionic-density-mapping">Ionic Density Mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage_Examples.html#velocity-autocorrelation-functions-vaf">Velocity Autocorrelation Functions (VAF)</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage_Examples.html#vibrational-density-of-states-vdos">Vibrational Density of States (VDOS)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usage_Examples.html#python-api-examples">Python API Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage_Examples.html#direct-function-usage">Direct Function Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage_Examples.html#samos-module-integration">SAMOS Module Integration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usage_Examples.html#batch-processing-workflows">Batch Processing Workflows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage_Examples.html#processing-multiple-simulations">Processing Multiple Simulations</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage_Examples.html#temperature-series-analysis">Temperature Series Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usage_Examples.html#advanced-analysis-examples">Advanced Analysis Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage_Examples.html#custom-van-hove-analysis">Custom Van Hove Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usage_Examples.html#file-format-tips">File Format Tips</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage_Examples.html#required-file-structure">Required File Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage_Examples.html#performance-optimization">Performance Optimization</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Module Index:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Usage Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modules.html#basic-msd-analysis">Basic MSD Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#non-gaussian-parameter-ngp-analysis">Non-Gaussian Parameter (NGP) Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#van-hove-correlation-function">Van Hove Correlation Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#radial-distribution-function-rdf">Radial Distribution Function (RDF)</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#velocity-autocorrelation-function-vaf">Velocity Autocorrelation Function (VAF)</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#vibrational-density-of-states-vdos">Vibrational Density of States (VDOS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#ionic-density-mapping">Ionic Density Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#batch-processing-workflows">Batch Processing Workflows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modules.html#processing-multiple-simulations">Processing Multiple Simulations</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CPDyAna</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Target Package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/target.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="target-package">
<h1>Target Package<a class="headerlink" href="#target-package" title="Link to this heading"></a></h1>
<p>The <cite>target</cite> package contains the core CPDyAna analysis functionality for molecular dynamics trajectory analysis. It provides a comprehensive suite of tools for calculating diffusion properties, correlation functions, and structural analysis.</p>
<section id="main-analysis-driver">
<h2>Main Analysis Driver<a class="headerlink" href="#main-analysis-driver" title="Link to this heading"></a></h2>
<p>The main CPDyAna CLI interface and job orchestration.</p>
<section id="cpdyana-combined-molecular-dynamics-analysis-tool">
<span id="module-target.CPDyAna"></span><h3>CPDyAna – Combined Molecular Dynamics Analysis Tool<a class="headerlink" href="#cpdyana-combined-molecular-dynamics-analysis-tool" title="Link to this heading"></a></h3>
<p>CPDyAna is a comprehensive command-line interface for analyzing molecular dynamics
simulations. It provides unified access to multiple analysis types including:</p>
<ul class="simple">
<li><p><strong>Mean Square Displacement (MSD)</strong>: Calculate diffusion coefficients and tracer diffusivity</p></li>
<li><p><strong>Non-Gaussian Parameters (NGP)</strong>: Analyze non-Gaussian behavior in diffusion</p></li>
<li><p><strong>Van Hove Correlation Functions</strong>: Analyze spatial correlations (self and distinct)</p></li>
<li><p><strong>Radial Distribution Functions (RDF)</strong>: Compute pair correlation functions</p></li>
<li><p><strong>Velocity Autocorrelation Functions (VAF)</strong>: Analyze velocity correlations</p></li>
<li><p><strong>Vibrational Density of States (VDOS)</strong>: Calculate phonon spectra</p></li>
<li><p><strong>Ionic Density Maps</strong>: Generate 3D density distributions</p></li>
</ul>
<p>This single-file variant merges the original CPDyAna.py driver with helper
functions for a complete standalone workflow.</p>
<dl>
<dt>Supported File Formats:</dt><dd><ul class="simple">
<li><p>Quantum ESPRESSO trajectory files (.pos, .cel, .evp, .in)</p></li>
<li><p>LAMMPS trajectory files</p></li>
<li><p>BOMD (.trj) trajectory files</p></li>
<li><p>ASE-compatible formats</p></li>
</ul>
</dd>
<dt>Usage Examples:</dt><dd><p># Mean Square Displacement analysis
python CPDyAna.py msd -T 800 –data-dir /path/to/data –diffusing-elements Li Na</p>
<p># Non-Gaussian Parameters analysis
python CPDyAna.py ngp -T 800 –data-dir /path/to/data –diffusing-elements Li Na –initial-time 0 –final-time 200</p>
<p># Van Hove correlation function
python CPDyAna.py vh -T 800 –data-dir /path/to/data –rmax 10 –sigma 0.1</p>
<p># Radial distribution function
python CPDyAna.py rdf –data-dir /path/to/data –central-atom Li Al</p>
<p># Velocity autocorrelation function
python CPDyAna.py vaf –data-dir /path/to/data –element Li –nframes 1000</p>
<p># Ionic density mapping
python CPDyAna.py ionic-density –data-dir /path/to/data –element Li –sigma 0.3</p>
</dd>
</dl>
<p>Author: CPDyAna Development Team
Version: Combined version (01-02-2024)</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="target.CPDyAna.Job">
<span class="sig-prename descclassname"><span class="pre">target.CPDyAna.</span></span><span class="sig-name descname"><span class="pre">Job</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusing_elements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusivity_direction_choices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusivity_choices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correlation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Conv_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_slope_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_slope_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_skip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammps_elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammps_timestep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bomd_elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bomd_timestep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_verification</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_recommendations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammps_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'metal'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/CPDyAna.html#Job"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.CPDyAna.Job" title="Link to this definition"></a></dt>
<dd><p>Main analysis job function for MSD and related analyses, using UNIFIED calculation approach.</p>
<p>Handles trajectory reading, format detection, and dispatches to the appropriate
analysis routines for MSD, NGP, Van Hove, etc. Compatible with QE, LAMMPS, and BOMD (.trj).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of temperatures for analysis.</p></li>
<li><p><strong>diffusing_elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Elements to analyze.</p></li>
<li><p><strong>diffusivity_direction_choices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Directions for MSD/diffusion.</p></li>
<li><p><strong>diffusivity_choices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Types of diffusivity (Tracer, Collective, etc.).</p></li>
<li><p><strong>correlation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Correlation function types.</p></li>
<li><p><strong>data_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Directory containing trajectory files.</p></li>
<li><p><strong>Conv_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Unit conversion factor.</p></li>
<li><p><strong>initial_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time windows.</p></li>
<li><p><strong>final_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time windows.</p></li>
<li><p><strong>initial_slope_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time windows.</p></li>
<li><p><strong>final_slope_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time windows.</p></li>
<li><p><strong>block</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Block size for statistical analysis.</p></li>
<li><p><strong>rmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Max radius for correlation functions.</p></li>
<li><p><strong>step_skip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Step skip for correlation functions.</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Gaussian broadening for correlation functions.</p></li>
<li><p><strong>ngrid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of grid points for correlation functions.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Analysis mode (msd, ngp, vh, etc.).</p></li>
<li><p><strong>lammps_elements</strong> – LAMMPS/BOMD-specific options.</p></li>
<li><p><strong>lammps_timestep</strong> – LAMMPS/BOMD-specific options.</p></li>
<li><p><strong>element_mapping</strong> – LAMMPS/BOMD-specific options.</p></li>
<li><p><strong>export_verification</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Export verification trajectory.</p></li>
<li><p><strong>show_recommendations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Show analysis recommendations.</p></li>
<li><p><strong>lammps_units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – LAMMPS unit system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(temp_input_dict, temp_output_dict) with all processed data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.CPDyAna.main">
<span class="sig-prename descclassname"><span class="pre">target.CPDyAna.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/CPDyAna.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.CPDyAna.main" title="Link to this definition"></a></dt>
<dd><p>Main entry point for CPDyAna CLI.</p>
<p>Parses arguments, detects trajectory format, and dispatches to the appropriate
analysis workflow (MSD, NGP, Van Hove, RDF, VAF, VDOS, ionic density).
Handles BOMD (.trj), QE, and LAMMPS files, and manages plotting and output.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.CPDyAna.parser">
<span class="sig-prename descclassname"><span class="pre">target.CPDyAna.</span></span><span class="sig-name descname"><span class="pre">parser</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/CPDyAna.html#parser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.CPDyAna.parser" title="Link to this definition"></a></dt>
<dd><p>Create and configure the command-line argument parser for CPDyAna.</p>
<p>This function sets up the main argument parser with subcommands for different
analysis modes. Each subcommand has its own specific arguments while sharing
common parameters where appropriate.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Parsed command-line arguments containing all user-specified</dt><dd><p>options for the requested analysis mode.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/argparse.html#argparse.Namespace" title="(in Python v3.13)">argparse.Namespace</a></p>
</dd>
</dl>
<dl class="simple">
<dt>Subcommands:</dt><dd><p>msd: Mean Square Displacement analysis for diffusion coefficients
vh: Van Hove correlation function analysis
ngp: Non-Gaussian Parameter analysis for dynamic heterogeneity
ionic-density: 3D ionic density mapping
rdf: Radial Distribution Function calculation
vaf: Velocity Autocorrelation Function analysis
vdos: Vibrational Density of States calculation.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># args.mode will contain the selected subcommand</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># args.temperature will contain the temperature list</span>
</pre></div>
</div>
</dd></dl>

<section id="key-functions">
<h3>Key Functions<a class="headerlink" href="#key-functions" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#target.CPDyAna.main" title="target.CPDyAna.main"><code class="xref py py-func docutils literal notranslate"><span class="pre">target.CPDyAna.main()</span></code></a>: Main CLI entry point</p></li>
<li><p><a class="reference internal" href="#target.CPDyAna.Job" title="target.CPDyAna.Job"><code class="xref py py-func docutils literal notranslate"><span class="pre">target.CPDyAna.Job()</span></code></a>: Core analysis job orchestrator</p></li>
<li><p><a class="reference internal" href="#target.CPDyAna.parser" title="target.CPDyAna.parser"><code class="xref py py-func docutils literal notranslate"><span class="pre">target.CPDyAna.parser()</span></code></a>: Command-line argument parser</p></li>
</ul>
</section>
</section>
<section id="data-processing">
<h2>Data Processing<a class="headerlink" href="#data-processing" title="Link to this heading"></a></h2>
<p>Utilities for processing and segmenting trajectory data.</p>
<section id="general-data-processing-module-for-cpdyana">
<span id="module-target.data_processing"></span><h3>General Data Processing Module for CPDyAna<a class="headerlink" href="#general-data-processing-module-for-cpdyana" title="Link to this heading"></a></h3>
<p>This module provides general-purpose data processing functions for molecular dynamics
analysis, including time window selection, trajectory segmentation, and data evaluation
for diffusion analysis. It is compatible with Quantum ESPRESSO and other DFT/MD codes.</p>
<dl class="simple">
<dt>Functions:</dt><dd><p>find_terms: Find array indices corresponding to a time window.
segmenter_func: Segment simulation data arrays for a specified time window.
data_evaluator: Process position data for diffusion analysis, including drift correction.</p>
</dd>
</dl>
<p>Author: CPDyAna Development Team
Version: 06-25-2025</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="target.data_processing.data_evaluator">
<span class="sig-prename descclassname"><span class="pre">target.data_processing.</span></span><span class="sig-name descname"><span class="pre">data_evaluator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diffusivity_direction_choices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_elements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_ion_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/data_processing.html#data_evaluator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.data_processing.data_evaluator" title="Link to this definition"></a></dt>
<dd><p>Evaluate and process simulation data for ion diffusion analysis.</p>
<p>Parameters:
- diffusivity_direction_choices (list): List of diffusion directions to analyze.
- target_elements (list): List of elements considered as conductors.
- pos, total_ion_array (numpy.ndarray): Position and element arrays from the simulation.
- steps (int): Number of simulation steps.</p>
<p>Returns:
- tuple: Processed arrays related to ion diffusion analysis.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.data_processing.find_terms">
<span class="sig-prename descclassname"><span class="pre">target.data_processing.</span></span><span class="sig-name descname"><span class="pre">find_terms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/data_processing.html#find_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.data_processing.find_terms" title="Link to this definition"></a></dt>
<dd><p>Find indices in an array corresponding to a specified value range.</p>
<p>Parameters:
- array (array-like): Array of time or frame values.
- first_value (float): Start value for analysis window.
- last_value (float): End value for analysis window.</p>
<p>Returns:
- tuple: (first_term, last_term) indices</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.data_processing.segmenter_func">
<span class="sig-prename descclassname"><span class="pre">target.data_processing.</span></span><span class="sig-name descname"><span class="pre">segmenter_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">first_term</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ke_elec_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_temp_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ion_temp_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tot_energy_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enthalpy_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tot_energy_ke_ion_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tot_energy_ke_ion_ke_elec_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure_full</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/data_processing.html#segmenter_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.data_processing.segmenter_func" title="Link to this definition"></a></dt>
<dd><p>Segment the simulation data based on specified parameters and return relevant data arrays.</p>
<p>Parameters:
- first_term (int): Index of the starting time step.
- last (int): Index of the ending time step.
- pos_full, dt_full, time_full, cell_full, ke_elec_full, cell_temp_full, ion_temp_full, tot_energy_full, enthalpy_full, tot_energy_ke_ion_full, tot_energy_ke_ion_ke_elec_full, vol_full, pressure_full (numpy.ndarray): Full arrays of simulation data.</p>
<p>Returns:
- tuple: Segmented data arrays based on the specified time range.</p>
</dd></dl>

</section>
<section id="lammps-data-processing">
<h2>LAMMPS Data Processing<a class="headerlink" href="#lammps-data-processing" title="Link to this heading"></a></h2>
<p>Specialized functions for LAMMPS trajectory data.</p>
<section id="lammps-data-processing-module-for-cpdyana">
<span id="module-target.data_processing_lammps"></span><h3>LAMMPS Data Processing Module for CPDyAna<a class="headerlink" href="#lammps-data-processing-module-for-cpdyana" title="Link to this heading"></a></h3>
<p>This module provides specialized functions for processing LAMMPS trajectory data,
optimized for the uniform timestep nature of LAMMPS simulations.</p>
<p>The module includes functions for time window selection, trajectory segmentation,
and data evaluation for diffusion analysis, with LAMMPS-specific optimizations.</p>
<p>Author: CPDyAna Development Team
Version: 06-25-2025</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="target.data_processing_lammps.calculate_time_window_lammps">
<span class="sig-prename descclassname"><span class="pre">target.data_processing_lammps.</span></span><span class="sig-name descname"><span class="pre">calculate_time_window_lammps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_slope_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_slope_time</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/data_processing_lammps.html#calculate_time_window_lammps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.data_processing_lammps.calculate_time_window_lammps" title="Link to this definition"></a></dt>
<dd><p>Calculate time window indices for fitting diffusion coefficients in LAMMPS data.</p>
<p>Parameters:
- dt_value: Timestep value in picoseconds
- n_timesteps: Total number of timesteps
- initial_slope_time: Start time for fitting in picoseconds
- final_slope_time: End time for fitting in picoseconds</p>
<p>Returns:
- tuple: (first_idx, last_idx, time_array)</p>
<blockquote>
<div><p>Indices and time array for the fitting window.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.data_processing_lammps.data_evaluator_lammps">
<span class="sig-prename descclassname"><span class="pre">target.data_processing_lammps.</span></span><span class="sig-name descname"><span class="pre">data_evaluator_lammps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diffusivity_direction_choices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_elements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_ion_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/data_processing_lammps.html#data_evaluator_lammps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.data_processing_lammps.data_evaluator_lammps" title="Link to this definition"></a></dt>
<dd><p>Process LAMMPS position data for diffusion analysis.</p>
<p>This function has the same API as the original data_evaluator, but is optimized
for LAMMPS trajectory data processing.</p>
<p>Parameters:
- diffusivity_direction_choices: List of directions for analysis (e.g., [“XYZ”, “X”])
- target_elements: List of mobile ion elements
- pos: Position array [atoms, frames, xyz]
- total_ion_array: Array of element types
- steps: Number of timesteps</p>
<p>Returns:
- tuple: Arrays needed for diffusion analysis</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.data_processing_lammps.detect_lammps_format">
<span class="sig-prename descclassname"><span class="pre">target.data_processing_lammps.</span></span><span class="sig-name descname"><span class="pre">detect_lammps_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/data_processing_lammps.html#detect_lammps_format"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.data_processing_lammps.detect_lammps_format" title="Link to this definition"></a></dt>
<dd><p>Detect if the given dt_array is from a LAMMPS trajectory.</p>
<p>LAMMPS trajectories have uniform timesteps, while QE trajectories have varying timesteps.</p>
<p>Parameters:
- dt_array: Array of timestep values</p>
<p>Returns:
- bool: True if LAMMPS format detected, False otherwise</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.data_processing_lammps.find_terms_lammps">
<span class="sig-prename descclassname"><span class="pre">target.data_processing_lammps.</span></span><span class="sig-name descname"><span class="pre">find_terms_lammps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/data_processing_lammps.html#find_terms_lammps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.data_processing_lammps.find_terms_lammps" title="Link to this definition"></a></dt>
<dd><p>Find indices in a LAMMPS trajectory corresponding to a time range.</p>
<p>Parameters:
- dt_value: Timestep value in picoseconds
- n_timesteps: Total number of timesteps
- first_value: Start time for analysis window in picoseconds
- last_value: End time for analysis window in picoseconds</p>
<p>Returns:
- tuple: (first_term, last_term) indices</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.data_processing_lammps.is_lammps_simulation">
<span class="sig-prename descclassname"><span class="pre">target.data_processing_lammps.</span></span><span class="sig-name descname"><span class="pre">is_lammps_simulation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/data_processing_lammps.html#is_lammps_simulation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.data_processing_lammps.is_lammps_simulation" title="Link to this definition"></a></dt>
<dd><p>Check if the provided data is from a LAMMPS simulation.</p>
<p>Parameters:
- data_dict: Dictionary containing simulation data</p>
<p>Returns:
- bool: True if LAMMPS data detected, False otherwise</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.data_processing_lammps.segmenter_func_lammps">
<span class="sig-prename descclassname"><span class="pre">target.data_processing_lammps.</span></span><span class="sig-name descname"><span class="pre">segmenter_func_lammps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">first_term</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_term</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/data_processing_lammps.html#segmenter_func_lammps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.data_processing_lammps.segmenter_func_lammps" title="Link to this definition"></a></dt>
<dd><p>Segment LAMMPS trajectory data based on specified time range.</p>
<p>Parameters:
- first_term: Index of first timestep
- last_term: Index of last timestep
- pos_full: Full position array [atoms, frames, xyz]
- dt_value: Timestep value in picoseconds
- n_timesteps: Total number of timesteps
- cell_full: Cell parameter array (optional)</p>
<p>Returns:
- tuple: (pos, step_counts, dt, time, cell, ke_elec, cell_temp, ion_temp, tot_energy, enthalpy, tot_energy_ke_ion, tot_energy_ke_ion_ke_elec, vol, pressure)</p>
<blockquote>
<div><p>Segmented data arrays for analysis.</p>
</div></blockquote>
</dd></dl>

</section>
<section id="input-output-operations">
<h2>Input/Output Operations<a class="headerlink" href="#input-output-operations" title="Link to this heading"></a></h2>
<p>Reading and parsing of trajectory files and I/O utilities, including BOMD and LAMMPS.</p>
<section id="input-file-reader-module-for-cpdyana">
<span id="module-target.input_reader"></span><h3>Input File Reader Module for CPDyAna<a class="headerlink" href="#input-file-reader-module-for-cpdyana" title="Link to this heading"></a></h3>
<p>This module provides functions for reading and parsing various input file formats
used in molecular dynamics simulations, particularly those from Quantum ESPRESSO,
LAMMPS, and BOMD (.trj).</p>
<p>Supported file formats:
- .pos files: Position trajectories with atomic coordinates
- .cel files: Unit cell parameters and lattice vectors
- .evp files: Energy, volume, and pressure data
- .in files: Ion definitions and atomic species information
- LAMMPS dump files: Trajectories from LAMMPS
- BOMD .trj files: Born-Oppenheimer MD trajectories</p>
<p>The module handles unit conversions (typically Bohr to Angstrom) and provides
structured data arrays suitable for analysis functions.</p>
<dl class="simple">
<dt>Functions:</dt><dd><p>detect_trajectory_format: Auto-detects trajectory format in a directory.
generate_analysis_recommendations: Prints recommended analysis parameters.
export_verification_trajectory: Writes a short trajectory for verification.
has_type_column: Checks if LAMMPS dump file has a ‘type’ column.
read_lammps_trajectory: Reads and parses LAMMPS trajectory files.
read_bomd_trajectory: Reads and parses BOMD .trj trajectory files.
read_ion_file_universal: Reads ion info from file or list.
read_ion_file: Reads atomic species from .in file.
read_cel_file: Reads cell parameters from .cel file.
read_evp_file: Reads thermodynamic data from .evp file.
read_pos_file: Reads position trajectory from .pos file.</p>
</dd>
</dl>
<p>Author: CPDyAna Development Team
Version: 01-02-2024</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="target.input_reader.detect_trajectory_format">
<span class="sig-prename descclassname"><span class="pre">target.input_reader.</span></span><span class="sig-name descname"><span class="pre">detect_trajectory_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/input_reader.html#detect_trajectory_format"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.input_reader.detect_trajectory_format" title="Link to this definition"></a></dt>
<dd><p>Automatically detect trajectory file formats in the data directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to directory containing trajectory files.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Format information with file paths and detected format.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.input_reader.export_verification_trajectory">
<span class="sig-prename descclassname"><span class="pre">target.input_reader.</span></span><span class="sig-name descname"><span class="pre">export_verification_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cells</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inp_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpdyana_verification.xyz'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/input_reader.html#export_verification_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.input_reader.export_verification_trajectory" title="Link to this definition"></a></dt>
<dd><p>Export a short verification trajectory for quality assurance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> (<em>np.ndarray</em>) – Array of positions (frames, atoms, 3).</p></li>
<li><p><strong>cells</strong> (<em>np.ndarray</em>) – Array of cell matrices (frames, 3, 3).</p></li>
<li><p><strong>inp_array</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of element symbols.</p></li>
<li><p><strong>times</strong> (<em>np.ndarray</em>) – Array of time values.</p></li>
<li><p><strong>output_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Output file path.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None. Writes a trajectory file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.input_reader.generate_analysis_recommendations">
<span class="sig-prename descclassname"><span class="pre">target.input_reader.</span></span><span class="sig-name descname"><span class="pre">generate_analysis_recommendations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_difference</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inp_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/input_reader.html#generate_analysis_recommendations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.input_reader.generate_analysis_recommendations" title="Link to this definition"></a></dt>
<dd><p>Generate smart analysis parameter recommendations based on trajectory characteristics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>times</strong> (<em>np.ndarray</em>) – Array of time values.</p></li>
<li><p><strong>time_difference</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time step between frames.</p></li>
<li><p><strong>n_frames</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of frames.</p></li>
<li><p><strong>inp_array</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of element symbols.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None. Prints recommendations to stdout.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.input_reader.has_type_column">
<span class="sig-prename descclassname"><span class="pre">target.input_reader.</span></span><span class="sig-name descname"><span class="pre">has_type_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lammps_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/input_reader.html#has_type_column"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.input_reader.has_type_column" title="Link to this definition"></a></dt>
<dd><p>Check if a LAMMPS dump file has a ‘type’ column in its ATOMS section.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lammps_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to LAMMPS dump file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if ‘type’ column is present, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.input_reader.read_bomd_trajectory">
<span class="sig-prename descclassname"><span class="pre">target.input_reader.</span></span><span class="sig-name descname"><span class="pre">read_bomd_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bomd_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_verification</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/input_reader.html#read_bomd_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.input_reader.read_bomd_trajectory" title="Link to this definition"></a></dt>
<dd><p>Read BOMD trajectory file (.trj or .trajectory) and convert to CPDyAna format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bomd_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to BOMD trajectory file.</p></li>
<li><p><strong>elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of element symbols (length = n_atoms).</p></li>
<li><p><strong>timestep</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Optional, time step in ps.</p></li>
<li><p><strong>export_verification</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Export verification trajectory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(positions, n_frames, dt_full, t_full, cell_param_full, thermo_data, volumes, inp_array)</dt><dd><p>positions (np.ndarray): (atoms, frames, 3)
n_frames (int): Number of frames
dt_full (np.ndarray): (frames-1,) time differences
t_full (np.ndarray): (frames,) time values
cell_param_full (np.ndarray): (frames, 9)
thermo_data (dict): Thermodynamic data
volumes (list): Cell volumes
inp_array (list): element symbols per atom</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.input_reader.read_cel_file">
<span class="sig-prename descclassname"><span class="pre">target.input_reader.</span></span><span class="sig-name descname"><span class="pre">read_cel_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cel_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Length_conversion_factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/input_reader.html#read_cel_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.input_reader.read_cel_file" title="Link to this definition"></a></dt>
<dd><p>Read unit cell parameter file containing lattice vectors and cell dimensions.</p>
<p>The cell file contains time-dependent lattice vectors that define the
simulation box boundaries. This is crucial for applying periodic boundary
conditions and calculating volumes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cel_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the cell parameter file (.cel format).</p></li>
<li><p><strong>Length_conversion_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Unit conversion factor (e.g., 0.529177249 for Bohr to Angstrom).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Array with shape (n_frames, 9) containing lattice vectors:</dt><dd><p>[a1_x, a1_y, a1_z, a2_x, a2_y, a2_z, a3_x, a3_y, a3_z]</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.input_reader.read_evp_file">
<span class="sig-prename descclassname"><span class="pre">target.input_reader.</span></span><span class="sig-name descname"><span class="pre">read_evp_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evp_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Length_conversion_factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/input_reader.html#read_evp_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.input_reader.read_evp_file" title="Link to this definition"></a></dt>
<dd><p>Read energy, volume, and pressure file containing thermodynamic properties.</p>
<p>The EVP file contains time-series data of various thermodynamic quantities
including kinetic energies, total energy, enthalpy, volume, pressure, and
temperatures for different components of the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evp_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the EVP file (.evp format).</p></li>
<li><p><strong>Length_conversion_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Unit conversion factor for energy and volume.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Contains the following arrays:</dt><dd><ul class="simple">
<li><p>ke_elec (np.ndarray): Electronic kinetic energy</p></li>
<li><p>cell_temp (np.ndarray): Cell temperature</p></li>
<li><p>ion_temp (np.ndarray): Ionic temperature</p></li>
<li><p>tot_energy (np.ndarray): Total energy</p></li>
<li><p>enthalpy (np.ndarray): Enthalpy</p></li>
<li><p>tot_energy_ke_ion (np.ndarray): Total energy + ionic KE</p></li>
<li><p>tot_energy_ke_ion_ke_elec (np.ndarray): Total energy + all KE</p></li>
<li><p>volume (np.ndarray): Cell volume</p></li>
<li><p>pressure (np.ndarray): Pressure</p></li>
<li><p>n_frames (int): Number of time frames</p></li>
<li><p>time_diff (float): Time step between frames</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.input_reader.read_ion_file">
<span class="sig-prename descclassname"><span class="pre">target.input_reader.</span></span><span class="sig-name descname"><span class="pre">read_ion_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ion_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/input_reader.html#read_ion_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.input_reader.read_ion_file" title="Link to this definition"></a></dt>
<dd><p>Read and parse ion definition file containing atomic species information.</p>
<p>The ion file typically contains atomic symbols, masses, and other properties
for each species in the simulation. This function extracts this information
and returns it in a structured format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ion_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the ion definition file (.in format).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of atomic symbols (e.g., [‘Li’, ‘Al’, ‘P’, ‘S’])</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.input_reader.read_ion_file_universal">
<span class="sig-prename descclassname"><span class="pre">target.input_reader.</span></span><span class="sig-name descname"><span class="pre">read_ion_file_universal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ion_file_or_elements</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/input_reader.html#read_ion_file_universal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.input_reader.read_ion_file_universal" title="Link to this definition"></a></dt>
<dd><p>Universal ion reader that handles both .in files and element lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ion_file_or_elements</strong> – Either path to .in file or list of elements</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ion symbols</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.input_reader.read_lammps_trajectory">
<span class="sig-prename descclassname"><span class="pre">target.input_reader.</span></span><span class="sig-name descname"><span class="pre">read_lammps_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lammps_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermo_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Conv_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_verification</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_recommendations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/input_reader.html#read_lammps_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.input_reader.read_lammps_trajectory" title="Link to this definition"></a></dt>
<dd><p>Read and parse a LAMMPS trajectory file and convert to CPDyAna format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lammps_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to LAMMPS dump file.</p></li>
<li><p><strong>elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of element symbols for atom types.</p></li>
<li><p><strong>timestep</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Timestep in ps.</p></li>
<li><p><strong>thermo_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Optional, path to LAMMPS thermo file.</p></li>
<li><p><strong>Conv_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Conversion factor for units.</p></li>
<li><p><strong>element_mapping</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – Mapping from type index to element symbol.</p></li>
<li><p><strong>export_verification</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Export verification trajectory.</p></li>
<li><p><strong>show_recommendations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Print analysis recommendations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(pos_full, n_frames, dt_full, t_full, cell_param_full, thermo_data, volumes, inp_array)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.input_reader.read_pos_file">
<span class="sig-prename descclassname"><span class="pre">target.input_reader.</span></span><span class="sig-name descname"><span class="pre">read_pos_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_ions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Length_conversion_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_time_frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_difference</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/input_reader.html#read_pos_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.input_reader.read_pos_file" title="Link to this definition"></a></dt>
<dd><p>Read position trajectory file containing atomic coordinates over time.</p>
<p>The position file contains the time evolution of atomic coordinates for all
atoms in the simulation. This function parses the file and organizes the
data into arrays suitable for analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the position file (.pos format).</p></li>
<li><p><strong>total_ions</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Ion information from read_ion_file().</p></li>
<li><p><strong>Length_conversion_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Unit conversion factor (Bohr to Angstrom).</p></li>
<li><p><strong>number_of_time_frames</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of frames to read.</p></li>
<li><p><strong>time_difference</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time step between frames in ps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Contains:</dt><dd><ul class="simple">
<li><p>positions (np.ndarray): Position array with shape (n_ions, n_frames, 3)</p></li>
<li><p>n_steps (int): Number of time steps</p></li>
<li><p>dt (np.ndarray): Time differences between steps</p></li>
<li><p>time (np.ndarray): Absolute time values in picoseconds</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<p id="module-target.io">I/O Operations Module for SAMOS</p>
<p>This module provides comprehensive input/output functions for the SAMOS (Statistical
Analysis of MOlecular Simulations) package. It handles reading and writing of various
trajectory formats commonly used in molecular dynamics simulations.</p>
<dl class="simple">
<dt>Supported Formats:</dt><dd><ul class="simple">
<li><p>LAMMPS dump files (.lammpstrj)</p></li>
<li><p>Extended XYZ files (.extxyz)</p></li>
<li><p>XSF files for visualization (.xsf)</p></li>
<li><p>ASE-compatible trajectory formats</p></li>
<li><p>Grid data files for density analysis</p></li>
</ul>
</dd>
<dt>Key Features:</dt><dd><ul class="simple">
<li><p>Format detection and conversion</p></li>
<li><p>Trajectory preprocessing and filtering</p></li>
<li><p>Periodic boundary condition handling</p></li>
<li><p>Unit conversions and coordinate transformations</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">author<span class="colon">:</span></dt>
<dd class="field-odd"><p>SAMOS Development Team</p>
</dd>
<dt class="field-even">date<span class="colon">:</span></dt>
<dd class="field-even"><p>01-02-2024</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="target.io.get_indices">
<span class="sig-prename descclassname"><span class="pre">target.io.</span></span><span class="sig-name descname"><span class="pre">get_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postfix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/io.html#get_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.io.get_indices" title="Link to this definition"></a></dt>
<dd><p>Get indices of specific fields in a header list.</p>
<p>This function searches for field indices in a header list based on a prefix
and postfix pattern, commonly used to identify coordinate or velocity fields
in trajectory file headers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>header_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of header strings to search through.</p></li>
<li><p><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Prefix to match before the field name (e.g., ‘v’ for velocities). Default is “”.</p></li>
<li><p><strong>postfix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Postfix to match after the field name (e.g., ‘u’ for unwrapped). Default is “”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of (bool, np.ndarray or None):
- Boolean indicating if the fields were found.
- Array of indices for x, y, z components if found, otherwise <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Find position indices in a header list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;vx&#39;</span><span class="p">,</span> <span class="s1">&#39;vy&#39;</span><span class="p">,</span> <span class="s1">&#39;vz&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">found</span><span class="p">,</span> <span class="n">pos_indices</span> <span class="o">=</span> <span class="n">get_indices</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="n">postfix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Position indices found: </span><span class="si">{</span><span class="n">pos_indices</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.io.get_position_indices">
<span class="sig-prename descclassname"><span class="pre">target.io.</span></span><span class="sig-name descname"><span class="pre">get_position_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/io.html#get_position_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.io.get_position_indices" title="Link to this definition"></a></dt>
<dd><p>Extract position indices from a header list.</p>
<p>This function identifies the indices of position fields (x, y, z) in a header list
from trajectory file data, supporting different coordinate types (unwrapped, scaled,
or wrapped).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>header_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of header strings from a trajectory file dump (e.g., [‘id’, ‘x’, ‘y’, ‘z’]).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple of (str, np.ndarray):
- postfix: String indicating the type of coordinates found (‘u’ for unwrapped,</p>
<blockquote>
<div><p>’s’ for scaled, or ‘’ for wrapped).</p>
</div></blockquote>
<ul class="simple">
<li><p>idc: Array of indices corresponding to x, y, z fields in the header list.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If no position indices are found in the header list.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – If scaled unwrapped coordinates (‘xsu’) are present in the header list, as they are not supported.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Extract position indices from a header list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;vx&#39;</span><span class="p">,</span> <span class="s1">&#39;vy&#39;</span><span class="p">,</span> <span class="s1">&#39;vz&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">postfix</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">get_position_indices</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Position indices: </span><span class="si">{</span><span class="n">indices</span><span class="si">}</span><span class="s2">, Coordinate type: </span><span class="si">{</span><span class="n">postfix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The function checks for different postfixes (‘u’, ‘s’, ‘’) to identify coordinate types.
For scaled (‘s’) or wrapped (‘’) coordinates, a warning is printed as unwrapping is not yet implemented.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.io.get_thermo_props">
<span class="sig-prename descclassname"><span class="pre">target.io.</span></span><span class="sig-name descname"><span class="pre">get_thermo_props</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/io.html#get_thermo_props"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.io.get_thermo_props" title="Link to this definition"></a></dt>
<dd><p>Extract thermodynamic properties from simulation output files.</p>
<p>This function parses molecular dynamics (MD) output files to extract thermodynamic
quantities such as temperature, pressure, energy, and volume from a log file format
with a header line and data array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the simulation output file (e.g., a LAMMPS log file).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing:
- header (list of str): List of column names from the file header.
- arr (np.ndarray): 2D array of data values from the file, with shape (n_steps, n_columns).
- ts_index (int): Index of the ‘TimeStep’ column in the header and data array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.13)"><strong>FileNotFoundError</strong></a> – If the specified output file cannot be found.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the file is empty, the header cannot be parsed, or the data array cannot be loaded.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Extract thermodynamic properties from a log file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">header</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">ts_idx</span> <span class="o">=</span> <span class="n">get_thermo_props</span><span class="p">(</span><span class="s1">&#39;md.log&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timesteps</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">ts_idx</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Read </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">timesteps</span><span class="p">)</span><span class="si">}</span><span class="s2"> time steps from the log file&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function assumes a specific log file format with a header line starting with ‘#’
followed by space-separated column names, and data lines starting from the third line.
It uses <cite>np.loadtxt</cite> to parse the data, which expects numerical values.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.io.iter_lammps_dump">
<span class="sig-prename descclassname"><span class="pre">target.io.</span></span><span class="sig-name descname"><span class="pre">iter_lammps_dump</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/io.html#iter_lammps_dump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.io.iter_lammps_dump" title="Link to this definition"></a></dt>
<dd><p>Generator version of read_lammps_dump: yields one frame at a time as a dict.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.io.pos_2_absolute">
<span class="sig-prename descclassname"><span class="pre">target.io.</span></span><span class="sig-name descname"><span class="pre">pos_2_absolute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postype</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/io.html#pos_2_absolute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.io.pos_2_absolute" title="Link to this definition"></a></dt>
<dd><p>Convert fractional coordinates to absolute (Cartesian) coordinates.</p>
<p>This function transforms positions from fractional (scaled) coordinates to
absolute Cartesian coordinates using the provided unit cell vectors. It handles
different position types based on the <cite>postype</cite> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell</strong> (<em>np.ndarray</em>) – Unit cell vectors with shape (3, 3). Each row represents one lattice vector [a, b, c].</p></li>
<li><p><strong>pos</strong> (<em>np.ndarray</em>) – Position array with shape (…, 3). Can be in fractional (scaled) or absolute coordinates
depending on <cite>postype</cite>.</p></li>
<li><p><strong>postype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Type of position coordinates:
- ‘u’ or ‘w’ or ‘’: Already absolute (unwrapped or wrapped), returned as is.
- ‘s’: Scaled (fractional), converted to absolute using the cell vectors.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Positions in Cartesian coordinates with the same shape as the input <cite>pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – If <cite>postype</cite> is an unknown value (not ‘u’, ‘w’, ‘’, or ‘s’).</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Convert from fractional to Cartesian coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frac_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cart_pos</span> <span class="o">=</span> <span class="n">pos_2_absolute</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">frac_pos</span><span class="p">,</span> <span class="n">postype</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cart_pos</span><span class="p">)</span>  <span class="c1"># Output: array([[0., 0., 0.], [5., 5., 5.]])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is typically used when reading trajectory data from formats like LAMMPS
dump files, where positions may be provided in scaled (fractional) coordinates that
need conversion to absolute coordinates for analysis.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.io.read_lammps_dump">
<span class="sig-prename descclassname"><span class="pre">target.io.</span></span><span class="sig-name descname"><span class="pre">read_lammps_dump</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermo_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermo_pe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermo_stress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_extxyz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_forces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_velocities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_keywords_dump</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sorted_atom_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/io.html#read_lammps_dump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.io.read_lammps_dump" title="Link to this definition"></a></dt>
<dd><p>Read LAMMPS dump file and convert to ASE trajectory format.</p>
<p>This function parses LAMMPS dump files containing atomic positions and converts
them to ASE Atoms objects. It handles periodic boundary conditions, atom ordering,
and provides options for format conversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to LAMMPS dump file (.lammpstrj format).</p></li>
<li><p><strong>elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em>) – List of element symbols in order of atom types. Example: [‘Li’, ‘Al’, ‘P’, ‘S’, ‘O’] for types 1-5.</p></li>
<li><p><strong>elements_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Path to a file containing space-separated element symbols.</p></li>
<li><p><strong>types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em>) – List of type mappings to element symbols if type field is present in dump.</p></li>
<li><p><strong>timestep</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Time step between frames in picoseconds. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code> (not set).</p></li>
<li><p><strong>mass_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Path to LAMMPS input file with mass definitions to infer elements.</p></li>
<li><p><strong>thermo_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Path to thermodynamic output file for additional properties.</p></li>
<li><p><strong>thermo_pe</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Thermo keyword for potential energy in <cite>thermo_file</cite>.</p></li>
<li><p><strong>thermo_stress</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Thermo keyword prefix for stress components (without xx/yy/zz suffixes).</p></li>
<li><p><strong>save_extxyz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to save trajectory in extended XYZ format. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>outfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Output filename for saved trajectory. If <code class="docutils literal notranslate"><span class="pre">None</span></code> and <cite>save_extxyz=True</cite>, uses input filename with .extxyz extension.</p></li>
<li><p><strong>ignore_forces</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, ignores force data in dump file. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>ignore_velocities</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, ignores velocity data in dump file. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>skip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of initial steps to skip. Default is 0.</p></li>
<li><p><strong>f_conv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Conversion factor for forces. Default is 1.0.</p></li>
<li><p><strong>e_conv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Conversion factor for energies. Default is 1.0.</p></li>
<li><p><strong>s_conv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Conversion factor for stresses. Default is 1.0.</p></li>
<li><p><strong>additional_keywords_dump</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em>) – Additional keywords to read from dump file. Default is empty list.</p></li>
<li><p><strong>quiet</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, suppresses output messages. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>istep</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Frequency of steps to take from trajectory. Default is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A SAMOS Trajectory object representing the parsed trajectory frames with positions, cells, and optional velocities/forces.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#target.trajectory.Trajectory" title="target.trajectory.Trajectory">Trajectory</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.13)"><strong>FileNotFoundError</strong></a> – If the LAMMPS dump file or related files (e.g., <cite>elements_file</cite>, <cite>thermo_file</cite>) cannot be found.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the file format is invalid, element list is inconsistent, or thermodynamic data mismatches timesteps.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – If certain features (e.g., scaled unwrapped coordinates) are not supported.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read LAMMPS trajectory with 5 element types</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Li&#39;</span><span class="p">,</span> <span class="s1">&#39;Al&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">read_lammps_dump</span><span class="p">(</span><span class="s1">&#39;dump.lammpstrj&#39;</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="n">timestep</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Read </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">get_positions</span><span class="p">())</span><span class="si">}</span><span class="s2"> frames with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span><span class="si">}</span><span class="s2"> atoms each&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Save as extended XYZ for further analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">read_lammps_dump</span><span class="p">(</span><span class="s1">&#39;dump.lammpstrj&#39;</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="n">save_extxyz</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="s1">&#39;trajectory.extxyz&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>LAMMPS atom types are mapped to element symbols based on the order in the <cite>elements</cite> list or inferred from masses if <cite>mass_types</cite> is provided.</p></li>
<li><p>Periodic boundary conditions are automatically handled.</p></li>
<li><p>The function assumes a standard LAMMPS dump format with id, type, x, y, z columns.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.io.read_positions_with_ase">
<span class="sig-prename descclassname"><span class="pre">target.io.</span></span><span class="sig-name descname"><span class="pre">read_positions_with_ase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/io.html#read_positions_with_ase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.io.read_positions_with_ase" title="Link to this definition"></a></dt>
<dd><p>Read atomic positions using ASE with automatic format detection.</p>
<p>This function provides a unified interface for reading various trajectory
formats using the ASE library. It automatically detects file formats when
possible and returns a list of Atoms objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the trajectory file.</p></li>
<li><p><strong>format</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Explicit format specification. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, ASE will attempt to auto-detect the format.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of ASE Atoms objects for each frame in the trajectory.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.13)"><strong>FileNotFoundError</strong></a> – If the trajectory file cannot be found.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the file format cannot be determined or is unsupported by ASE.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read XYZ trajectory with auto-detection</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frames</span> <span class="o">=</span> <span class="n">read_positions_with_ase</span><span class="p">(</span><span class="s1">&#39;trajectory.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read with explicit format for VASP output</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frames</span> <span class="o">=</span> <span class="n">read_positions_with_ase</span><span class="p">(</span><span class="s1">&#39;OUTCAR&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;vasp-out&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span><span class="si">}</span><span class="s2"> frames&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.io.read_step_info">
<span class="sig-prename descclassname"><span class="pre">target.io.</span></span><span class="sig-name descname"><span class="pre">read_step_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lines</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lidx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/io.html#read_step_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.io.read_step_info" title="Link to this definition"></a></dt>
<dd><p>Read time step information from trajectory file lines.</p>
<p>This function extracts time step numbers and cell dimensions from a block of
lines corresponding to a single time step in various trajectory file formats,
primarily LAMMPS dump files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lines</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – List of lines representing a single time step block from a trajectory file.</p></li>
<li><p><strong>lidx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Line index offset for error messages. Default is 0.</p></li>
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, parse additional header information such as atom IDs and positions.
Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>additional_kw</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Additional keywords to look for in the header line when parsing atom data.
Default is an empty list.</p></li>
<li><p><strong>quiet</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, suppresses print statements for debugging or status updates.
Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>If <cite>start</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, returns:
- nat (int): Number of atoms.
- timestep (int): Current time step number.
- cell (np.ndarray): 3x3 array of cell dimensions.</p>
<p>If <cite>start</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, returns:
- nat (int): Number of atoms.
- atomid_idx (int): Index of atom ID in header.
- element_idx (int or None): Index of element symbol in header, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if not present.
- type_idx (int or None): Index of atom type in header, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if not present.
- postype (str): Position type postfix (‘u’ for unwrapped, ‘s’ for scaled, or ‘’ for wrapped).
- posids (np.ndarray): Indices of position components in header.
- has_vel (bool): Whether velocities are present.
- velids (np.ndarray or None): Indices of velocity components if present, otherwise <code class="docutils literal notranslate"><span class="pre">None</span></code>.
- has_frc (bool): Whether forces are present.
- frcids (np.ndarray or None): Indices of force components if present, otherwise <code class="docutils literal notranslate"><span class="pre">None</span></code>.
- additional_ids (list): Indices of additional keywords if present.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><strong>Exception</strong></a> – If the lines do not start with expected headers (e.g., ‘ITEM: TIMESTEP’) or required data is missing.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If cell dimensions, atom counts, or other critical data cannot be parsed correctly.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read time step information from the first block of a LAMMPS dump file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dump.lammpstrj&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nat</span><span class="p">,</span> <span class="n">timestep</span><span class="p">,</span> <span class="n">cell</span> <span class="o">=</span> <span class="n">read_step_info</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Timestep: </span><span class="si">{</span><span class="n">timestep</span><span class="si">}</span><span class="s2">, Number of atoms: </span><span class="si">{</span><span class="n">nat</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is designed to parse LAMMPS dump file formats and expects a specific
structure with headers like ‘ITEM: TIMESTEP’, ‘ITEM: NUMBER OF ATOMS’, and ‘ITEM: BOX BOUNDS’.
It supports both orthogonal and triclinic cells.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.io.read_xsf">
<span class="sig-prename descclassname"><span class="pre">target.io.</span></span><span class="sig-name descname"><span class="pre">read_xsf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fold_positions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/io.html#read_xsf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.io.read_xsf" title="Link to this definition"></a></dt>
<dd><p>Read XSF file and return ASE Atoms objects.</p>
<p>This function parses XSF files and converts them to ASE format for further
analysis. It handles both single structures and animated (multi-frame) XSF files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the XSF file.</p></li>
<li><p><strong>fold_positions</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, folds atomic positions into the unit cell using periodic boundary conditions. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing:
- data: 3D grid data as a numpy array.
- volume_ang: Volume of the unit cell in Ångstroms³.
- volume_au: Volume of the unit cell in atomic units (Bohr³).
- atoms: List of atomic symbols.
- positions: List of atomic positions.
- cell: Unit cell vectors as a 3x3 array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.13)"><strong>FileNotFoundError</strong></a> – If the XSF file cannot be found.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><strong>Exception</strong></a> – If no cell is read from the XSF file or the file format is invalid.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read an XSF file for a crystal structure</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xsf_data</span> <span class="o">=</span> <span class="n">read_xsf</span><span class="p">(</span><span class="s1">&#39;crystal.xsf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Read structure with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">xsf_data</span><span class="p">[</span><span class="s1">&#39;atoms&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> atoms&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cell volume: </span><span class="si">{</span><span class="n">xsf_data</span><span class="p">[</span><span class="s1">&#39;volume_ang&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å³&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.io.write_grid">
<span class="sig-prename descclassname"><span class="pre">target.io.</span></span><span class="sig-name descname"><span class="pre">write_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfilename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vals_per_line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/io.html#write_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.io.write_grid" title="Link to this definition"></a></dt>
<dd><p>Write 3D grid data to file for visualization or further analysis.</p>
<p>This function outputs 3D scalar field data (such as electron density or ionic
density) in a simple text format suitable for visualization programs or further
processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – 3D grid data with shape (nx, ny, nz) containing the scalar field values.</p></li>
<li><p><strong>outfilename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>None</em><em>, </em><em>optional</em>) – Output filename for the grid data. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, writes to stdout. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>vals_per_line</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of values per line in the output file. Default is 5.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Writes the grid data to the specified file or stdout.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><strong>Exception</strong></a> – If the output file cannot be opened or if <cite>outfilename</cite> is invalid.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#IOError" title="(in Python v3.13)"><strong>IOError</strong></a> – If there are issues writing to the specified <cite>outfilename</cite>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write a random 3D density grid to a file for visualization</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">write_grid</span><span class="p">(</span><span class="n">density</span><span class="p">,</span> <span class="n">outfilename</span><span class="o">=</span><span class="s1">&#39;density.grid&#39;</span><span class="p">,</span> <span class="n">vals_per_line</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The output format is a simple text file with the first line indicating the grid
dimensions (nx+1, ny+1, nz+1) followed by the grid data values in scientific notation,
ordered by z, y, x indices. This format is compatible with certain visualization tools
or can be post-processed for other formats like XSF.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.io.write_xsf">
<span class="sig-prename descclassname"><span class="pre">target.io.</span></span><span class="sig-name descname"><span class="pre">write_xsf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vals_per_line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfilename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_flattened</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/io.html#write_xsf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.io.write_xsf" title="Link to this definition"></a></dt>
<dd><p>Write trajectory to XSF format for visualization.</p>
<p>XSF (XCrySDen Structure File) format is commonly used for crystal structure
visualization. This function writes a trajectory as an XSF file that can be
viewed in programs like XCrySDen or VESTA, including structural data and
optional 3D grid data for scalar fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of atomic symbols corresponding to the atoms in the structure.</p></li>
<li><p><strong>positions</strong> (<em>np.ndarray</em>) – Array of atomic positions with shape (N, 3) where N is the number of atoms.</p></li>
<li><p><strong>cell</strong> (<em>np.ndarray</em>) – Unit cell vectors as a 3x3 array representing the simulation box.</p></li>
<li><p><strong>data</strong> (<em>np.ndarray</em>) – 3D grid data for the scalar field (e.g., electron density) to be visualized.</p></li>
<li><p><strong>vals_per_line</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of values per line in the output file for grid data. Default is 6.</p></li>
<li><p><strong>outfilename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>None</em><em>, </em><em>optional</em>) – Output XSF filename. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, writes to stdout. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>is_flattened</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether the <cite>data</cite> array is flattened. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>, </em><em>optional</em>) – Original shape of the <cite>data</cite> if flattened (required if <cite>is_flattened</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>).
Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Writes the XSF formatted data to the specified file or stdout.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><strong>Exception</strong></a> – If the output file cannot be opened or if <cite>shape</cite> is not provided for flattened data.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#IOError" title="(in Python v3.13)"><strong>IOError</strong></a> – If there are issues writing to the specified <cite>outfilename</cite>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write XSF file for visualization of a crystal structure with density data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Li&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">10.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">write_xsf</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">outfilename</span><span class="o">=</span><span class="s1">&#39;output.xsf&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>XSF files support both structural data (atoms and positions) and associated scalar
fields (like electron density) on a 3D grid. This function handles both, formatting
the data according to the XSF specification for visualization in compatible software.</p>
</div>
</dd></dl>

<section id="supported-file-types">
<h3>Supported File Types<a class="headerlink" href="#supported-file-types" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>.pos files</strong>: Position trajectories (Quantum ESPRESSO, etc.)</p></li>
<li><p><strong>.cel files</strong>: Unit cell parameters</p></li>
<li><p><strong>.evp files</strong>: Energy, volume, pressure data</p></li>
<li><p><strong>.in files</strong>: Ion definitions and atomic information</p></li>
<li><p><strong>LAMMPS dump files</strong>: .lammpstrj, .dump</p></li>
<li><p><strong>BOMD trajectory files</strong>: .trj (Born-Oppenheimer MD)</p></li>
<li><p><strong>XSF files</strong>: For visualization</p></li>
<li><p><strong>Extended XYZ files</strong>: .extxyz</p></li>
</ul>
</section>
<section id="bomd-support">
<h3>BOMD Support<a class="headerlink" href="#bomd-support" title="Link to this heading"></a></h3>
<p>CPDyAna supports Born-Oppenheimer Molecular Dynamics (BOMD) analysis via:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#target.input_reader.read_bomd_trajectory" title="target.input_reader.read_bomd_trajectory"><code class="xref py py-func docutils literal notranslate"><span class="pre">target.input_reader.read_bomd_trajectory()</span></code></a> — Read and parse BOMD .trj files</p></li>
<li><p>BOMD-specific CLI arguments: <cite>–bomd-elements</cite>, <cite>–bomd-timestep</cite>, etc.</p></li>
</ul>
</section>
</section>
<section id="core-calculations">
<h2>Core Calculations<a class="headerlink" href="#core-calculations" title="Link to this heading"></a></h2>
<p>Main calculation routines for MSD, NGP, and diffusion analysis.</p>
<section id="calculations-module-for-cpdyana">
<span id="module-target.calculations"></span><h3>Calculations Module for CPDyAna<a class="headerlink" href="#calculations-module-for-cpdyana" title="Link to this heading"></a></h3>
<p>This module provides the core calculation functions for molecular dynamics analysis,
focusing on Mean Square Displacement (MSD) calculations, diffusion coefficient
determination, and Non-Gaussian Parameter (NGP) analysis for both tracer and collective diffusion.</p>
<p>The module implements efficient algorithms for:
- MSD calculation for individual and collective particle motion
- Linear regression analysis for diffusion coefficient extraction
- Multi-directional diffusivity analysis (X, Y, Z, XY, XZ, YZ, XYZ)
- Statistical block averaging for error estimation
- Non-Gaussian Parameter (NGP) calculation for dynamical heterogeneity</p>
<dl class="simple">
<dt>Functions:</dt><dd><p>calculate_msd: Main MSD calculation orchestrator (LAMMPS and QE support)
msd_tracer: Individual particle MSD calculation
msd_charged: Collective/charged species MSD calculation
calculate_ngp: Non-Gaussian Parameter calculation for tracer diffusion</p>
</dd>
</dl>
<p>Author: CPDyAna Development Team
Version: 06-25-2025</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="target.calculations.calc_fft">
<span class="sig-prename descclassname"><span class="pre">target.calculations.</span></span><span class="sig-name descname"><span class="pre">calc_fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/calculations.html#calc_fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.calculations.calc_fft" title="Link to this definition"></a></dt>
<dd><p>Efficiently compute the autocorrelation using FFT for MSD calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>np.ndarray</em>) – 1D array of positions for a single coordinate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Autocorrelation result for MSD computation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.calculations.calc_msd_tracer">
<span class="sig-prename descclassname"><span class="pre">target.calculations.</span></span><span class="sig-name descname"><span class="pre">calc_msd_tracer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/calculations.html#calc_msd_tracer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.calculations.calc_msd_tracer" title="Link to this definition"></a></dt>
<dd><p>Calculate MSD for a single particle trajectory using an efficient algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>np.ndarray</em>) – Trajectory array (steps, 3) for one particle.</p></li>
<li><p><strong>d_idx</strong> (<em>np.ndarray</em>) – Array of time lag indices.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(MSD array for selected lags, MSD array per dimension for selected lags)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.calculations.calc_ngp_tracer">
<span class="sig-prename descclassname"><span class="pre">target.calculations.</span></span><span class="sig-name descname"><span class="pre">calc_ngp_tracer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/calculations.html#calc_ngp_tracer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.calculations.calc_ngp_tracer" title="Link to this definition"></a></dt>
<dd><p>Calculate Non-Gaussian Parameter (NGP) for tracer diffusion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>np.ndarray</em>) – Position array (time_steps, 3) for one particle.</p></li>
<li><p><strong>d</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Dimensionality (1, 2, or 3).</p></li>
<li><p><strong>d_idx</strong> (<em>np.ndarray</em>) – Array of time lag indices.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>NGP values for specified time lags.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.calculations.calculate_msd">
<span class="sig-prename descclassname"><span class="pre">target.calculations.</span></span><span class="sig-name descname"><span class="pre">calculate_msd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusivity_direction_choices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusivity_choices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conduct_rectified_structure_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conduct_ions_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Last_term</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_slope_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_slope_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_lammps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammps_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'metal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_param_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/calculations.html#calculate_msd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.calculations.calculate_msd" title="Link to this definition"></a></dt>
<dd><p>Main orchestrator for MSD and diffusivity calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of diffusing elements.</p></li>
<li><p><strong>diffusivity_direction_choices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Directions for analysis.</p></li>
<li><p><strong>diffusivity_choices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Types of diffusivity.</p></li>
<li><p><strong>pos_full</strong> – Trajectory and ion data.</p></li>
<li><p><strong>conduct_rectified_structure_array</strong> – Trajectory and ion data.</p></li>
<li><p><strong>conduct_ions_array</strong> – Trajectory and ion data.</p></li>
<li><p><strong>t</strong> (<em>np.ndarray</em>) – Time array.</p></li>
<li><p><strong>Last_term</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Last index for analysis.</p></li>
<li><p><strong>initial_slope_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Start time for slope fitting.</p></li>
<li><p><strong>final_slope_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – End time for slope fitting.</p></li>
<li><p><strong>block</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Block size for error estimation.</p></li>
<li><p><strong>is_lammps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, use LAMMPS-style calculation.</p></li>
<li><p><strong>dt_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time step value for LAMMPS.</p></li>
<li><p><strong>lammps_units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – LAMMPS units.</p></li>
<li><p><strong>atom_types</strong> – Optional atom/cell info.</p></li>
<li><p><strong>cell_param_full</strong> – Optional atom/cell info.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nested dictionary with MSD, diffusivity, and error estimates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.calculations.calculate_msd_lammps">
<span class="sig-prename descclassname"><span class="pre">target.calculations.</span></span><span class="sig-name descname"><span class="pre">calculate_msd_lammps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusivity_direction_choices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusivity_choices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conduct_rectified_structure_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conduct_ions_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Last_term</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_slope_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_slope_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammps_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'metal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_param_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/calculations.html#calculate_msd_lammps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.calculations.calculate_msd_lammps" title="Link to this definition"></a></dt>
<dd><p>Calculate MSD and diffusivity for LAMMPS-style trajectory data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of diffusing elements.</p></li>
<li><p><strong>diffusivity_direction_choices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Directions for analysis.</p></li>
<li><p><strong>diffusivity_choices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Types of diffusivity (‘Tracer’, ‘Charged’, etc.).</p></li>
<li><p><strong>pos_full</strong> – Trajectory and ion data.</p></li>
<li><p><strong>conduct_rectified_structure_array</strong> – Trajectory and ion data.</p></li>
<li><p><strong>conduct_ions_array</strong> – Trajectory and ion data.</p></li>
<li><p><strong>t</strong> (<em>np.ndarray</em>) – Time array.</p></li>
<li><p><strong>Last_term</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Last index for analysis.</p></li>
<li><p><strong>initial_slope_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Start time for slope fitting.</p></li>
<li><p><strong>final_slope_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – End time for slope fitting.</p></li>
<li><p><strong>block</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Block size for error estimation.</p></li>
<li><p><strong>dt_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time step value.</p></li>
<li><p><strong>lammps_units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – LAMMPS units.</p></li>
<li><p><strong>atom_types</strong> – Optional atom/cell info.</p></li>
<li><p><strong>cell_param_full</strong> – Optional atom/cell info.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nested dictionary with MSD, diffusivity, and error estimates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.calculations.calculate_msd_qe">
<span class="sig-prename descclassname"><span class="pre">target.calculations.</span></span><span class="sig-name descname"><span class="pre">calculate_msd_qe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusivity_direction_choices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusivity_choices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conduct_rectified_structure_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conduct_ions_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Last_term</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_slope_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_slope_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_param_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/calculations.html#calculate_msd_qe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.calculations.calculate_msd_qe" title="Link to this definition"></a></dt>
<dd><p>Calculate MSD and diffusivity for Quantum Espresso-style trajectory data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of diffusing elements.</p></li>
<li><p><strong>diffusivity_direction_choices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Directions for analysis.</p></li>
<li><p><strong>diffusivity_choices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Types of diffusivity (‘Tracer’, ‘Charged’).</p></li>
<li><p><strong>pos_full</strong> – Trajectory and ion data.</p></li>
<li><p><strong>conduct_rectified_structure_array</strong> – Trajectory and ion data.</p></li>
<li><p><strong>conduct_ions_array</strong> – Trajectory and ion data.</p></li>
<li><p><strong>t</strong> (<em>np.ndarray</em>) – Time array.</p></li>
<li><p><strong>Last_term</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Last index for analysis.</p></li>
<li><p><strong>initial_slope_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Start time for slope fitting.</p></li>
<li><p><strong>final_slope_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – End time for slope fitting.</p></li>
<li><p><strong>block</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Block size for error estimation.</p></li>
<li><p><strong>atom_types</strong> – Optional atom/cell info.</p></li>
<li><p><strong>cell_param_full</strong> – Optional atom/cell info.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nested dictionary with MSD, diffusivity, and error estimates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.calculations.calculate_ngp">
<span class="sig-prename descclassname"><span class="pre">target.calculations.</span></span><span class="sig-name descname"><span class="pre">calculate_ngp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diffusing_elements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusivity_direction_choices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conduct_rectified_structure_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conduct_ions_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/calculations.html#calculate_ngp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.calculations.calculate_ngp" title="Link to this definition"></a></dt>
<dd><p>Calculate Non-Gaussian Parameter (NGP) for specified elements and directions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>diffusing_elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Elements to analyze (e.g., [‘Li’]).</p></li>
<li><p><strong>diffusivity_direction_choices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Directions (e.g., [‘XYZ’]).</p></li>
<li><p><strong>pos_full</strong> (<em>np.ndarray</em>) – Full position trajectory.</p></li>
<li><p><strong>conduct_rectified_structure_array</strong> (<em>np.ndarray</em>) – Unwrapped positions.</p></li>
<li><p><strong>conduct_ions_array</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Ion indices.</p></li>
<li><p><strong>dt</strong> (<em>np.ndarray</em>) – Time step array (ps).</p></li>
<li><p><strong>initial_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Start time for analysis (ps).</p></li>
<li><p><strong>final_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – End time for analysis (ps).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nested dictionary with NGP and time lag data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.calculations.disp_sum">
<span class="sig-prename descclassname"><span class="pre">target.calculations.</span></span><span class="sig-name descname"><span class="pre">disp_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mobile_ion_pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/calculations.html#disp_sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.calculations.disp_sum" title="Link to this definition"></a></dt>
<dd><p>Calculate the sum of squared displacements for a given time delta.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Time step difference.</p></li>
<li><p><strong>mobile_ion_pos</strong> (<em>np.ndarray</em>) – Array of shape (num_mobile_ions, steps, 3).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sum of squared displacements.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.calculations.msd_charged">
<span class="sig-prename descclassname"><span class="pre">target.calculations.</span></span><span class="sig-name descname"><span class="pre">msd_charged</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_msd</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/calculations.html#msd_charged"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.calculations.msd_charged" title="Link to this definition"></a></dt>
<dd><p>Calculate the charged MSD for a given 3D position array and tracer MSD.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>np.ndarray</em>) – Array of shape (num_mobile_ions, steps, 3).</p></li>
<li><p><strong>final_msd</strong> (<em>np.ndarray</em>) – Tracer MSD array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Charged MSD values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.calculations.msd_tracer">
<span class="sig-prename descclassname"><span class="pre">target.calculations.</span></span><span class="sig-name descname"><span class="pre">msd_tracer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/calculations.html#msd_tracer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.calculations.msd_tracer" title="Link to this definition"></a></dt>
<dd><p>Calculate average tracer MSD for all mobile ions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>np.ndarray</em>) – Array of shape (num_mobile_ions, steps, 3).</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of time steps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Average tracer MSD over all ions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<section id="analysis-types">
<h3>Analysis Types<a class="headerlink" href="#analysis-types" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Mean Square Displacement</strong>: Tracer and collective diffusivity (LAMMPS and BOMD)</p></li>
<li><p><strong>Non-Gaussian Parameter</strong>: Dynamical heterogeneity</p></li>
<li><p><strong>Diffusion Coefficients</strong>: Multi-directional analysis (X, Y, Z, XY, XZ, YZ, XYZ)</p></li>
<li><p><strong>Statistical Analysis</strong>: Block averaging and error estimation</p></li>
</ul>
</section>
</section>
<section id="correlation-analysis">
<h2>Correlation Analysis<a class="headerlink" href="#correlation-analysis" title="Link to this heading"></a></h2>
<p>Van Hove correlation functions and related analysis.</p>
<section id="correlation-analysis-module-for-cpdyana">
<span id="module-target.correrelation_analysis"></span><h3>Correlation Analysis Module for CPDyAna<a class="headerlink" href="#correlation-analysis-module-for-cpdyana" title="Link to this heading"></a></h3>
<p>This module provides functions for calculating Van Hove correlation functions
(self and distinct parts) for molecular dynamics trajectories. It is compatible
with Quantum ESPRESSO, LAMMPS, and BOMD (.trj) trajectory formats as parsed by
the CPDyAna input_reader module.</p>
<dl class="simple">
<dt>Functions:</dt><dd><p>Van_Hove_self:   Compute the self part of the Van Hove function for ion diffusion.
Van_Hove_distinct: Compute the distinct part of the Van Hove function for ion diffusion.</p>
</dd>
</dl>
<p>Author: CPDyAna Development Team
Version: 2025-07-09</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="target.correrelation_analysis.Van_Hove_distinct">
<span class="sig-prename descclassname"><span class="pre">target.correrelation_analysis.</span></span><span class="sig-name descname"><span class="pre">Van_Hove_distinct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">avg_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_skip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moving_ion_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/correrelation_analysis.html#Van_Hove_distinct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.correrelation_analysis.Van_Hove_distinct" title="Link to this definition"></a></dt>
<dd><p>Calculate the distinct part of the Van Hove function for ion diffusion.</p>
<p>Compatible with BOMD (.trj), QE, and LAMMPS trajectories as parsed by input_reader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>avg_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of steps to average over.</p></li>
<li><p><strong>dt</strong> (<em>np.ndarray</em>) – Time array (ps).</p></li>
<li><p><strong>rmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Maximum distance for radial distribution (Å).</p></li>
<li><p><strong>step_skip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of steps to skip between time origins.</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Standard deviation for Gaussian broadening (Å).</p></li>
<li><p><strong>ngrid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of grid points for distance histogram.</p></li>
<li><p><strong>moving_ion_pos</strong> (<em>np.ndarray</em>) – Ion positions, shape (n_ions, n_steps, 3).</p></li>
<li><p><strong>volume</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Simulation cell volume (Å³).</p></li>
<li><p><strong>x1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Cell vectors (Å).</p></li>
<li><p><strong>x2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Cell vectors (Å).</p></li>
<li><p><strong>x3</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Cell vectors (Å).</p></li>
<li><p><strong>y1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Cell vectors (Å).</p></li>
<li><p><strong>y2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Cell vectors (Å).</p></li>
<li><p><strong>y3</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Cell vectors (Å).</p></li>
<li><p><strong>z1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Cell vectors (Å).</p></li>
<li><p><strong>z2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Cell vectors (Å).</p></li>
<li><p><strong>z3</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Cell vectors (Å).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(dist_interval, reduced_nt, gdrt)</dt><dd><p>dist_interval (np.ndarray): Distance grid (Å).
reduced_nt (int): Number of reduced time steps.
gdrt (np.ndarray): Van Hove distinct part, shape (reduced_nt, ngrid).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.correrelation_analysis.Van_Hove_self">
<span class="sig-prename descclassname"><span class="pre">target.correrelation_analysis.</span></span><span class="sig-name descname"><span class="pre">Van_Hove_self</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">avg_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_skip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moving_ion_pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/correrelation_analysis.html#Van_Hove_self"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.correrelation_analysis.Van_Hove_self" title="Link to this definition"></a></dt>
<dd><p>Calculate the self part of the Van Hove function for ion diffusion.</p>
<p>Compatible with BOMD (.trj), QE, and LAMMPS trajectories as parsed by input_reader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>avg_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of steps to average over.</p></li>
<li><p><strong>dt</strong> (<em>np.ndarray</em>) – Time array (ps).</p></li>
<li><p><strong>rmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Maximum distance for radial distribution (Å).</p></li>
<li><p><strong>step_skip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of steps to skip between time origins.</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Standard deviation for Gaussian broadening (Å).</p></li>
<li><p><strong>ngrid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of grid points for distance histogram.</p></li>
<li><p><strong>moving_ion_pos</strong> (<em>np.ndarray</em>) – Ion positions, shape (n_ions, n_steps, 3).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(dist_interval, reduced_nt, gsrt)</dt><dd><p>dist_interval (np.ndarray): Distance grid (Å).
reduced_nt (int): Number of reduced time steps.
gsrt (np.ndarray): Van Hove self part, shape (reduced_nt, ngrid).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<section id="correlation-types">
<h3>Correlation Types<a class="headerlink" href="#correlation-types" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Self Correlation</strong>: Single particle dynamics (<a class="reference internal" href="#target.correrelation_analysis.Van_Hove_self" title="target.correrelation_analysis.Van_Hove_self"><code class="xref py py-func docutils literal notranslate"><span class="pre">target.correrelation_analysis.Van_Hove_self()</span></code></a>)</p></li>
<li><p><strong>Distinct Correlation</strong>: Pair dynamics (<a class="reference internal" href="#target.correrelation_analysis.Van_Hove_distinct" title="target.correrelation_analysis.Van_Hove_distinct"><code class="xref py py-func docutils literal notranslate"><span class="pre">target.correrelation_analysis.Van_Hove_distinct()</span></code></a>)</p></li>
</ul>
</section>
</section>
<section id="rdf-computation">
<h2>RDF Computation<a class="headerlink" href="#rdf-computation" title="Link to this heading"></a></h2>
<p>Radial distribution function calculations (LAMMPS, BOMD, QE).</p>
<p id="module-target.compute_rdf">compute_rdf.py</p>
<p>Compute Radial Distribution Functions (RDFs) from Quantum ESPRESSO or LAMMPS molecular dynamics output files.
This script builds atomic trajectories using ASE, converts them to pymatgen structures, and calculates RDFs for various atom pairs using pymatgen’s efficient implementation.</p>
<p>Flexible CLI options allow user control over RDF parameters and plotting.</p>
<dl class="simple">
<dt>Usage:</dt><dd><p>python compute_rdf.py –in-file LiAlPS.in –pos-file LiAlPS.pos –cel-file LiAlPS.cel
# For more options:
python compute_rdf.py –help</p>
</dd>
</dl>
<p>Author: CPDyAna Development Team
Version: 2025-06-25</p>
<dl class="py function">
<dt class="sig sig-object py" id="target.compute_rdf.build_ase_trajectory">
<span class="sig-prename descclassname"><span class="pre">target.compute_rdf.</span></span><span class="sig-name descname"><span class="pre">build_ase_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cel_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_after_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.00193511</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_rdf.html#build_ase_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_rdf.build_ase_trajectory" title="Link to this definition"></a></dt>
<dd><p>Build ASE trajectory frames from Quantum ESPRESSO output files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the .in input file.</p></li>
<li><p><strong>pos_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the .pos position file.</p></li>
<li><p><strong>cel_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the .cel cell parameter file.</p></li>
<li><p><strong>time_after_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time in ps after which to start extracting frames.</p></li>
<li><p><strong>num_frames</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of frames to extract.</p></li>
<li><p><strong>time_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time interval between frames in ps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of ASE Atoms objects representing the trajectory frames.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.compute_rdf.build_bomd_trajectory">
<span class="sig-prename descclassname"><span class="pre">target.compute_rdf.</span></span><span class="sig-name descname"><span class="pre">build_bomd_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trj_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_rdf.html#build_bomd_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_rdf.build_bomd_trajectory" title="Link to this definition"></a></dt>
<dd><p>Build ASE trajectory frames from BOMD (.trj) output files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trj_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the BOMD .trj trajectory file.</p></li>
<li><p><strong>cell_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Path to a file containing cell parameters per frame (optional).</p></li>
<li><p><strong>num_frames</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of frames to extract.</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Stride for frame extraction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of ASE Atoms objects representing the trajectory frames.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.compute_rdf.build_lammps_trajectory">
<span class="sig-prename descclassname"><span class="pre">target.compute_rdf.</span></span><span class="sig-name descname"><span class="pre">build_lammps_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lammps_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammps_elements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_mapping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammps_timestep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_rdf.html#build_lammps_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_rdf.build_lammps_trajectory" title="Link to this definition"></a></dt>
<dd><p>Build ASE trajectory frames from a LAMMPS dump file using CPDyAna input_reader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lammps_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to LAMMPS trajectory file.</p></li>
<li><p><strong>lammps_elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of atom-type symbols.</p></li>
<li><p><strong>element_mapping</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – Mapping from atom type index to element symbol.</p></li>
<li><p><strong>lammps_timestep</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Timestep in ps.</p></li>
<li><p><strong>num_frames</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of frames to extract.</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Stride for frame extraction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of ASE Atoms objects representing the trajectory frames.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.compute_rdf.compute_rdf">
<span class="sig-prename descclassname"><span class="pre">target.compute_rdf.</span></span><span class="sig-name descname"><span class="pre">compute_rdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rdf_plot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_after_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pair_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngrid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1.5,</span> <span class="pre">8.0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_rdf.html#compute_rdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_rdf.compute_rdf" title="Link to this definition"></a></dt>
<dd><p>Compute RDF for various atom pairs and generate plots with RDF integrals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of ASE Atoms objects representing the trajectory.</p></li>
<li><p><strong>output_prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Prefix for output plot filenames.</p></li>
<li><p><strong>time_after_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time after start for filename generation.</p></li>
<li><p><strong>central_atoms</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of central atom types (default: [‘Li’, ‘Al’, ‘P’, ‘S’]).</p></li>
<li><p><strong>pair_atoms</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of pair atom types (default: same as central_atoms).</p></li>
<li><p><strong>ngrid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of radial grid points.</p></li>
<li><p><strong>rmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Maximum distance for RDF calculation (Å).</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Gaussian broadening parameter.</p></li>
<li><p><strong>xlim</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – x-axis limits for plot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Contains r (distance array) and RDF arrays for different atom pairs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.compute_rdf.main">
<span class="sig-prename descclassname"><span class="pre">target.compute_rdf.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_rdf.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_rdf.main" title="Link to this definition"></a></dt>
<dd><p>Command-line interface for computing RDF from QE or LAMMPS files.</p>
<p>Parses arguments, builds trajectories, computes RDFs, and generates plots.</p>
</dd></dl>

</section>
<section id="vaf-computation">
<h2>VAF Computation<a class="headerlink" href="#vaf-computation" title="Link to this heading"></a></h2>
<p>Velocity autocorrelation function analysis.</p>
<p id="module-target.compute_vaf">compute_vaf.py</p>
<p>Read QE .in/.pos/.cel[/.evp], LAMMPS, or BOMD .trj, build ASE+Velocities, compute VAF, and plot.</p>
<p>This script reads Quantum ESPRESSO, LAMMPS, or BOMD trajectory files, constructs ASE Atoms objects with velocities,
computes the velocity autocorrelation function (VAF) for specified elements, and plots/saves the results.</p>
<dl class="simple">
<dt>Usage example:</dt><dd><p>python compute_vaf.py –in_file LiAlPS.in –pos_file LiAlPS.pos –cel_file LiAlPS.cel –element Li Na
python compute_vaf.py –bomd-trj traj.trj –bomd-elements Li O Ti –element Li
python compute_vaf.py –data-dir ./ –element Li</p>
</dd>
</dl>
<p>Author: CPDyAna Development Team
Version: 2025-07-09</p>
<dl class="py function">
<dt class="sig sig-object py" id="target.compute_vaf.build_bomd_trajectory">
<span class="sig-prename descclassname"><span class="pre">target.compute_vaf.</span></span><span class="sig-name descname"><span class="pre">build_bomd_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trj_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_vaf.html#build_bomd_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_vaf.build_bomd_trajectory" title="Link to this definition"></a></dt>
<dd><p>Build a trajectory as a list of ASE Atoms objects with velocities from BOMD .trj file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trj_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to BOMD .trj trajectory file.</p></li>
<li><p><strong>elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of element symbols (order must match .trj).</p></li>
<li><p><strong>num_frames</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of frames to use (0=all).</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Stride for frames.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(frames, dt)</dt><dd><p>frames: list of ASE Atoms objects with velocities.
dt: time step in ps (average).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.compute_vaf.build_trajectory">
<span class="sig-prename descclassname"><span class="pre">target.compute_vaf.</span></span><span class="sig-name descname"><span class="pre">build_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cel_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evp_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nframes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.00193511</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_vaf.html#build_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_vaf.build_trajectory" title="Link to this definition"></a></dt>
<dd><p>Build a trajectory as a list of ASE Atoms objects with velocities from QE files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .in file (species).</p></li>
<li><p><strong>pos_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .pos file (positions).</p></li>
<li><p><strong>cel_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .cel file (cell parameters).</p></li>
<li><p><strong>evp_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Path to .evp file (timing).</p></li>
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Start time in ps.</p></li>
<li><p><strong>nframes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of frames to use (0=all).</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Stride for frames.</p></li>
<li><p><strong>time_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Default time between frames (ps) if no .evp.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(frames, dt)</dt><dd><p>frames: list of ASE Atoms objects with velocities.
dt: time step in ps.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.compute_vaf.compute_vaf">
<span class="sig-prename descclassname"><span class="pre">target.compute_vaf.</span></span><span class="sig-name descname"><span class="pre">compute_vaf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blocks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_start_fit_ps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize_t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize_tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_end_fit_ps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_vaf.html#compute_vaf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_vaf.compute_vaf" title="Link to this definition"></a></dt>
<dd><p>Compute the velocity autocorrelation function (VAF) for a given element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frames</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of ASE Atoms objects with velocities.</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time step in ps.</p></li>
<li><p><strong>element</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Element symbol (e.g. ‘Li’).</p></li>
<li><p><strong>blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of statistical blocks.</p></li>
<li><p><strong>out_prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Output file prefix.</p></li>
<li><p><strong>in_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .in file (for species).</p></li>
<li><p><strong>t_start_fit_ps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Start index for VAF calculation.</p></li>
<li><p><strong>stepsize_t</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Stride for t in VAF.</p></li>
<li><p><strong>stepsize_tau</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Stride for tau in VAF.</p></li>
<li><p><strong>t_end_fit_ps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – End of fit in ps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(t, vaf, vint)</dt><dd><p>t: time array (ps)
vaf: VAF array
vint: VAF integral array</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.compute_vaf.convert_symbols_to_atomic_numbers">
<span class="sig-prename descclassname"><span class="pre">target.compute_vaf.</span></span><span class="sig-name descname"><span class="pre">convert_symbols_to_atomic_numbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_vaf.html#convert_symbols_to_atomic_numbers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_vaf.convert_symbols_to_atomic_numbers" title="Link to this definition"></a></dt>
<dd><p>Convert a list of element symbols to atomic numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>symbols</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of element symbols (str).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of atomic numbers (int).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.compute_vaf.finite_diff_velocities">
<span class="sig-prename descclassname"><span class="pre">target.compute_vaf.</span></span><span class="sig-name descname"><span class="pre">finite_diff_velocities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_vaf.html#finite_diff_velocities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_vaf.finite_diff_velocities" title="Link to this definition"></a></dt>
<dd><p>Compute velocities using finite differences from positions and times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_arr</strong> (<em>np.ndarray</em>) – Array of shape (Nframes, natoms, 3) with positions.</p></li>
<li><p><strong>times</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of time values (ps), length Nframes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of velocities, same shape as pos_arr.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="vdos-analysis">
<h2>VDOS Analysis<a class="headerlink" href="#vdos-analysis" title="Link to this heading"></a></h2>
<p>Vibrational Density of States calculations.</p>
</section>
<section id="plotting-and-visualization">
<h2>Plotting and Visualization<a class="headerlink" href="#plotting-and-visualization" title="Link to this heading"></a></h2>
<p>Plotting utilities for analysis results.</p>
<section id="plotting-and-visualization-module-for-cpdyana">
<span id="module-target.plotting"></span><h3>Plotting and Visualization Module for CPDyAna<a class="headerlink" href="#plotting-and-visualization-module-for-cpdyana" title="Link to this heading"></a></h3>
<p>This module provides comprehensive plotting functions for visualizing molecular
dynamics analysis results using Seaborn’s enhanced styling capabilities.</p>
<p>Key Features:
- Publication-quality figures with consistent styling
- Enhanced color palettes and visual aesthetics
- Statistical visualization of uncertainty
- Responsive layouts and multi-panel figures
- Accessible and customizable plot elements</p>
<p>Author: CPDyAna Development Team
Version: 01-02-2024</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="target.plotting.centers_to_edges">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">centers_to_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#centers_to_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.centers_to_edges" title="Link to this definition"></a></dt>
<dd><p>Convert bin centers to bin edges for general plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>centers</strong> (<em>np.ndarray</em>) – Array of bin centers.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of bin edges.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.plotting.centers_to_edges_time">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">centers_to_edges_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#centers_to_edges_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.centers_to_edges_time" title="Link to this definition"></a></dt>
<dd><p>Convert bin centers to bin edges for time axis plotting,
ensuring the first edge is always at 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>centers</strong> (<em>np.ndarray</em>) – Array of bin centers.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of bin edges.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.plotting.int_or_float">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">int_or_float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#int_or_float"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.int_or_float" title="Link to this definition"></a></dt>
<dd><p>Convert string to int if possible, else float.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Value to convert.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Converted value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.plotting.main">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.main" title="Link to this definition"></a></dt>
<dd><p>Main function for command-line plotting interface.</p>
<p>Parses CLI arguments and dispatches to the appropriate plotting function.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.plotting.msd_plot">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">msd_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Plot_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">First_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Last_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_lammps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#msd_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.msd_plot" title="Link to this definition"></a></dt>
<dd><p>Dispatcher function for MSD plotting based on data source.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to JSON file with MSD data.</p></li>
<li><p><strong>Plot_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of plot specifications.</p></li>
<li><p><strong>First_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Start time for plotting window (ps).</p></li>
<li><p><strong>Last_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – End time for plotting window (ps).</p></li>
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – File path to save the plot.</p></li>
<li><p><strong>is_lammps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, use LAMMPS plotting; else QE.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.plotting.msd_plot_lammps">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">msd_plot_lammps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Plot_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">First_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Last_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#msd_plot_lammps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.msd_plot_lammps" title="Link to this definition"></a></dt>
<dd><p>Create enhanced MSD plots from LAMMPS data using Seaborn styling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to JSON file with MSD data.</p></li>
<li><p><strong>Plot_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of plot specifications (TEMP, ELEMENT, DATA_TYPE, DIRECTION).</p></li>
<li><p><strong>First_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Start time for plotting window (ps).</p></li>
<li><p><strong>Last_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – End time for plotting window (ps).</p></li>
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – File path to save the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None. Displays and optionally saves the plot.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.plotting.msd_plot_qe">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">msd_plot_qe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Plot_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">First_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Last_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#msd_plot_qe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.msd_plot_qe" title="Link to this definition"></a></dt>
<dd><p>Create enhanced MSD plots from QE data using Seaborn styling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to JSON file with MSD data.</p></li>
<li><p><strong>Plot_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of plot specifications (TEMP, ELEMENT, DATA_TYPE, DIRECTION).</p></li>
<li><p><strong>First_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Start time for plotting window (ps).</p></li>
<li><p><strong>Last_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – End time for plotting window (ps).</p></li>
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – File path to save the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None. Displays and optionally saves the plot.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.plotting.ngp_plot">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">ngp_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NGP.jpg'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#ngp_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.ngp_plot" title="Link to this definition"></a></dt>
<dd><p>Generate enhanced Non-Gaussian Parameter (NGP) plots using Seaborn styling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_source</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – Path to JSON file or loaded data dict.</p></li>
<li><p><strong>plot_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of plot specifications (TEMP, ELEMENT, DIRECTION).</p></li>
<li><p><strong>first_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Start time for plotting window (ps).</p></li>
<li><p><strong>last_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – End time for plotting window (ps).</p></li>
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – File path to save the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None. Displays and optionally saves the plot.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.plotting.parse_cli_args">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">parse_cli_args</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#parse_cli_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.parse_cli_args" title="Link to this definition"></a></dt>
<dd><p>Parse command-line arguments for plotting utilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Parsed arguments for plotting.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/argparse.html#argparse.Namespace" title="(in Python v3.13)">argparse.Namespace</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.plotting.plot_angular_spec">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_angular_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hide_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hide_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#plot_angular_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.plot_angular_spec" title="Link to this definition"></a></dt>
<dd><p>Plot angular spectra for atom triplets with enhanced Seaborn styling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_obj</strong> – Angular spectrum analysis object.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="(in Matplotlib v3.10.3)"><em>matplotlib.axes.Axes</em></a><em>, </em><em>optional</em>) – Axis to plot on.</p></li>
<li><p><strong>hide_legend</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, do not display legend.</p></li>
<li><p><strong>display</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, show the plot.</p></li>
<li><p><strong>hide_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, do not display labels.</p></li>
<li><p><strong>**options</strong> – Additional matplotlib options.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.plotting.plot_power_spectrum">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_power_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#plot_power_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.plot_power_spectrum" title="Link to this definition"></a></dt>
<dd><p>Plot power spectrum with enhanced Seaborn styling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_obj</strong> – DynamicsAnalyzer or similar object with spectrum data.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="(in Matplotlib v3.10.3)"><em>matplotlib.axes.Axes</em></a><em>, </em><em>optional</em>) – Axis to plot on.</p></li>
<li><p><strong>display</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, show the plot.</p></li>
<li><p><strong>signal_alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Opacity for individual signals.</p></li>
<li><p><strong>fill_alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Opacity for error fill.</p></li>
<li><p><strong>**options</strong> – Additional matplotlib options.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.plotting.plot_rdf">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_rdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secondary_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hide_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_pairs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hide_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_integral</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdf_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#plot_rdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.plot_rdf" title="Link to this definition"></a></dt>
<dd><p>Plot radial distribution functions (RDF) with enhanced Seaborn styling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_obj</strong> – RDF analysis object with RDF data.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="(in Matplotlib v3.10.3)"><em>matplotlib.axes.Axes</em></a><em>, </em><em>optional</em>) – Axis to plot on.</p></li>
<li><p><strong>secondary_axis</strong> (<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="(in Matplotlib v3.10.3)"><em>matplotlib.axes.Axes</em></a><em>, </em><em>optional</em>) – Axis for integral.</p></li>
<li><p><strong>hide_legend</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, do not display legend.</p></li>
<li><p><strong>target_pairs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em>) – List of atom pairs to plot.</p></li>
<li><p><strong>display</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, show the plot.</p></li>
<li><p><strong>hide_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, do not display labels.</p></li>
<li><p><strong>fill_alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Opacity for error fill.</p></li>
<li><p><strong>skip_integral</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, do not plot integral.</p></li>
<li><p><strong>rdf_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – Additional plotting options for RDF.</p></li>
<li><p><strong>int_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – Additional plotting options for integral.</p></li>
<li><p><strong>**options</strong> – Additional matplotlib options.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of line handles for the plotted curves.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.plotting.plot_vaf_isotropic">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_vaf_isotropic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hide_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_species</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#plot_vaf_isotropic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.plot_vaf_isotropic" title="Link to this definition"></a></dt>
<dd><p>Plot isotropic velocity autocorrelation function (VAF) with enhanced Seaborn styling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_obj</strong> – DynamicsAnalyzer or similar object with VAF data.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="(in Matplotlib v3.10.3)"><em>matplotlib.axes.Axes</em></a><em>, </em><em>optional</em>) – Axis to plot on.</p></li>
<li><p><strong>hide_legend</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, do not display legend.</p></li>
<li><p><strong>target_species</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em>) – List of species to plot.</p></li>
<li><p><strong>display</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, show the plot.</p></li>
<li><p><strong>**options</strong> – Additional matplotlib options.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.plotting.van_hove_plot">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">van_hove_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Plot_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">8)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#van_hove_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.van_hove_plot" title="Link to this definition"></a></dt>
<dd><p>Create enhanced Van Hove correlation function plots using Seaborn styling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to JSON file with Van Hove data.</p></li>
<li><p><strong>Plot_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of plot specifications (TEMP, ELEMENT, TYPE).</p></li>
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Base file path for saving plots.</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – Figure size in inches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None. Displays and optionally saves the plot.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="probability-density-analysis">
<h2>Probability Density Analysis<a class="headerlink" href="#probability-density-analysis" title="Link to this heading"></a></h2>
<p>3D ionic density mapping and spatial analysis.</p>
<section id="probability-density-calculation-module-for-cpdyana">
<span id="module-target.probability_density"></span><h3>Probability Density Calculation Module for CPDyAna<a class="headerlink" href="#probability-density-calculation-module-for-cpdyana" title="Link to this heading"></a></h3>
<p>This module provides functions to compute the 3D probability density of ions
from molecular dynamics trajectories. It supports Quantum ESPRESSO (.in/.pos/.cel),
LAMMPS (.lammpstrj), and BOMD (.trj) trajectory formats as parsed by CPDyAna’s input_reader.</p>
<p>Features:
- Gaussian density estimation for selected elements
- Atom masking, recentering, and custom bounding box support
- Compatible with QE, LAMMPS, and BOMD workflows</p>
<dl class="simple">
<dt>Usage (CLI):</dt><dd><p>python probability_density.py –in-file LiAlPS.in –pos-file LiAlPS.pos –cel-file LiAlPS.cel –element Li
python probability_density.py –lammps-file traj.lammpstrj –element Li
python probability_density.py –bomd-trj traj.trj –bomd-elements Li O Ti –element Li</p>
</dd>
</dl>
<p>Author: CPDyAna Development Team
Version: 2025-07-09</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="target.probability_density.build_bomd_trajectory">
<span class="sig-prename descclassname"><span class="pre">target.probability_density.</span></span><span class="sig-name descname"><span class="pre">build_bomd_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trj_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/probability_density.html#build_bomd_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.probability_density.build_bomd_trajectory" title="Link to this definition"></a></dt>
<dd><p>Build a trajectory from a BOMD .trj file using CPDyAna’s input_reader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trj_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to BOMD .trj trajectory file.</p></li>
<li><p><strong>elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of element symbols (order must match .trj).</p></li>
<li><p><strong>num_frames</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of frames to extract (0 for all).</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Stride for frame extraction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of ASE Atoms objects.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.probability_density.build_lammps_trajectory">
<span class="sig-prename descclassname"><span class="pre">target.probability_density.</span></span><span class="sig-name descname"><span class="pre">build_lammps_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lammps_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/probability_density.html#build_lammps_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.probability_density.build_lammps_trajectory" title="Link to this definition"></a></dt>
<dd><p>Build a trajectory from a LAMMPS .lammpstrj file using ASE.
Returns a list of ASE Atoms objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lammps_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to LAMMPS trajectory file.</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Stride for frame extraction.</p></li>
<li><p><strong>max_frames</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Maximum number of frames to extract.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of ASE Atoms objects.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.probability_density.build_trajectory">
<span class="sig-prename descclassname"><span class="pre">target.probability_density.</span></span><span class="sig-name descname"><span class="pre">build_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cel_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_after_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.00193511</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/probability_density.html#build_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.probability_density.build_trajectory" title="Link to this definition"></a></dt>
<dd><p>Build an in-memory trajectory from .in, .pos, .cel files (Quantum ESPRESSO).
Returns a list of ASE Atoms objects.
Supports frame stride for subsampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .in file (species).</p></li>
<li><p><strong>pos_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .pos file (positions).</p></li>
<li><p><strong>cel_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .cel file (cell).</p></li>
<li><p><strong>time_after_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time (ps) after which to start.</p></li>
<li><p><strong>num_frames</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of frames to extract (None or 0 for all).</p></li>
<li><p><strong>time_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time between frames (ps).</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Stride for frame extraction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of ASE Atoms objects.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.probability_density.calculate_probability_density">
<span class="sig-prename descclassname"><span class="pre">target.probability_density.</span></span><span class="sig-name descname"><span class="pre">calculate_probability_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Li'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recenter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/probability_density.html#calculate_probability_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.probability_density.calculate_probability_density" title="Link to this definition"></a></dt>
<dd><p>Calculate the Gaussian probability density for a given element in the trajectory.
Supports atom masking, recentering, and custom bounding box.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of ASE Atoms objects.</p></li>
<li><p><strong>element</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Element symbol to compute density for.</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Gaussian width (Å).</p></li>
<li><p><strong>n_sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Cutoff in sigma units.</p></li>
<li><p><strong>density</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Grid density (points/Å).</p></li>
<li><p><strong>outputfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Output file name.</p></li>
<li><p><strong>mask</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Atom indices to include.</p></li>
<li><p><strong>recenter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to recenter trajectory.</p></li>
<li><p><strong>bbox</strong> (<em>np.ndarray</em>) – Bounding box for grid.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None. Writes density to file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.probability_density.convert_symbols_to_atomic_numbers">
<span class="sig-prename descclassname"><span class="pre">target.probability_density.</span></span><span class="sig-name descname"><span class="pre">convert_symbols_to_atomic_numbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element_symbols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/probability_density.html#convert_symbols_to_atomic_numbers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.probability_density.convert_symbols_to_atomic_numbers" title="Link to this definition"></a></dt>
<dd><p>Convert element symbols to atomic numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>element_symbols</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of element symbols (str).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of atomic numbers (int).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.probability_density.divide_chunks">
<span class="sig-prename descclassname"><span class="pre">target.probability_density.</span></span><span class="sig-name descname"><span class="pre">divide_chunks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/probability_density.html#divide_chunks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.probability_density.divide_chunks" title="Link to this definition"></a></dt>
<dd><p>Yield successive n-sized chunks from l.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.probability_density.main">
<span class="sig-prename descclassname"><span class="pre">target.probability_density.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/probability_density.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.probability_density.main" title="Link to this definition"></a></dt>
<dd><p>Command-line interface for probability density calculation.</p>
<p>Supports QE, LAMMPS, and BOMD input modes. Builds trajectory and computes
the probability density for the specified element.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.probability_density.parse_mask">
<span class="sig-prename descclassname"><span class="pre">target.probability_density.</span></span><span class="sig-name descname"><span class="pre">parse_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_atoms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/probability_density.html#parse_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.probability_density.parse_mask" title="Link to this definition"></a></dt>
<dd><p>Parse a mask string like ‘0,1,2,5-10’ into a list of atom indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask_str</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Mask string.</p></li>
<li><p><strong>total_atoms</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Total number of atoms.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of atom indices.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="trajectory-utilities">
<h2>Trajectory Utilities<a class="headerlink" href="#trajectory-utilities" title="Link to this heading"></a></h2>
<p>Trajectory object and helpers.</p>
<dl class="py exception" id="module-target.trajectory">
<dt class="sig sig-object py" id="target.trajectory.IncompatibleTrajectoriesException">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">target.trajectory.</span></span><span class="sig-name descname"><span class="pre">IncompatibleTrajectoriesException</span></span><a class="reference internal" href="_modules/target/trajectory.html#IncompatibleTrajectoriesException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.IncompatibleTrajectoriesException" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
<p>Exception raised when attempting to combine incompatible trajectories.</p>
<p>This exception indicates that trajectories cannot be combined due to
differences in atom types, array structure, or timestep values.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="target.trajectory.Trajectory">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">target.trajectory.</span></span><span class="sig-name descname"><span class="pre">Trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#target.utilities.AttributedArray" title="target.utilities.AttributedArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttributedArray</span></code></a></p>
<p>Molecular dynamics trajectory representation with analytical capabilities.</p>
<p>The Trajectory class provides a comprehensive container for time-ordered
phase space data from molecular dynamics simulations. It manages positions,
velocities, forces, and structural information with consistent unit handling.</p>
<dl class="simple">
<dt>Internal units:</dt><dd><ul class="simple">
<li><p>Time: Femtoseconds</p></li>
<li><p>Distance: Angstroms</p></li>
<li><p>Energy: eV</p></li>
<li><p>Cell/Mass: As defined in the ASE Atoms object</p></li>
</ul>
</dd>
</dl>
<p>The class provides methods for trajectory manipulation, analysis, and
conversion to/from ASE Atoms objects. It handles periodic boundary
conditions and species-specific operations.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.atoms">
<span class="sig-name descname"><span class="pre">atoms</span></span><a class="headerlink" href="#target.trajectory.Trajectory.atoms" title="Link to this definition"></a></dt>
<dd><p>ASE Atoms object representing the system structure</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.types">
<span class="sig-name descname"><span class="pre">types</span></span><a class="headerlink" href="#target.trajectory.Trajectory.types" title="Link to this definition"></a></dt>
<dd><p>Chemical symbols of all atoms</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.nat">
<span class="sig-name descname"><span class="pre">nat</span></span><a class="headerlink" href="#target.trajectory.Trajectory.nat" title="Link to this definition"></a></dt>
<dd><p>Number of atoms in the system</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.cell">
<span class="sig-name descname"><span class="pre">cell</span></span><a class="headerlink" href="#target.trajectory.Trajectory.cell" title="Link to this definition"></a></dt>
<dd><p>Unit cell vectors</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.nstep">
<span class="sig-name descname"><span class="pre">nstep</span></span><a class="headerlink" href="#target.trajectory.Trajectory.nstep" title="Link to this definition"></a></dt>
<dd><p>Number of time steps in the trajectory</p>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a trajectory from a list of ASE Atoms objects</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="o">.</span><span class="n">from_atoms</span><span class="p">(</span><span class="n">atoms_list</span><span class="p">,</span> <span class="n">timestep_fs</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Access positions for all atoms at all timesteps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">positions</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get indices of specific elements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">li_indices</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">get_indices_of_species</span><span class="p">(</span><span class="s1">&#39;Li&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Export a specific timestep as an ASE Atoms object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms_t100</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">get_step_atoms</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.__init__" title="Link to this definition"></a></dt>
<dd><p>Instantiating a trajectory class.
Optional keyword-arguments are everything with a set-method.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atoms</span></span><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.calculate_velocities_from_positions">
<span class="sig-name descname"><span class="pre">calculate_velocities_from_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.calculate_velocities_from_positions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.calculate_velocities_from_positions" title="Link to this definition"></a></dt>
<dd><p>Calculate atomic velocities from position differences between frames.</p>
<p>This method uses finite difference approximation to derive velocities
from position data, using the velocity Verlet update formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>overwrite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to replace existing velocity data
Defaults to False (raise exception if velocities exist)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Calculated velocities array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)">numpy.ndarray</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><strong>Exception</strong></a> – If velocities already exist and overwrite=False</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The first and last frames use forward and backward differences,
while intermediate frames use central differences for better accuracy.</p>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate velocities from positions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">velocities</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">calculate_velocities_from_positions</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average velocity magnitude: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">velocities</span><span class="p">,</span><span class="w"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> Å/fs&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id1">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cell</span></span><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.from_atoms">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep_fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.from_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.from_atoms" title="Link to this definition"></a></dt>
<dd><p>Create a Trajectory from a list of ASE Atoms objects.</p>
<p>This is the primary constructor for creating trajectory objects from
existing atomic structure snapshots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of ASE Atoms objects representing trajectory frames</p></li>
<li><p><strong>timestep_fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Time step between frames in femtoseconds</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New trajectory instance containing data from atoms_list</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#target.trajectory.Trajectory" title="target.trajectory.Trajectory">Trajectory</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If atoms_list items are not ASE Atoms objects</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If atoms_list is empty or has inconsistent chemical symbols</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create trajectory from a series of Atoms objects</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ase.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">read</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms_list</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="s1">&#39;simulation.xyz&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="o">.</span><span class="n">from_atoms</span><span class="p">(</span><span class="n">atoms_list</span><span class="p">,</span> <span class="n">timestep_fs</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created trajectory with </span><span class="si">{</span><span class="n">traj</span><span class="o">.</span><span class="n">nstep</span><span class="si">}</span><span class="s2"> frames and </span><span class="si">{</span><span class="n">traj</span><span class="o">.</span><span class="n">nat</span><span class="si">}</span><span class="s2"> atoms&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.get_ase_trajectory">
<span class="sig-name descname"><span class="pre">get_ase_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.get_ase_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.get_ase_trajectory" title="Link to this definition"></a></dt>
<dd><p>Convert a portion of the trajectory to a list of ASE Atoms objects.</p>
<p>This method extracts multiple frames as ASE Atoms objects, with options
for selecting a range and stride.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – First frame index to extract (default: 0)</p></li>
<li><p><strong>end</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Last frame index to extract (exclusive)
If None, uses the full trajectory length</p></li>
<li><p><strong>stepsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Frame stride for extraction (default: 1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of ASE Atoms objects for the requested frames</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If end exceeds trajectory length or no frames match criteria</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.13)"><strong>AssertionError</strong></a> – If parameters are not valid integers</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get the first 10 frames</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms_list</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">get_ase_trajectory</span><span class="p">(</span><span class="n">end</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get every 10th frame of the entire trajectory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms_list</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">get_ase_trajectory</span><span class="p">(</span><span class="n">stepsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get frames 100-200 with stride 5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms_list</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">get_ase_trajectory</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extracted </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> frames&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.get_atom_types">
<span class="sig-name descname"><span class="pre">get_atom_types</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.get_atom_types"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.get_atom_types" title="Link to this definition"></a></dt>
<dd><p>Return the LAMMPS atom types if available.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.get_atoms">
<span class="sig-name descname"><span class="pre">get_atoms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.get_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.get_atoms" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.get_cells">
<span class="sig-name descname"><span class="pre">get_cells</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.get_cells"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.get_cells" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.get_forces">
<span class="sig-name descname"><span class="pre">get_forces</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.get_forces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.get_forces" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.get_indices_of_species">
<span class="sig-name descname"><span class="pre">get_indices_of_species</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.get_indices_of_species"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.get_indices_of_species" title="Link to this definition"></a></dt>
<dd><p>Get array indices for atoms of a specific element type.</p>
<p>This convenience function identifies all atoms of a specified element
and returns their indices, with optional index offset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Element symbol (e.g., ‘Li’) or specific atom index</p></li>
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Starting index offset, defaults to 0 (Python indexing)
Use start=1 for FORTRAN-style indexing</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of atom indices matching the specified species</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)">numpy.ndarray</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If species is neither a string nor an integer</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Find all lithium atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">li_indices</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">get_indices_of_species</span><span class="p">(</span><span class="s1">&#39;Li&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">li_indices</span><span class="p">)</span><span class="si">}</span><span class="s2"> Li atoms at indices </span><span class="si">{</span><span class="n">li_indices</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get FORTRAN-style indices (1-based) for oxygen atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_indices</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">get_indices_of_species</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.get_positions">
<span class="sig-name descname"><span class="pre">get_positions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.get_positions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.get_positions" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.get_step_atoms">
<span class="sig-name descname"><span class="pre">get_step_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_calculated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.get_step_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.get_step_atoms" title="Link to this definition"></a></dt>
<dd><p>Extract a single timestep as an ASE Atoms object.</p>
<p>This method creates an ASE Atoms object for a specific trajectory frame,
optionally including calculated properties like forces and energies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Trajectory frame index to extract</p></li>
<li><p><strong>ignore_calculated</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, don’t include calculated properties
like forces, energies, and stress</p></li>
<li><p><strong>warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to show warnings for unavailable data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Atoms object representing the system at the specified timestep</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/atoms.html#ase.Atoms" title="(in ASE)">ase.Atoms</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.13)"><strong>AssertionError</strong></a> – If index is not an integer</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Extract frame 50 with all calculated properties</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms_50</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">get_step_atoms</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Extract frame 100 without calculated properties</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms_100</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">get_step_atoms</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">ignore_calculated</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Access properties of the extracted frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">positions</span> <span class="o">=</span> <span class="n">atoms_50</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">forces</span> <span class="o">=</span> <span class="n">atoms_50</span><span class="o">.</span><span class="n">get_forces</span><span class="p">()</span>  <span class="c1"># If available</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.get_stress">
<span class="sig-name descname"><span class="pre">get_stress</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.get_stress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.get_stress" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.get_timestep">
<span class="sig-name descname"><span class="pre">get_timestep</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.get_timestep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.get_timestep" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.get_types">
<span class="sig-name descname"><span class="pre">get_types</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.get_types"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.get_types" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.get_velocities">
<span class="sig-name descname"><span class="pre">get_velocities</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.get_velocities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.get_velocities" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.get_volumes">
<span class="sig-name descname"><span class="pre">get_volumes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.get_volumes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.get_volumes" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id2">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nat</span></span><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.recenter">
<span class="sig-name descname"><span class="pre">recenter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.recenter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.recenter" title="Link to this definition"></a></dt>
<dd><p>Recenter the trajectory to remove system drift or center on specific atoms.</p>
<p>This method modifies positions and velocities in-place to recenter the system.
Useful for removing center-of-mass drift or for centering on a specific
sublattice (e.g., a rigid framework or specific element).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em>) – Element names or indices defining a sublattice
to center on. If None, centers on the entire system.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Centering mode:
- None: Center using atomic masses (default)
- ‘geometric’: Use geometric center (equal weights)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If sublattice is not a list, tuple or set</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#IndexError" title="(in Python v3.13)"><strong>IndexError</strong></a> – If sublattice contains invalid atom indices</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If sublattice contains items of invalid type</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Center on the entire system (remove drift)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">recenter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Center on the Al-O framework</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">recenter</span><span class="p">(</span><span class="n">sublattice</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Al&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Center geometrically on Li atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">recenter</span><span class="p">(</span><span class="n">sublattice</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Li&#39;</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;geometric&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.set_atom_types">
<span class="sig-name descname"><span class="pre">set_atom_types</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_types</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.set_atom_types"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.set_atom_types" title="Link to this definition"></a></dt>
<dd><p>Set the LAMMPS atom types.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.set_atoms">
<span class="sig-name descname"><span class="pre">set_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.set_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.set_atoms" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.set_cells">
<span class="sig-name descname"><span class="pre">set_cells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_existing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.set_cells"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.set_cells" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.set_forces">
<span class="sig-name descname"><span class="pre">set_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_existing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.set_forces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.set_forces" title="Link to this definition"></a></dt>
<dd><p>Set the forces of the trajectory.
:param array:</p>
<blockquote>
<div><p>A numpy array with the forces in absolute
values in units of eV/angstrom</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>check_exising</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Check if the forces have been set, and raise in
such case. Defaults to False.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.set_positions">
<span class="sig-name descname"><span class="pre">set_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_existing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.set_positions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.set_positions" title="Link to this definition"></a></dt>
<dd><p>Set atomic positions for the entire trajectory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – Positions array with shape (nsteps, natoms, 3)
Values should be in Angstroms</p></li>
<li><p><strong>check_existing</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, raise error if positions already exist
Defaults to False (overwrite existing positions)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If array shape doesn’t match trajectory dimensions</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If check_existing=True and positions already exist</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set positions from a numpy array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 steps, 50 atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">set_positions</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.set_pot_energies">
<span class="sig-name descname"><span class="pre">set_pot_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_existing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.set_pot_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.set_pot_energies" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.set_stress">
<span class="sig-name descname"><span class="pre">set_stress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'voigt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_existing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.set_stress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.set_stress" title="Link to this definition"></a></dt>
<dd><p>order voigt expects keys (‘xx’, ‘yy’, ‘zz’, ‘yz’, ‘xz’, ‘xy’)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.set_timestep">
<span class="sig-name descname"><span class="pre">set_timestep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestep_fs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.set_timestep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.set_timestep" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>timestep</strong> – expects value of the timestep in femtoseconds</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.set_types">
<span class="sig-name descname"><span class="pre">set_types</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">types</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.set_types"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.set_types" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.trajectory.Trajectory.set_velocities">
<span class="sig-name descname"><span class="pre">set_velocities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_existing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#Trajectory.set_velocities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.Trajectory.set_velocities" title="Link to this definition"></a></dt>
<dd><p>Set the velocites of the trajectory.
:param array:</p>
<blockquote>
<div><p>A numpy array with the velocites in absolute
values in units of angstrom/femtoseconds</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>check_exising</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Check if the velocities have been set, and
raise in such case. Defaults to False.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id3">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">types</span></span><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.trajectory.check_trajectory_compatibility">
<span class="sig-prename descclassname"><span class="pre">target.trajectory.</span></span><span class="sig-name descname"><span class="pre">check_trajectory_compatibility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/trajectory.html#check_trajectory_compatibility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.trajectory.check_trajectory_compatibility" title="Link to this definition"></a></dt>
<dd><p>Verify that multiple trajectories can be safely combined.</p>
<p>This function checks whether trajectories are compatible by confirming
they have the same atomic composition, array structure, and timestep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trajectories</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of Trajectory objects to check</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(types, timestep) containing the common atom types and timestep</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="#target.trajectory.IncompatibleTrajectoriesException" title="target.trajectory.IncompatibleTrajectoriesException"><strong>IncompatibleTrajectoriesException</strong></a> – If trajectories differ in atom types,
    array structure, or timestep</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If any element is not a Trajectory instance</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.13)"><strong>AssertionError</strong></a> – If empty list is provided</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">types</span><span class="p">,</span> <span class="n">dt</span> <span class="o">=</span> <span class="n">check_trajectory_compatibility</span><span class="p">([</span><span class="n">traj1</span><span class="p">,</span> <span class="n">traj2</span><span class="p">])</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Compatible trajectories with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">types</span><span class="p">)</span><span class="si">}</span><span class="s2"> atom types&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">except</span> <span class="n">IncompatibleTrajectoriesException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Incompatible trajectories: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="general-utilities">
<h2>General Utilities<a class="headerlink" href="#general-utilities" title="Link to this heading"></a></h2>
<p>General helper functions.</p>
<section id="utility-module-for-samos-package">
<span id="module-target.utilities"></span><h3>Utility Module for SAMOS Package<a class="headerlink" href="#utility-module-for-samos-package" title="Link to this heading"></a></h3>
<p>This module provides essential utility functions, classes, and constants
for the SAMOS (Statistical Analysis of MOlecular Simulations) package.
It includes:</p>
<ul class="simple">
<li><p>Base classes for array data handling with attribute storage</p></li>
<li><p>Unit conversion constants for molecular dynamics</p></li>
<li><p>Color mapping utilities for visualization</p></li>
<li><p>IO helpers and terminal display utilities</p></li>
</ul>
<p>The core <cite>AttributedArray</cite> class serves as a foundation for data storage
in SAMOS, providing a flexible container for numerical arrays with
associated metadata and serialization capabilities.</p>
<dl class="simple">
<dt>Constants:</dt><dd><p>kB: Boltzmann constant in J/K
kB_ev: Boltzmann constant in eV/K
kB_au: Boltzmann constant in atomic units
amu_kg: Atomic mass unit in kg
bohr_to_ang: Bohr radius to Angstrom conversion factor</p>
</dd>
<dt>Classes:</dt><dd><p>AttributedArray: Array container with metadata and serialization
InputError: Custom exception for input validation failures</p>
</dd>
<dt>Functions:</dt><dd><p>get_color: Get RGB colors for chemical elements
get_terminal_width: Get current terminal dimensions</p>
</dd>
</dl>
<p>Author: SAMOS Development Team
Version: 01-02-2024</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="target.utilities.AttributedArray">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">target.utilities.</span></span><span class="sig-name descname"><span class="pre">AttributedArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/utilities.html#AttributedArray"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.utilities.AttributedArray" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Flexible array container with attribute storage and serialization.</p>
<p>This class provides a foundation for storing numerical data arrays with
associated metadata in a serializable format. It forms the base class
for trajectory and analysis data structures in SAMOS.</p>
<p>The class supports:
- Named array storage with validation
- JSON-serializable attribute storage
- Array rescaling operations
- File-based serialization and loading</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="target.utilities.AttributedArray._arrays">
<span class="sig-name descname"><span class="pre">_arrays</span></span><a class="headerlink" href="#target.utilities.AttributedArray._arrays" title="Link to this definition"></a></dt>
<dd><p>Dictionary of stored arrays</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="target.utilities.AttributedArray._attrs">
<span class="sig-name descname"><span class="pre">_attrs</span></span><a class="headerlink" href="#target.utilities.AttributedArray._attrs" title="Link to this definition"></a></dt>
<dd><p>Dictionary of JSON-serializable attributes</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="target.utilities.AttributedArray._nstep">
<span class="sig-name descname"><span class="pre">_nstep</span></span><a class="headerlink" href="#target.utilities.AttributedArray._nstep" title="Link to this definition"></a></dt>
<dd><p>Number of steps in time-series data</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create container with initial attributes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">AttributedArray</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">timestep</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add arrays</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 steps, 50 atoms, 3D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="s1">&#39;positions&#39;</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">check_nstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add metadata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="s1">&#39;simulation_type&#39;</span><span class="p">,</span> <span class="s1">&#39;NVT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Save and load</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;simulation_data.tar.gz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loaded_data</span> <span class="o">=</span> <span class="n">AttributedArray</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s1">&#39;simulation_data.tar.gz&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="target.utilities.AttributedArray.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/utilities.html#AttributedArray.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.utilities.AttributedArray.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.utilities.AttributedArray.get_array">
<span class="sig-name descname"><span class="pre">get_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/utilities.html#AttributedArray.get_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.utilities.AttributedArray.get_array" title="Link to this definition"></a></dt>
<dd><p>Retrieve a stored array by name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the array to retrieve</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The requested array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)">numpy.ndarray</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.13)"><strong>KeyError</strong></a> – If no array with the given name exists</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get stored positions array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">positions</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_array</span><span class="p">(</span><span class="s1">&#39;positions&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Got positions with shape </span><span class="si">{</span><span class="n">positions</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Positions not found&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.utilities.AttributedArray.get_arraynames">
<span class="sig-name descname"><span class="pre">get_arraynames</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/utilities.html#AttributedArray.get_arraynames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.utilities.AttributedArray.get_arraynames" title="Link to this definition"></a></dt>
<dd><p>Get a sorted list of all stored array names.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Sorted list of array names</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># List all available arrays</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_names</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_arraynames</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Available arrays: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">array_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.utilities.AttributedArray.get_attr">
<span class="sig-name descname"><span class="pre">get_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/utilities.html#AttributedArray.get_attr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.utilities.AttributedArray.get_attr" title="Link to this definition"></a></dt>
<dd><p>Retrieve a stored attribute by key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the attribute to retrieve</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The stored attribute value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.13)"><strong>KeyError</strong></a> – If the attribute doesn’t exist</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Access stored temperature value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">temperature</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s1">&#39;temperature&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Temperature: </span><span class="si">{</span><span class="n">temperature</span><span class="si">}</span><span class="s2"> K&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Temperature not set&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.utilities.AttributedArray.get_attrs">
<span class="sig-name descname"><span class="pre">get_attrs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/utilities.html#AttributedArray.get_attrs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.utilities.AttributedArray.get_attrs" title="Link to this definition"></a></dt>
<dd><p>Get the complete dictionary of attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of all stored attributes</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get all metadata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metadata</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_attrs</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">metadata</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.utilities.AttributedArray.load_file">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/utilities.html#AttributedArray.load_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.utilities.AttributedArray.load_file" title="Link to this definition"></a></dt>
<dd><p>Load an AttributedArray instance from a saved file.</p>
<p>This class method recreates an AttributedArray instance from a file
previously created with the save() method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the saved file (.tar.gz)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new instance with loaded data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#target.utilities.AttributedArray" title="target.utilities.AttributedArray">AttributedArray</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><strong>Exception</strong></a> – If the file cannot be loaded or has invalid format</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load data from file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loaded_data</span> <span class="o">=</span> <span class="n">AttributedArray</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s1">&#39;simulation_results.tar.gz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">loaded_data</span><span class="o">.</span><span class="n">get_arraynames</span><span class="p">())</span><span class="si">}</span><span class="s2"> arrays&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="target.utilities.AttributedArray.nstep">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nstep</span></span><a class="headerlink" href="#target.utilities.AttributedArray.nstep" title="Link to this definition"></a></dt>
<dd><p>The number of trajectory steps
:raises: ValueError if no unique number of steps can be determined.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>returns</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.utilities.AttributedArray.remove_array">
<span class="sig-name descname"><span class="pre">remove_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrayname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/utilities.html#AttributedArray.remove_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.utilities.AttributedArray.remove_array" title="Link to this definition"></a></dt>
<dd><p>Remove a stored array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arrayname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the array to remove</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.13)"><strong>KeyError</strong></a> – If the array doesn’t exist</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Remove temporary array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">remove_array</span><span class="p">(</span><span class="s1">&#39;temp_calculations&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.utilities.AttributedArray.rescale_array">
<span class="sig-name descname"><span class="pre">rescale_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrayname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/utilities.html#AttributedArray.rescale_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.utilities.AttributedArray.rescale_array" title="Link to this definition"></a></dt>
<dd><p>Rescale a stored array by a constant factor.</p>
<p>This method multiplies all values in an array by a given factor,
useful for unit conversions or normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arrayname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the array to rescale</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Scaling factor</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.13)"><strong>KeyError</strong></a> – If the array doesn’t exist</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Convert velocities from Å/fs to Å/ps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">rescale_array</span><span class="p">(</span><span class="s1">&#39;velocities&#39;</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.utilities.AttributedArray.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/utilities.html#AttributedArray.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.utilities.AttributedArray.save" title="Link to this definition"></a></dt>
<dd><p>Save the AttributedArray instance to a compressed tar file.</p>
<p>This method serializes both the numerical arrays and attributes
to a single compressed file that can later be loaded with load_file().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Output filename (typically with .tar.gz extension)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Save data to file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;simulation_results.tar.gz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.utilities.AttributedArray.set_array">
<span class="sig-name descname"><span class="pre">set_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_existing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_nstep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_nat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wanted_shape_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wanted_shape_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wanted_shape_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/utilities.html#AttributedArray.set_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.utilities.AttributedArray.set_array" title="Link to this definition"></a></dt>
<dd><p>Set a named array with validation options.</p>
<p>This method stores a numpy array with a specified name and performs
optional validation on its shape and compatibility with existing arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name to reference the array</p></li>
<li><p><strong>array</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – Array data to store (or convertible to numpy array)</p></li>
<li><p><strong>check_existing</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, raise error if array name already exists</p></li>
<li><p><strong>check_nstep</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, validate first dimension matches other arrays</p></li>
<li><p><strong>check_nat</strong> (<em>bool/int</em>) – If True or int, validate second dimension matches nat</p></li>
<li><p><strong>wanted_shape_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Validate array has this number of dimensions</p></li>
<li><p><strong>wanted_shape_1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Validate array’s second dimension is this size</p></li>
<li><p><strong>wanted_shape_2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Validate array’s third dimension is this size</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If name is not a string or array has wrong dimensions</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If array name exists and check_existing=True</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If array shape doesn’t match existing arrays</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#IndexError" title="(in Python v3.13)"><strong>IndexError</strong></a> – If array dimensions don’t match wanted_shape parameters</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Store positions array with validation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 steps, 50 atoms, 3D positions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="s1">&#39;positions&#39;</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">check_nstep</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">check_nat</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">wanted_shape_len</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">wanted_shape_2</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.utilities.AttributedArray.set_attr">
<span class="sig-name descname"><span class="pre">set_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/utilities.html#AttributedArray.set_attr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.utilities.AttributedArray.set_attr" title="Link to this definition"></a></dt>
<dd><p>Set a JSON-serializable attribute.</p>
<p>This method stores metadata as key-value pairs. All values must be
JSON-serializable for compatibility with file storage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Attribute name</p></li>
<li><p><strong>value</strong> – Attribute value (must be JSON-serializable)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If the value cannot be serialized to JSON</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Store simulation parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="s1">&#39;ensemble&#39;</span><span class="p">,</span> <span class="s1">&#39;NVT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="s1">&#39;elements&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Li&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="target.utilities.InputError">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">target.utilities.</span></span><span class="sig-name descname"><span class="pre">InputError</span></span><a class="reference internal" href="_modules/target/utilities.html#InputError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.utilities.InputError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
<p>Exception raised when input validation fails.</p>
<p>This custom exception is used throughout SAMOS to indicate
that user-provided input doesn’t meet validation requirements.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.utilities.apply_minimum_image">
<span class="sig-prename descclassname"><span class="pre">target.utilities.</span></span><span class="sig-name descname"><span class="pre">apply_minimum_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">displacement</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/utilities.html#apply_minimum_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.utilities.apply_minimum_image" title="Link to this definition"></a></dt>
<dd><p>Apply the minimum image convention (MIC) to a displacement vector.
Parameters:
- displacement: np.ndarray of shape (…, 3), displacement vectors
- cell: np.ndarray of shape (3, 3), simulation cell vectors
Returns:
- np.ndarray of same shape as displacement with MIC applied</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.utilities.get_color">
<span class="sig-prename descclassname"><span class="pre">target.utilities.</span></span><span class="sig-name descname"><span class="pre">get_color</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chemical_symbol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jmol'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/utilities.html#get_color"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.utilities.get_color" title="Link to this definition"></a></dt>
<dd><p>Get RGB color tuple for a chemical element.</p>
<p>This function returns the standard color for an element based on
common visualization schemes like JMOL or CPK.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chemical_symbol</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Chemical symbol (e.g., ‘H’, ‘O’, ‘Fe’)</p></li>
<li><p><strong>scheme</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Color scheme to use:
- ‘jmol’: JMOL visualization colors (default)
- ‘cpk’: CPK color convention</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RGB color tuple with values from 0 to 1, or None if not found</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the scheme is not recognized</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get oxygen color in JMOL scheme</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_color</span> <span class="o">=</span> <span class="n">get_color</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RGB color for oxygen: </span><span class="si">{</span><span class="n">o_color</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get carbon color in CPK scheme</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_color</span> <span class="o">=</span> <span class="n">get_color</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;cpk&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.utilities.get_terminal_width">
<span class="sig-prename descclassname"><span class="pre">target.utilities.</span></span><span class="sig-name descname"><span class="pre">get_terminal_width</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/utilities.html#get_terminal_width"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.utilities.get_terminal_width" title="Link to this definition"></a></dt>
<dd><p>Get the current terminal width and height.</p>
<p>This function attempts to determine the dimensions of the current
terminal window using various methods, with fallbacks if detection fails.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(width, height) in characters</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get terminal width for formatting output</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">get_terminal_width</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Terminal is </span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2"> columns wide and </span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2"> rows tall&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="analysis-helpers">
<h2>Analysis Helpers<a class="headerlink" href="#analysis-helpers" title="Link to this heading"></a></h2>
<p>Additional analysis routines.</p>
<p id="module-target.analysis">Core Analysis Module for SAMOS</p>
<p>This module provides the main analysis classes and functions for the SAMOS
(Statistical Analysis of MOlecular Simulations) package.</p>
<dl class="field-list simple">
<dt class="field-odd">author<span class="colon">:</span></dt>
<dd class="field-odd"><p>SAMOS Development Team</p>
</dd>
<dt class="field-even">date<span class="colon">:</span></dt>
<dd class="field-even"><p>01-02-2024</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="target.analysis.BaseAnalyzer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">target.analysis.</span></span><span class="sig-name descname"><span class="pre">BaseAnalyzer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/analysis.html#BaseAnalyzer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.analysis.BaseAnalyzer" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Abstract base class for molecular dynamics analysis tools.</p>
<dl class="py method">
<dt class="sig sig-object py" id="target.analysis.BaseAnalyzer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/analysis.html#BaseAnalyzer.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.analysis.BaseAnalyzer.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.analysis.BaseAnalyzer.run">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/analysis.html#BaseAnalyzer.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.analysis.BaseAnalyzer.run" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.analysis.BaseAnalyzer.set_trajectory">
<span class="sig-name descname"><span class="pre">set_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/analysis.html#BaseAnalyzer.set_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.analysis.BaseAnalyzer.set_trajectory" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="target.analysis.DynamicsAnalyzer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">target.analysis.</span></span><span class="sig-name descname"><span class="pre">DynamicsAnalyzer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/analysis.html#DynamicsAnalyzer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.analysis.DynamicsAnalyzer" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Comprehensive analyzer for particle dynamics in molecular simulations.</p>
<dl class="py method">
<dt class="sig sig-object py" id="target.analysis.DynamicsAnalyzer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/analysis.html#DynamicsAnalyzer.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.analysis.DynamicsAnalyzer.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.analysis.DynamicsAnalyzer.get_kinetic_energies">
<span class="sig-name descname"><span class="pre">get_kinetic_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decompose_system</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decompose_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decompose_species</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/analysis.html#DynamicsAnalyzer.get_kinetic_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.analysis.DynamicsAnalyzer.get_kinetic_energies" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.analysis.DynamicsAnalyzer.get_power_spectrum">
<span class="sig-name descname"><span class="pre">get_power_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrayname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/analysis.html#DynamicsAnalyzer.get_power_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.analysis.DynamicsAnalyzer.get_power_spectrum" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.analysis.DynamicsAnalyzer.get_species_of_interest">
<span class="sig-name descname"><span class="pre">get_species_of_interest</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/analysis.html#DynamicsAnalyzer.get_species_of_interest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.analysis.DynamicsAnalyzer.get_species_of_interest" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.analysis.DynamicsAnalyzer.get_vaf">
<span class="sig-name descname"><span class="pre">get_vaf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrayname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'trapezoid'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/analysis.html#DynamicsAnalyzer.get_vaf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.analysis.DynamicsAnalyzer.get_vaf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.analysis.DynamicsAnalyzer.set_species_of_interest">
<span class="sig-name descname"><span class="pre">set_species_of_interest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species_of_interest</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/analysis.html#DynamicsAnalyzer.set_species_of_interest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.analysis.DynamicsAnalyzer.set_species_of_interest" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.analysis.DynamicsAnalyzer.set_trajectories">
<span class="sig-name descname"><span class="pre">set_trajectories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/analysis.html#DynamicsAnalyzer.set_trajectories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.analysis.DynamicsAnalyzer.set_trajectories" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="target.analysis.DynamicsAnalyzer.set_verbosity">
<span class="sig-name descname"><span class="pre">set_verbosity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbosity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/analysis.html#DynamicsAnalyzer.set_verbosity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.analysis.DynamicsAnalyzer.set_verbosity" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="target.analysis.TimeSeries">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">target.analysis.</span></span><span class="sig-name descname"><span class="pre">TimeSeries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/analysis.html#TimeSeries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.analysis.TimeSeries" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#target.utilities.AttributedArray" title="target.utilities.AttributedArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttributedArray</span></code></a></p>
<p>Time series analysis utilities.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.analysis.get_gaussian_density">
<span class="sig-prename descclassname"><span class="pre">target.analysis.</span></span><span class="sig-name descname"><span class="pre">get_gaussian_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'out.xsf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_exclude_from_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/analysis.html#get_gaussian_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.analysis.get_gaussian_density" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.analysis.write_xsf_header">
<span class="sig-prename descclassname"><span class="pre">target.analysis.</span></span><span class="sig-name descname"><span class="pre">write_xsf_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vals_per_line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfilename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/analysis.html#write_xsf_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.analysis.write_xsf_header" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="preprocessing">
<h2>Preprocessing<a class="headerlink" href="#preprocessing" title="Link to this heading"></a></h2>
<p>Preprocessing and filtering routines.</p>
</section>
<section id="utility-modules">
<h2>Utility Modules<a class="headerlink" href="#utility-modules" title="Link to this heading"></a></h2>
<section id="module-target.json_serializable">
<span id="json-serialization"></span><h3>JSON Serialization<a class="headerlink" href="#module-target.json_serializable" title="Link to this heading"></a></h3>
<section id="json-serialization-utilities-for-cpdyana">
<h4>JSON Serialization Utilities for CPDyAna<a class="headerlink" href="#json-serialization-utilities-for-cpdyana" title="Link to this heading"></a></h4>
<p>This module provides utility functions for converting complex Python data structures
(particularly those containing NumPy arrays) into JSON-serializable formats.</p>
<p>CPDyAna analysis functions often return nested dictionaries containing NumPy arrays,
which cannot be directly serialized to JSON. This module handles the conversion
by recursively traversing data structures and converting NumPy arrays to lists
while preserving the overall structure.</p>
<dl class="simple">
<dt>Functions:</dt><dd><p>convert_to_serializable: Main conversion function for nested data structures</p>
</dd>
</dl>
<p>Common use cases:
- Saving analysis results to JSON files for later processing
- Preparing data for web APIs or data exchange
- Creating human-readable output files</p>
<p>Author: CPDyAna Development Team
Version: 01-02-2024</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="target.json_serializable.convert_to_serializable">
<span class="sig-prename descclassname"><span class="pre">target.json_serializable.</span></span><span class="sig-name descname"><span class="pre">convert_to_serializable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/json_serializable.html#convert_to_serializable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.json_serializable.convert_to_serializable" title="Link to this definition"></a></dt>
<dd><p>Recursively convert data structures containing NumPy arrays to JSON-serializable format.</p>
<p>This function handles nested dictionaries, lists, and NumPy arrays by converting
them to native Python types that can be serialized to JSON. The function preserves
the structure of nested data while ensuring all elements are JSON-compatible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj</strong> – Input object to convert. Can be:
- dict: Nested dictionary (values will be recursively converted)
- list/tuple: List or tuple (elements will be recursively converted)
- np.ndarray: NumPy array (converted to list)
- np.number: NumPy scalar (converted to Python number)
- Other types: Returned unchanged if JSON-serializable</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>JSON-serializable object with the same structure as input but with
NumPy arrays converted to lists and NumPy scalars to Python numbers.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If object contains non-serializable types that cannot be converted.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;msd&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">800.0</span><span class="p">)},</span>
<span class="gp">... </span>    <span class="s1">&#39;elements&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Li&#39;</span><span class="p">,</span> <span class="s1">&#39;Na&#39;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">serializable</span> <span class="o">=</span> <span class="n">convert_to_serializable</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;results.json&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">serializable</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>NumPy arrays are converted to nested lists preserving dimensionality</p></li>
<li><p>NumPy scalars (np.float64, np.int32, etc.) become Python float/int</p></li>
<li><p>The function handles arbitrary nesting depth</p></li>
<li><p>Original data structure is not modified (deep copy behavior)</p></li>
</ul>
</div>
</dd></dl>

</section>
<section id="module-target.const">
<span id="constants"></span><h3>Constants<a class="headerlink" href="#module-target.const" title="Link to this heading"></a></h3>
<section id="physical-constants-and-unit-conversions-for-cpdyana">
<h4>Physical Constants and Unit Conversions for CPDyAna<a class="headerlink" href="#physical-constants-and-unit-conversions-for-cpdyana" title="Link to this heading"></a></h4>
<p>This module defines fundamental physical constants and unit conversion factors
used throughout the CPDyAna molecular dynamics analysis package.</p>
<p>Constants are organized by category:
- Length conversions (Bohr, Angstrom, meters)
- Time conversions (atomic units, picoseconds, seconds)
- Energy conversions (Hartree, eV, Joules)
- Diffusion coefficient conversions
- Physical constants (Boltzmann constant, electron charge, etc.)</p>
<p>All values are given in SI base units unless otherwise specified.</p>
<dl class="simple">
<dt>Usage:</dt><dd><p>from target.const import BOHR_TO_ANGSTROM, KB_BOLTZMANN</p>
</dd>
</dl>
<p>Author: CPDyAna Development Team
Version: 01-02-2024</p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="CPDyAna Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="usage_Examples.html" class="btn btn-neutral float-right" title="Usage Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Vinay Maithani.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>