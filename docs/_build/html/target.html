

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Target Package &mdash; CPDyAna 01-02-2024 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=18cd0f04"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="SAMOS Modules" href="samos_modules.html" />
    <link rel="prev" title="CPDyAna Documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            CPDyAna
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Target Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#main-analysis-driver">Main Analysis Driver</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cpdyana-combined-molecular-dynamics-analysis-tool">CPDyAna – Combined Molecular Dynamics Analysis Tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.CPDyAna.Job"><code class="docutils literal notranslate"><span class="pre">Job()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.CPDyAna.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.CPDyAna.parser"><code class="docutils literal notranslate"><span class="pre">parser()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#key-functions">Key Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#data-processing">Data Processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#target.data_processing.data_evaluator"><code class="docutils literal notranslate"><span class="pre">data_evaluator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.data_processing.find_terms"><code class="docutils literal notranslate"><span class="pre">find_terms()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.data_processing.segmenter_func"><code class="docutils literal notranslate"><span class="pre">segmenter_func()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Key Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#input-output-operations">Input/Output Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#target.input_reader.read_cel_file"><code class="docutils literal notranslate"><span class="pre">read_cel_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.input_reader.read_evp_file"><code class="docutils literal notranslate"><span class="pre">read_evp_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.input_reader.read_ion_file"><code class="docutils literal notranslate"><span class="pre">read_ion_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.input_reader.read_pos_file"><code class="docutils literal notranslate"><span class="pre">read_pos_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#supported-file-types">Supported File Types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#core-calculations">Core Calculations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#target.calculations.calc_fft"><code class="docutils literal notranslate"><span class="pre">calc_fft()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.calculations.calc_msd_tracer"><code class="docutils literal notranslate"><span class="pre">calc_msd_tracer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.calculations.calculate_msd"><code class="docutils literal notranslate"><span class="pre">calculate_msd()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.calculations.disp_sum"><code class="docutils literal notranslate"><span class="pre">disp_sum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.calculations.msd_charged"><code class="docutils literal notranslate"><span class="pre">msd_charged()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.calculations.msd_tracer"><code class="docutils literal notranslate"><span class="pre">msd_tracer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#analysis-types">Analysis Types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#correlation-analysis">Correlation Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#target.correrelation_analysis.Van_Hove_distinct"><code class="docutils literal notranslate"><span class="pre">Van_Hove_distinct()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.correrelation_analysis.Van_Hove_self"><code class="docutils literal notranslate"><span class="pre">Van_Hove_self()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#correlation-types">Correlation Types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#rdf-computation">RDF Computation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_rdf.build_ase_trajectory"><code class="docutils literal notranslate"><span class="pre">build_ase_trajectory()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_rdf.compute_rdf"><code class="docutils literal notranslate"><span class="pre">compute_rdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_rdf.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#vaf-computation">VAF Computation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_vaf.build_trajectory"><code class="docutils literal notranslate"><span class="pre">build_trajectory()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_vaf.compute_vaf"><code class="docutils literal notranslate"><span class="pre">compute_vaf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_vaf.convert_symbols_to_atomic_numbers"><code class="docutils literal notranslate"><span class="pre">convert_symbols_to_atomic_numbers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_vaf.finite_diff_velocities"><code class="docutils literal notranslate"><span class="pre">finite_diff_velocities()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_vaf.read_cel"><code class="docutils literal notranslate"><span class="pre">read_cel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_vaf.read_evp"><code class="docutils literal notranslate"><span class="pre">read_evp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.compute_vaf.read_pos"><code class="docutils literal notranslate"><span class="pre">read_pos()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#plotting-and-visualization">Plotting and Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.int_or_float"><code class="docutils literal notranslate"><span class="pre">int_or_float()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.msd_plot"><code class="docutils literal notranslate"><span class="pre">msd_plot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.parse_cli_args"><code class="docutils literal notranslate"><span class="pre">parse_cli_args()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.plotting.van_hove_plot"><code class="docutils literal notranslate"><span class="pre">van_hove_plot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#plot-types">Plot Types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#probability-density-analysis">Probability Density Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#target.probability_density.build_trajectory"><code class="docutils literal notranslate"><span class="pre">build_trajectory()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.probability_density.calculate_probability_density"><code class="docutils literal notranslate"><span class="pre">calculate_probability_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.probability_density.convert_symbols_to_atomic_numbers"><code class="docutils literal notranslate"><span class="pre">convert_symbols_to_atomic_numbers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.probability_density.divide_chunks"><code class="docutils literal notranslate"><span class="pre">divide_chunks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.probability_density.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.probability_density.parse_mask"><code class="docutils literal notranslate"><span class="pre">parse_mask()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-formats">Output Formats</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#vdos-analysis">VDOS Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#target.vdos.build_trajectory"><code class="docutils literal notranslate"><span class="pre">build_trajectory()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.vdos.compute_plot_vdos"><code class="docutils literal notranslate"><span class="pre">compute_plot_vdos()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.vdos.convert_symbols_to_atomic_numbers"><code class="docutils literal notranslate"><span class="pre">convert_symbols_to_atomic_numbers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.vdos.finite_diff_velocities"><code class="docutils literal notranslate"><span class="pre">finite_diff_velocities()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.vdos.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.vdos.read_cel"><code class="docutils literal notranslate"><span class="pre">read_cel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.vdos.read_evp"><code class="docutils literal notranslate"><span class="pre">read_evp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#target.vdos.read_pos"><code class="docutils literal notranslate"><span class="pre">read_pos()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#utility-modules">Utility Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-target.json_serializable">JSON Serialization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#target.json_serializable.convert_to_serializable"><code class="docutils literal notranslate"><span class="pre">convert_to_serializable()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-target.const">Constants</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="samos_modules.html">SAMOS Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="samos_modules.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="samos_modules.html#core-analysis-module">Core Analysis Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.AngularSpectrum"><code class="docutils literal notranslate"><span class="pre">AngularSpectrum</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.AngularSpectrum.run"><code class="docutils literal notranslate"><span class="pre">AngularSpectrum.run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.BaseAnalyzer"><code class="docutils literal notranslate"><span class="pre">BaseAnalyzer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.BaseAnalyzer.__init__"><code class="docutils literal notranslate"><span class="pre">BaseAnalyzer.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.BaseAnalyzer.run"><code class="docutils literal notranslate"><span class="pre">BaseAnalyzer.run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.BaseAnalyzer.set_trajectory"><code class="docutils literal notranslate"><span class="pre">BaseAnalyzer.set_trajectory()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.DynamicsAnalyzer"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.DynamicsAnalyzer.__init__"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.DynamicsAnalyzer.get_kinetic_energies"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer.get_kinetic_energies()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.DynamicsAnalyzer.get_msd"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer.get_msd()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.DynamicsAnalyzer.get_power_spectrum"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer.get_power_spectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.DynamicsAnalyzer.get_species_of_interest"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer.get_species_of_interest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.DynamicsAnalyzer.get_vaf"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer.get_vaf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.DynamicsAnalyzer.set_species_of_interest"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer.set_species_of_interest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.DynamicsAnalyzer.set_trajectories"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer.set_trajectories()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.DynamicsAnalyzer.set_verbosity"><code class="docutils literal notranslate"><span class="pre">DynamicsAnalyzer.set_verbosity()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.RDF"><code class="docutils literal notranslate"><span class="pre">RDF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.RDF.run"><code class="docutils literal notranslate"><span class="pre">RDF.run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.RDF.run_fort"><code class="docutils literal notranslate"><span class="pre">RDF.run_fort()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.TimeSeries"><code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.get_gaussian_density"><code class="docutils literal notranslate"><span class="pre">get_gaussian_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.util_msd"><code class="docutils literal notranslate"><span class="pre">util_msd()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.util_rdf_and_plot"><code class="docutils literal notranslate"><span class="pre">util_rdf_and_plot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_analysis.write_xsf_header"><code class="docutils literal notranslate"><span class="pre">write_xsf_header()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#key-functions">Key Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="samos_modules.html#i-o-operations-module">I/O Operations Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_io.get_indices"><code class="docutils literal notranslate"><span class="pre">get_indices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_io.get_position_indices"><code class="docutils literal notranslate"><span class="pre">get_position_indices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_io.get_thermo_props"><code class="docutils literal notranslate"><span class="pre">get_thermo_props()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_io.pos_2_absolute"><code class="docutils literal notranslate"><span class="pre">pos_2_absolute()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_io.read_lammps_dump"><code class="docutils literal notranslate"><span class="pre">read_lammps_dump()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_io.read_positions_with_ase"><code class="docutils literal notranslate"><span class="pre">read_positions_with_ase()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_io.read_step_info"><code class="docutils literal notranslate"><span class="pre">read_step_info()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_io.read_xsf"><code class="docutils literal notranslate"><span class="pre">read_xsf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_io.write_grid"><code class="docutils literal notranslate"><span class="pre">write_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_io.write_xsf"><code class="docutils literal notranslate"><span class="pre">write_xsf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#supported-formats">Supported Formats</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="samos_modules.html#plotting-module">Plotting Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_plotting.format_mean_err"><code class="docutils literal notranslate"><span class="pre">format_mean_err()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_plotting.my_format"><code class="docutils literal notranslate"><span class="pre">my_format()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_plotting.plot_angular_spec"><code class="docutils literal notranslate"><span class="pre">plot_angular_spec()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_plotting.plot_msd_anisotropic"><code class="docutils literal notranslate"><span class="pre">plot_msd_anisotropic()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_plotting.plot_msd_isotropic"><code class="docutils literal notranslate"><span class="pre">plot_msd_isotropic()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_plotting.plot_power_spectrum"><code class="docutils literal notranslate"><span class="pre">plot_power_spectrum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_plotting.plot_rdf"><code class="docutils literal notranslate"><span class="pre">plot_rdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#samos_modules.samos_plotting.plot_vaf_isotropic"><code class="docutils literal notranslate"><span class="pre">plot_vaf_isotropic()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="samos_modules.html#compiled-extensions">Compiled Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="samos_modules.html#usage-examples">Usage Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#basic-msd-analysis-with-samos">Basic MSD Analysis with SAMOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#rdf-calculation-and-plotting">RDF Calculation and Plotting</a></li>
<li class="toctree-l3"><a class="reference internal" href="samos_modules.html#reading-lammps-trajectories">Reading LAMMPS Trajectories</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Module Index:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">target</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Target Package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#main-analysis-driver">Main Analysis Driver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cpdyana-combined-molecular-dynamics-analysis-tool">CPDyAna – Combined Molecular Dynamics Analysis Tool</a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.CPDyAna.Job"><code class="docutils literal notranslate"><span class="pre">Job()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.CPDyAna.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.CPDyAna.parser"><code class="docutils literal notranslate"><span class="pre">parser()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#key-functions">Key Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#data-processing">Data Processing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#target.data_processing.data_evaluator"><code class="docutils literal notranslate"><span class="pre">data_evaluator()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.data_processing.find_terms"><code class="docutils literal notranslate"><span class="pre">find_terms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.data_processing.segmenter_func"><code class="docutils literal notranslate"><span class="pre">segmenter_func()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">Key Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#input-output-operations">Input/Output Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#target.input_reader.read_cel_file"><code class="docutils literal notranslate"><span class="pre">read_cel_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.input_reader.read_evp_file"><code class="docutils literal notranslate"><span class="pre">read_evp_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.input_reader.read_ion_file"><code class="docutils literal notranslate"><span class="pre">read_ion_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.input_reader.read_pos_file"><code class="docutils literal notranslate"><span class="pre">read_pos_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#supported-file-types">Supported File Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#core-calculations">Core Calculations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#target.calculations.calc_fft"><code class="docutils literal notranslate"><span class="pre">calc_fft()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.calculations.calc_msd_tracer"><code class="docutils literal notranslate"><span class="pre">calc_msd_tracer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.calculations.calculate_msd"><code class="docutils literal notranslate"><span class="pre">calculate_msd()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.calculations.disp_sum"><code class="docutils literal notranslate"><span class="pre">disp_sum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.calculations.msd_charged"><code class="docutils literal notranslate"><span class="pre">msd_charged()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.calculations.msd_tracer"><code class="docutils literal notranslate"><span class="pre">msd_tracer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#analysis-types">Analysis Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#correlation-analysis">Correlation Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#target.correrelation_analysis.Van_Hove_distinct"><code class="docutils literal notranslate"><span class="pre">Van_Hove_distinct()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.correrelation_analysis.Van_Hove_self"><code class="docutils literal notranslate"><span class="pre">Van_Hove_self()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#correlation-types">Correlation Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rdf-computation">RDF Computation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#target.compute_rdf.build_ase_trajectory"><code class="docutils literal notranslate"><span class="pre">build_ase_trajectory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.compute_rdf.compute_rdf"><code class="docutils literal notranslate"><span class="pre">compute_rdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.compute_rdf.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vaf-computation">VAF Computation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#target.compute_vaf.build_trajectory"><code class="docutils literal notranslate"><span class="pre">build_trajectory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.compute_vaf.compute_vaf"><code class="docutils literal notranslate"><span class="pre">compute_vaf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.compute_vaf.convert_symbols_to_atomic_numbers"><code class="docutils literal notranslate"><span class="pre">convert_symbols_to_atomic_numbers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.compute_vaf.finite_diff_velocities"><code class="docutils literal notranslate"><span class="pre">finite_diff_velocities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.compute_vaf.read_cel"><code class="docutils literal notranslate"><span class="pre">read_cel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.compute_vaf.read_evp"><code class="docutils literal notranslate"><span class="pre">read_evp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.compute_vaf.read_pos"><code class="docutils literal notranslate"><span class="pre">read_pos()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#plotting-and-visualization">Plotting and Visualization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#target.plotting.int_or_float"><code class="docutils literal notranslate"><span class="pre">int_or_float()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.plotting.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.plotting.msd_plot"><code class="docutils literal notranslate"><span class="pre">msd_plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.plotting.parse_cli_args"><code class="docutils literal notranslate"><span class="pre">parse_cli_args()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.plotting.van_hove_plot"><code class="docutils literal notranslate"><span class="pre">van_hove_plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#plot-types">Plot Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#probability-density-analysis">Probability Density Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#target.probability_density.build_trajectory"><code class="docutils literal notranslate"><span class="pre">build_trajectory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.probability_density.calculate_probability_density"><code class="docutils literal notranslate"><span class="pre">calculate_probability_density()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.probability_density.convert_symbols_to_atomic_numbers"><code class="docutils literal notranslate"><span class="pre">convert_symbols_to_atomic_numbers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.probability_density.divide_chunks"><code class="docutils literal notranslate"><span class="pre">divide_chunks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.probability_density.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.probability_density.parse_mask"><code class="docutils literal notranslate"><span class="pre">parse_mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-formats">Output Formats</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vdos-analysis">VDOS Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#target.vdos.build_trajectory"><code class="docutils literal notranslate"><span class="pre">build_trajectory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.vdos.compute_plot_vdos"><code class="docutils literal notranslate"><span class="pre">compute_plot_vdos()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.vdos.convert_symbols_to_atomic_numbers"><code class="docutils literal notranslate"><span class="pre">convert_symbols_to_atomic_numbers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.vdos.finite_diff_velocities"><code class="docutils literal notranslate"><span class="pre">finite_diff_velocities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.vdos.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.vdos.read_cel"><code class="docutils literal notranslate"><span class="pre">read_cel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.vdos.read_evp"><code class="docutils literal notranslate"><span class="pre">read_evp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#target.vdos.read_pos"><code class="docutils literal notranslate"><span class="pre">read_pos()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#utility-modules">Utility Modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-target.json_serializable">JSON Serialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-target.const">Constants</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CPDyAna</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Target Package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/target.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="target-package">
<h1>Target Package<a class="headerlink" href="#target-package" title="Link to this heading"></a></h1>
<p>The target package contains the core CPDyAna analysis functionality for molecular dynamics trajectory analysis. It provides a comprehensive suite of tools for calculating diffusion properties, correlation functions, and structural analysis.</p>
<section id="main-analysis-driver">
<h2>Main Analysis Driver<a class="headerlink" href="#main-analysis-driver" title="Link to this heading"></a></h2>
<p>The main CPDyAna CLI interface and job orchestration.</p>
<section id="cpdyana-combined-molecular-dynamics-analysis-tool">
<span id="module-target.CPDyAna"></span><h3>CPDyAna – Combined Molecular Dynamics Analysis Tool<a class="headerlink" href="#cpdyana-combined-molecular-dynamics-analysis-tool" title="Link to this heading"></a></h3>
<p>CPDyAna is a comprehensive command-line interface for analyzing molecular dynamics
simulations. It provides unified access to multiple analysis types including:</p>
<ul class="simple">
<li><p><strong>Mean Square Displacement (MSD)</strong>: Calculate diffusion coefficients and tracer diffusivity</p></li>
<li><p><strong>Van Hove Correlation Functions</strong>: Analyze spatial correlations (self and distinct)</p></li>
<li><p><strong>Radial Distribution Functions (RDF)</strong>: Compute pair correlation functions</p></li>
<li><p><strong>Velocity Autocorrelation Functions (VAF)</strong>: Analyze velocity correlations</p></li>
<li><p><strong>Vibrational Density of States (VDOS)</strong>: Calculate phonon spectra</p></li>
<li><p><strong>Ionic Density Maps</strong>: Generate 3D density distributions</p></li>
</ul>
<p>This single-file variant merges the original CPDyAna.py driver with helper
functions for a complete standalone workflow.</p>
<dl>
<dt>Supported File Formats:</dt><dd><ul class="simple">
<li><p>Quantum ESPRESSO trajectory files (.pos, .cel, .evp, .in)</p></li>
<li><p>LAMMPS trajectory files</p></li>
<li><p>ASE-compatible formats</p></li>
</ul>
</dd>
<dt>Usage Examples:</dt><dd><p># Mean Square Displacement analysis
python CPDyAna.py msd -T 800 –data-dir /path/to/data –diffusing-elements Li Na</p>
<p># Van Hove correlation function
python CPDyAna.py vh -T 800 –data-dir /path/to/data –rmax 10 –sigma 0.1</p>
<p># Radial distribution function
python CPDyAna.py rdf –data-dir /path/to/data –central-atom Li Al</p>
<p># Velocity autocorrelation function
python CPDyAna.py vaf –data-dir /path/to/data –element Li –nframes 1000</p>
<p># Ionic density mapping
python CPDyAna.py ionic-density –data-dir /path/to/data –element Li –sigma 0.3</p>
</dd>
</dl>
<p>Author: CPDyAna Development Team
Version: Combined version (01-02-2024)
License: Open Source</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="target.CPDyAna.Job">
<span class="sig-prename descclassname"><span class="pre">target.CPDyAna.</span></span><span class="sig-name descname"><span class="pre">Job</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusing_elements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusivity_direction_choices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusivity_choices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correlation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cel_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evp_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ion_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Conv_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_slope_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_slope_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_skip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/CPDyAna.html#Job"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.CPDyAna.Job" title="Link to this definition"></a></dt>
<dd><p>Main analysis job function for MSD, Van Hove, and related molecular dynamics analyses.</p>
<p>This function orchestrates the complete analysis workflow:
1. Reads input files (trajectory, cell parameters, energies, ion definitions)
2. Processes and segments data based on time windows
3. Performs element-specific analysis for each temperature
4. Calculates MSD or Van Hove correlation functions based on mode
5. Returns structured dictionaries with input and output data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – List of temperatures in Kelvin for analysis.</p></li>
<li><p><strong>diffusing_elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Element symbols to analyze (e.g., [‘Li’, ‘Na’]).</p></li>
<li><p><strong>diffusivity_direction_choices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Spatial directions for diffusivity
analysis (e.g., [‘X’, ‘Y’, ‘Z’, ‘XY’, ‘XYZ’]).</p></li>
<li><p><strong>diffusivity_choices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Types of diffusivity to calculate
(e.g., [‘Tracer’, ‘Collective’]).</p></li>
<li><p><strong>correlation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Correlation function types
(e.g., [‘Self’, ‘Distinct’]).</p></li>
<li><p><strong>pos_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Paths to position trajectory files (.pos).</p></li>
<li><p><strong>cel_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Paths to cell parameter files (.cel).</p></li>
<li><p><strong>evp_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Paths to energy/volume/pressure files (.evp).</p></li>
<li><p><strong>ion_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Paths to ion definition files (.in).</p></li>
<li><p><strong>Conv_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Unit conversion factor (typically 0.529177249
for Bohr to Angstrom conversion).</p></li>
<li><p><strong>initial_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Start time for analysis window in picoseconds.</p></li>
<li><p><strong>final_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – End time for analysis window in picoseconds.</p></li>
<li><p><strong>initial_slope_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Start time for slope calculation in MSD analysis.</p></li>
<li><p><strong>final_slope_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – End time for slope calculation in MSD analysis.</p></li>
<li><p><strong>block</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Block size for statistical averaging.</p></li>
<li><p><strong>rmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Maximum radial distance for correlation function analysis in Angstroms.</p></li>
<li><p><strong>step_skip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of time steps to skip between analysis frames.</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Gaussian broadening parameter for correlation functions.</p></li>
<li><p><strong>ngrid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of grid points for spatial discretization.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Analysis mode (‘msd’ for Mean Square Displacement,
‘vh’ for Van Hove correlation functions).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing two dictionaries:</dt><dd><ul class="simple">
<li><p>temp_input_dict (dict): Input data organized by (temperature, element) keys,
containing processed trajectory data and structural information.</p></li>
<li><p>temp_output_dict (dict): Output data organized by (temperature, element) keys,
containing analysis results (MSD data, correlation functions, time steps).</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.13)"><strong>FileNotFoundError</strong></a> – If any of the input files cannot be found.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If time windows or parameters are invalid.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The function handles multiple temperatures and elements simultaneously,
with results organized in nested dictionaries for easy access and plotting.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.CPDyAna.main">
<span class="sig-prename descclassname"><span class="pre">target.CPDyAna.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/CPDyAna.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.CPDyAna.main" title="Link to this definition"></a></dt>
<dd><p>Main entry point for the CPDyAna command-line interface.</p>
<p>This function serves as the central dispatcher that:
1. Parses command-line arguments to determine analysis mode
2. Validates input files and directory structure
3. Dispatches to appropriate analysis functions based on mode
4. Handles file I/O operations and subprocess calls
5. Manages error handling and user feedback</p>
<p>The function supports multiple analysis modes:
- <strong>msd</strong>: Mean Square Displacement analysis with plotting
- <strong>vh</strong>: Van Hove correlation function analysis with plotting
- <strong>ionic-density</strong>: 3D ionic density map generation
- <strong>rdf</strong>: Radial Distribution Function calculation
- <strong>vaf</strong>: Velocity Autocorrelation Function analysis
- <strong>vdos</strong>: Vibrational Density of States calculation</p>
<p>For MSD and Van Hove modes, the function:
- Calls the main Job() function to perform analysis
- Saves results to JSON format for data persistence
- Generates publication-quality plots</p>
<p>For other modes, the function:
- Validates required input files (.pos, .in, .cel, optionally .evp)
- Calls specialized analysis modules via subprocess
- Handles multiple file sets in batch mode</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#SystemExit" title="(in Python v3.13)"><strong>SystemExit</strong></a> – If required files are missing or file counts don’t match</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/subprocess.html#subprocess.CalledProcessError" title="(in Python v3.13)"><strong>subprocess.CalledProcessError</strong></a> – If subprocess analysis fails</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.13)"><strong>FileNotFoundError</strong></a> – If data directory or files cannot be found</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The function automatically discovers input files based on extensions
in the specified data directory and processes them in sorted order.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.CPDyAna.parser">
<span class="sig-prename descclassname"><span class="pre">target.CPDyAna.</span></span><span class="sig-name descname"><span class="pre">parser</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/CPDyAna.html#parser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.CPDyAna.parser" title="Link to this definition"></a></dt>
<dd><p>Create and configure the command-line argument parser for CPDyAna.</p>
<p>This function sets up the main argument parser with subcommands for different
analysis modes. Each subcommand has its own specific arguments while sharing
common parameters where appropriate.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Parsed command-line arguments containing all user-specified</dt><dd><p>options for the requested analysis mode.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/argparse.html#argparse.Namespace" title="(in Python v3.13)">argparse.Namespace</a></p>
</dd>
</dl>
<dl class="simple">
<dt>Subcommands:</dt><dd><p>msd: Mean Square Displacement analysis for diffusion coefficients
vh: Van Hove correlation function analysis
ionic-density: 3D ionic density mapping
rdf: Radial Distribution Function calculation
vaf: Velocity Autocorrelation Function analysis
vdos: Vibrational Density of States calculation</p>
</dd>
<dt>Common Arguments:</dt><dd><ul class="simple">
<li><p>temperature: Temperature(s) for thermodynamic analysis</p></li>
<li><p>diffusing-elements: Element types to analyze</p></li>
<li><p>data-dir: Directory containing input files</p></li>
<li><p>time windows: Analysis and fitting time ranges</p></li>
<li><p>statistical parameters: Block sizes, grid points, etc.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># args.mode will contain the selected subcommand</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># args.temperature will contain the temperature list</span>
</pre></div>
</div>
</dd></dl>

<section id="key-functions">
<h3>Key Functions<a class="headerlink" href="#key-functions" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#target.CPDyAna.main" title="target.CPDyAna.main"><code class="xref py py-func docutils literal notranslate"><span class="pre">target.CPDyAna.main()</span></code></a>: Main CLI entry point</p></li>
<li><p><a class="reference internal" href="#target.CPDyAna.Job" title="target.CPDyAna.Job"><code class="xref py py-func docutils literal notranslate"><span class="pre">target.CPDyAna.Job()</span></code></a>: Core analysis job orchestrator</p></li>
<li><p><a class="reference internal" href="#target.CPDyAna.parser" title="target.CPDyAna.parser"><code class="xref py py-func docutils literal notranslate"><span class="pre">target.CPDyAna.parser()</span></code></a>: Command-line argument parser</p></li>
</ul>
</section>
</section>
<section id="data-processing">
<h2>Data Processing<a class="headerlink" href="#data-processing" title="Link to this heading"></a></h2>
<p>Utilities for processing and segmenting trajectory data.</p>
<p id="module-target.data_processing">Data processing utilities for CPDyAna.</p>
<p>This module provides functions for:
- Finding array indices within a time range
- Segmenting trajectory and property data
- Evaluating and correcting position data for diffusivity analysis</p>
<dl class="py function">
<dt class="sig sig-object py" id="target.data_processing.data_evaluator">
<span class="sig-prename descclassname"><span class="pre">target.data_processing.</span></span><span class="sig-name descname"><span class="pre">data_evaluator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diffusivity_direction_choices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_elements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_ion_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/data_processing.html#data_evaluator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.data_processing.data_evaluator" title="Link to this definition"></a></dt>
<dd><p>Processes position data for diffusivity analysis, including drift correction and selection of mobile/framework ions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>diffusivity_direction_choices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Directions to analyze (e.g., [“XYZ”, “XY”, “Z”]).</p></li>
<li><p><strong>target_elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Elements considered as mobile ions (e.g., [“Li”]).</p></li>
<li><p><strong>pos</strong> (<em>ndarray</em>) – Position array (n_atoms, n_steps, 3).</p></li>
<li><p><strong>total_ion_array</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of element symbols for all atoms.</p></li>
<li><p><strong>steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of time steps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>position_data_list: Position data for each direction.</p></li>
<li><p>drifted_rectified_structure_list: Drift-corrected positions.</p></li>
<li><p>conductor_indices_list: Indices of mobile ions.</p></li>
<li><p>framework_indices_list: Indices of framework ions.</p></li>
<li><p>framework_pos_list: Positions of framework ions.</p></li>
<li><p>mobile_pos_list: Positions of mobile ions.</p></li>
<li><p>mobile_drifted_rectified_structure_list: Drift-corrected positions of mobile ions.</p></li>
<li><p>framework_drifted_rectified_structure_list: Drift-corrected positions of framework ions.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of arrays containing</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.data_processing.find_terms">
<span class="sig-prename descclassname"><span class="pre">target.data_processing.</span></span><span class="sig-name descname"><span class="pre">find_terms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/data_processing.html#find_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.data_processing.find_terms" title="Link to this definition"></a></dt>
<dd><p>Find the first and last indices in ‘array’ where the values are within [first_value, last_value].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>array-like</em>) – Array of time or step values.</p></li>
<li><p><strong>first_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Lower bound of the range.</p></li>
<li><p><strong>last_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Upper bound of the range.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Index of first value &gt;= first_value.
last_term (int or None): Index of last value &lt;= last_value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>first_term (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a> or None)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.data_processing.segmenter_func">
<span class="sig-prename descclassname"><span class="pre">target.data_processing.</span></span><span class="sig-name descname"><span class="pre">segmenter_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">first_term</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ke_elec_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_temp_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ion_temp_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tot_energy_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enthalpy_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tot_energy_ke_ion_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tot_energy_ke_ion_ke_elec_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure_full</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/data_processing.html#segmenter_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.data_processing.segmenter_func" title="Link to this definition"></a></dt>
<dd><p>Extracts a segment of the trajectory and associated properties between first_term and last_term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>first_term</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Starting index for the segment.</p></li>
<li><p><strong>last</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Ending index for the segment.</p></li>
<li><p><strong>pos_full</strong> (<em>arrays</em>) – Full arrays of trajectory and property data.</p></li>
<li><p><strong>dt_full</strong> (<em>arrays</em>) – Full arrays of trajectory and property data.</p></li>
<li><p><strong>...</strong> (<em>arrays</em>) – Full arrays of trajectory and property data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(pos, step_counts, dt, time, cell, ke_elec, cell_temp, ion_temp,</dt><dd><p>tot_energy, enthalpy, tot_energy_ke_ion, tot_energy_ke_ion_ke_elec, vol, pressure)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of arrays</p>
</dd>
</dl>
</dd></dl>

<section id="id1">
<h3>Key Functions<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#target.data_processing.find_terms" title="target.data_processing.find_terms"><code class="xref py py-func docutils literal notranslate"><span class="pre">target.data_processing.find_terms()</span></code></a>: Find time window indices</p></li>
<li><p><a class="reference internal" href="#target.data_processing.segmenter_func" title="target.data_processing.segmenter_func"><code class="xref py py-func docutils literal notranslate"><span class="pre">target.data_processing.segmenter_func()</span></code></a>: Segment trajectory data</p></li>
<li><p><a class="reference internal" href="#target.data_processing.data_evaluator" title="target.data_processing.data_evaluator"><code class="xref py py-func docutils literal notranslate"><span class="pre">target.data_processing.data_evaluator()</span></code></a>: Process position data for analysis</p></li>
</ul>
</section>
</section>
<section id="input-output-operations">
<h2>Input/Output Operations<a class="headerlink" href="#input-output-operations" title="Link to this heading"></a></h2>
<p>Reading and parsing of Quantum ESPRESSO input and trajectory files.</p>
<dl class="py function" id="module-target.input_reader">
<dt class="sig sig-object py" id="target.input_reader.read_cel_file">
<span class="sig-prename descclassname"><span class="pre">target.input_reader.</span></span><span class="sig-name descname"><span class="pre">read_cel_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cel_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Length_conversion_factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/input_reader.html#read_cel_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.input_reader.read_cel_file" title="Link to this definition"></a></dt>
<dd><p>Read cell parameters from a cel file and apply length conversion.</p>
<p>This function reads cell vectors from a cel file, where every 4 lines
represent one time step (header + 3 cell vectors).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cel_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the cel file containing cell parameter data</p></li>
<li><p><strong>Length_conversion_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Factor to convert length units</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Array of shape (n_timesteps, 9) containing flattened</dt><dd><p>cell vectors for each time step</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.input_reader.read_evp_file">
<span class="sig-prename descclassname"><span class="pre">target.input_reader.</span></span><span class="sig-name descname"><span class="pre">read_evp_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evp_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Length_conversion_factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/input_reader.html#read_evp_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.input_reader.read_evp_file" title="Link to this definition"></a></dt>
<dd><p>Read energy, volume, and pressure data from an EVP file.</p>
<p>This function parses an EVP file to extract thermodynamic properties
and calculates time step information from the first two entries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evp_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the EVP file containing energy/volume/pressure data</p></li>
<li><p><strong>Length_conversion_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Factor to convert length units (affects volume)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Contains the following 11 elements:</dt><dd><ul class="simple">
<li><p>ke_electronic (list): Electronic kinetic energy values</p></li>
<li><p>cell_temp (list): Cell temperature values</p></li>
<li><p>ion_temp (list): Ion temperature values</p></li>
<li><p>tot_energy (list): Total energy values</p></li>
<li><p>enthalpy (list): Enthalpy values</p></li>
<li><p>tot_energy_ke_ion (list): Total energy + ion kinetic energy</p></li>
<li><p>tot_energy_ke_ion_ke_elec (list): Total energy + ion KE + electronic KE</p></li>
<li><p>vol (list): Volume values (converted to target units)</p></li>
<li><p>pressure (list): Pressure values</p></li>
<li><p>number_of_time_frames (float): Time step difference between first two frames</p></li>
<li><p>time_difference (float): Time difference between first two frames</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.input_reader.read_ion_file">
<span class="sig-prename descclassname"><span class="pre">target.input_reader.</span></span><span class="sig-name descname"><span class="pre">read_ion_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ion_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/input_reader.html#read_ion_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.input_reader.read_ion_file" title="Link to this definition"></a></dt>
<dd><p>Read and extract ion information from an ion file.</p>
<p>This function parses an ion file to extract atomic species information
from the ATOMIC_POSITIONS section.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ion_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the ion file containing atomic position data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of element symbols (strings) representing the atomic species</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.input_reader.read_pos_file">
<span class="sig-prename descclassname"><span class="pre">target.input_reader.</span></span><span class="sig-name descname"><span class="pre">read_pos_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_ions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Length_conversion_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_time_frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_difference</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/input_reader.html#read_pos_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.input_reader.read_pos_file" title="Link to this definition"></a></dt>
<dd><p>Read atomic positions from a position file and organize by ion and time step.</p>
<p>This function reads position data where each time step contains positions
for all ions, separated by header lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the position file</p></li>
<li><p><strong>total_ions</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of ion types/elements</p></li>
<li><p><strong>Length_conversion_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Factor to convert length units</p></li>
<li><p><strong>number_of_time_frames</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Number of time frames between steps</p></li>
<li><p><strong>time_difference</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time difference between consecutive frames</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Contains the following 4 elements:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>ion_disp (numpy.ndarray): Array of shape (n_ions, n_timesteps, 3)</dt><dd><p>containing ion positions</p>
</dd>
</dl>
</li>
<li><p>len(data_steps) (int): Total number of time steps</p></li>
<li><p>dt (numpy.ndarray): Array of time differences for each step</p></li>
<li><p>time (numpy.ndarray): Array of absolute time values</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<section id="supported-file-types">
<h3>Supported File Types<a class="headerlink" href="#supported-file-types" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>.pos files</strong>: Position trajectories</p></li>
<li><p><strong>.cel files</strong>: Unit cell parameters</p></li>
<li><p><strong>.evp files</strong>: Energy, volume, pressure data</p></li>
<li><p><strong>.in files</strong>: Ion definitions and atomic information</p></li>
</ul>
</section>
</section>
<section id="core-calculations">
<h2>Core Calculations<a class="headerlink" href="#core-calculations" title="Link to this heading"></a></h2>
<p>Main calculation routines for MSD and diffusion analysis.</p>
<dl class="py function" id="module-target.calculations">
<dt class="sig sig-object py" id="target.calculations.calc_fft">
<span class="sig-prename descclassname"><span class="pre">target.calculations.</span></span><span class="sig-name descname"><span class="pre">calc_fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/calculations.html#calc_fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.calculations.calc_fft" title="Link to this definition"></a></dt>
<dd><p>Calculate FFT-based autocorrelation function for MSD computation.</p>
<p>This function uses Fast Fourier Transform to efficiently compute the
autocorrelation function needed for mean square displacement calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – Input array of position data for one dimension</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized autocorrelation function values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.calculations.calc_msd_tracer">
<span class="sig-prename descclassname"><span class="pre">target.calculations.</span></span><span class="sig-name descname"><span class="pre">calc_msd_tracer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/calculations.html#calc_msd_tracer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.calculations.calc_msd_tracer" title="Link to this definition"></a></dt>
<dd><p>Calculate tracer mean square displacement using FFT method.</p>
<p>This function computes MSD for a single particle trajectory using
the efficient FFT-based algorithm to avoid O(N²) complexity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – Position array of shape (time_steps, 3) for one particle</p></li>
<li><p><strong>d_idx</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – Array of time lag indices</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Contains:</dt><dd><ul class="simple">
<li><p>MSD values for specified time lags</p></li>
<li><p>MSD components for each spatial dimension</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.calculations.calculate_msd">
<span class="sig-prename descclassname"><span class="pre">target.calculations.</span></span><span class="sig-name descname"><span class="pre">calculate_msd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diffusing_elements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusivity_direction_choices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusivity_type_choices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conduct_rectified_structure_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conduct_ions_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Last_term</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_slope_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_slope_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/calculations.html#calculate_msd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.calculations.calculate_msd" title="Link to this definition"></a></dt>
<dd><p>Main function to calculate MSD and diffusivity for multiple elements and conditions.</p>
<p>This function performs comprehensive MSD and diffusivity analysis including:
- Multiple diffusion types (Tracer, Charged)
- Multiple spatial directions (X, Y, Z, XY, YZ, ZX, XYZ)
- Linear regression analysis for diffusivity extraction
- Block analysis for error estimation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>diffusing_elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of element names to analyze</p></li>
<li><p><strong>diffusivity_direction_choices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of spatial directions</p></li>
<li><p><strong>diffusivity_type_choices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of diffusion types</p></li>
<li><p><strong>pos_full</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – Full position array</p></li>
<li><p><strong>conduct_rectified_structure_array</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – Rectified position data</p></li>
<li><p><strong>conduct_ions_array</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – Ion type information</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – Time step array</p></li>
<li><p><strong>Last_term</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Final time value</p></li>
<li><p><strong>initial_slope_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Start time for linear fitting</p></li>
<li><p><strong>final_slope_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – End time for linear fitting</p></li>
<li><p><strong>block</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Block size for error analysis</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Nested dictionary containing MSD arrays, diffusivities, and error estimates</dt><dd><p>Structure: {element: {property_name: [values]}}</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.calculations.disp_sum">
<span class="sig-prename descclassname"><span class="pre">target.calculations.</span></span><span class="sig-name descname"><span class="pre">disp_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mobile_ion_pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/calculations.html#disp_sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.calculations.disp_sum" title="Link to this definition"></a></dt>
<dd><p>Calculate the sum of squared displacements for a given time delta.</p>
<p>This function computes the collective displacement term needed for
charged MSD calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Time step difference (time lag)</p></li>
<li><p><strong>mobile_ion_pos</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – 3D array of shape (num_mobile_ions, steps, 3)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sum of squared collective displacements</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.calculations.msd_charged">
<span class="sig-prename descclassname"><span class="pre">target.calculations.</span></span><span class="sig-name descname"><span class="pre">msd_charged</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_msd</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/calculations.html#msd_charged"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.calculations.msd_charged" title="Link to this definition"></a></dt>
<dd><p>Calculate the charged MSD for a given 3D position array and tracer MSD.</p>
<p>The charged MSD accounts for collective motion and correlations between
different ions in the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – 3D array of shape (num_mobile_ions, steps, 3)
containing position data</p></li>
<li><p><strong>final_msd</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – 1D array containing the tracer MSD values</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D array of charged MSD values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.calculations.msd_tracer">
<span class="sig-prename descclassname"><span class="pre">target.calculations.</span></span><span class="sig-name descname"><span class="pre">msd_tracer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/calculations.html#msd_tracer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.calculations.msd_tracer" title="Link to this definition"></a></dt>
<dd><p>Calculate average tracer MSD for multiple particles.</p>
<p>This function computes the tracer MSD by averaging over all mobile ions
in the system for various time lags.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – 3D array of shape (n_ions, n_timesteps, 3)</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Total number of time steps</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Average MSD values for time lags from 1 to step-1</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<section id="analysis-types">
<h3>Analysis Types<a class="headerlink" href="#analysis-types" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Mean Square Displacement</strong>: Tracer and collective diffusivity</p></li>
<li><p><strong>Diffusion Coefficients</strong>: Multi-directional analysis (X, Y, Z, XY, XZ, YZ, XYZ)</p></li>
<li><p><strong>Statistical Analysis</strong>: Block averaging and error estimation</p></li>
</ul>
</section>
</section>
<section id="correlation-analysis">
<h2>Correlation Analysis<a class="headerlink" href="#correlation-analysis" title="Link to this heading"></a></h2>
<p>Van Hove correlation functions and related analysis.</p>
<dl class="py function" id="module-target.correrelation_analysis">
<dt class="sig sig-object py" id="target.correrelation_analysis.Van_Hove_distinct">
<span class="sig-prename descclassname"><span class="pre">target.correrelation_analysis.</span></span><span class="sig-name descname"><span class="pre">Van_Hove_distinct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">avg_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_skip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moving_ion_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/correrelation_analysis.html#Van_Hove_distinct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.correrelation_analysis.Van_Hove_distinct" title="Link to this definition"></a></dt>
<dd><p>Calculate the distinct part of the Van Hove function for ion diffusion.</p>
<p>Parameters:
- avg_step (int): Number of steps to average over.
- dt (numpy.ndarray): Time array.
- rmax (float): Maximum distance for radial distribution.
- step_skip (int): Number of steps to skip.
- sigma (float): Standard deviation for Gaussian function.
- ngrid (int): Number of grid points.
- moving_ion_pos (numpy.ndarray): Position array for moving ions.
- volume (float): System volume.
- x1, x2, x3, y1, y2, y3, z1, z2, z3 (float): Box vectors.</p>
<p>Returns:
- numpy.ndarray, int, numpy.ndarray: Distance interval, reduced number of time steps, distinct part of Van Hove function.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.correrelation_analysis.Van_Hove_self">
<span class="sig-prename descclassname"><span class="pre">target.correrelation_analysis.</span></span><span class="sig-name descname"><span class="pre">Van_Hove_self</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">avg_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_skip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moving_ion_pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/correrelation_analysis.html#Van_Hove_self"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.correrelation_analysis.Van_Hove_self" title="Link to this definition"></a></dt>
<dd><p>Calculate the self part of the Van Hove function for ion diffusion.</p>
<p>Parameters:
- avg_step (int): Number of steps to average over.
- dt (numpy.ndarray): Time array.
- rmax (float): Maximum distance for radial distribution.
- step_skip (int): Number of steps to skip.
- sigma (float): Standard deviation for Gaussian function.
- ngrid (int): Number of grid points.
- moving_ion_pos (numpy.ndarray): Position array for moving ions.</p>
<p>Returns:
- numpy.ndarray, int, numpy.ndarray: Distance interval, reduced number of time steps, self part of Van Hove function.</p>
</dd></dl>

<section id="correlation-types">
<h3>Correlation Types<a class="headerlink" href="#correlation-types" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Self Correlation</strong>: Single particle dynamics (<a class="reference internal" href="#target.correrelation_analysis.Van_Hove_self" title="target.correrelation_analysis.Van_Hove_self"><code class="xref py py-func docutils literal notranslate"><span class="pre">target.correrelation_analysis.Van_Hove_self()</span></code></a>)</p></li>
<li><p><strong>Distinct Correlation</strong>: Pair dynamics (<a class="reference internal" href="#target.correrelation_analysis.Van_Hove_distinct" title="target.correrelation_analysis.Van_Hove_distinct"><code class="xref py py-func docutils literal notranslate"><span class="pre">target.correrelation_analysis.Van_Hove_distinct()</span></code></a>)</p></li>
</ul>
</section>
</section>
<section id="rdf-computation">
<h2>RDF Computation<a class="headerlink" href="#rdf-computation" title="Link to this heading"></a></h2>
<p>Radial distribution function calculations with ASE integration.</p>
<p id="module-target.compute_rdf">compute_rdf.py</p>
<p>Compute Radial Distribution Functions (RDFs) from Quantum ESPRESSO molecular dynamics output files (.in, .pos, .cel).
This script builds atomic trajectories using ASE, converts them to pymatgen structures, and calculates RDFs for various atom pairs using pymatgen’s efficient implementation.</p>
<p>Flexible CLI options allow user control over RDF parameters and plotting.</p>
<dl class="simple">
<dt>Usage:</dt><dd><p>python compute_rdf.py –in-file LiAlPS.in –pos-file LiAlPS.pos –cel-file LiAlPS.cel
# For more options:
python compute_rdf.py –help</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="target.compute_rdf.build_ase_trajectory">
<span class="sig-prename descclassname"><span class="pre">target.compute_rdf.</span></span><span class="sig-name descname"><span class="pre">build_ase_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cel_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_after_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.00193511</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_rdf.html#build_ase_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_rdf.build_ase_trajectory" title="Link to this definition"></a></dt>
<dd><p>Build ASE trajectory frames from Quantum ESPRESSO output files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the .in input file.</p></li>
<li><p><strong>pos_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the .pos position file.</p></li>
<li><p><strong>cel_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the .cel cell parameter file.</p></li>
<li><p><strong>time_after_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time in ps after which to start extracting frames.</p></li>
<li><p><strong>num_frames</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of frames to extract.</p></li>
<li><p><strong>time_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time interval between frames in ps.</p></li>
<li><p><strong>bohr_to_angstrom</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Conversion factor from Bohr to Angstrom.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of ASE Atoms objects representing the trajectory frames.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.compute_rdf.compute_rdf">
<span class="sig-prename descclassname"><span class="pre">target.compute_rdf.</span></span><span class="sig-name descname"><span class="pre">compute_rdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rdf_plot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_after_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pair_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngrid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1.5,</span> <span class="pre">8.0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_rdf.html#compute_rdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_rdf.compute_rdf" title="Link to this definition"></a></dt>
<dd><p>Compute RDF for various atom pairs and generate plots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of ASE Atoms objects representing the trajectory.</p></li>
<li><p><strong>output_prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Prefix for output plot filenames.</p></li>
<li><p><strong>time_after_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time after start for filename generation.</p></li>
<li><p><strong>central_atoms</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of central atom types (default: [‘Li’, ‘Al’, ‘P’, ‘S’]).</p></li>
<li><p><strong>pair_atoms</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of pair atom types (default: same as central_atoms).</p></li>
<li><p><strong>ngrid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of radial grid points.</p></li>
<li><p><strong>rmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Maximum distance for RDF calculation (Å).</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Gaussian broadening parameter.</p></li>
<li><p><strong>xlim</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – x-axis limits for plot.</p></li>
<li><p><strong>ylim_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Factor to multiply max RDF for y-axis limit.</p></li>
<li><p><strong>show_plot</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to display the plot interactively.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Contains r (distance array) and RDF arrays for different atom pairs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.compute_rdf.main">
<span class="sig-prename descclassname"><span class="pre">target.compute_rdf.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_rdf.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_rdf.main" title="Link to this definition"></a></dt>
<dd><p>Main function with integrated .traj conversion approach.
Handles command-line argument parsing, file validation,
and orchestrates the complete RDF calculation workflow from Quantum
ESPRESSO output files.</p>
</dd></dl>

</section>
<section id="vaf-computation">
<h2>VAF Computation<a class="headerlink" href="#vaf-computation" title="Link to this heading"></a></h2>
<p>Velocity autocorrelation function analysis.</p>
<p id="module-target.compute_vaf">compute_vaf.py</p>
<p>Read QE .in/.pos/.cel[/.evp], build ASE+Velocities, compute VAF with SAMOS, and plot.</p>
<p>This script reads Quantum ESPRESSO trajectory files, constructs ASE Atoms objects with velocities,
computes the velocity autocorrelation function (VAF) for specified elements using the SAMOS library,
and plots/saves the results.</p>
<dl class="simple">
<dt>Usage example:</dt><dd><p>python vaf.py –in_file LiAlPS.in –pos_file LiAlPS.pos –cel_file LiAlPS.cel –element Li Na</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="target.compute_vaf.build_trajectory">
<span class="sig-prename descclassname"><span class="pre">target.compute_vaf.</span></span><span class="sig-name descname"><span class="pre">build_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cel_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evp_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nframes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.00193511</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_vaf.html#build_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_vaf.build_trajectory" title="Link to this definition"></a></dt>
<dd><p>Build a trajectory as a list of ASE Atoms objects with velocities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .in file (species).</p></li>
<li><p><strong>pos_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .pos file (positions).</p></li>
<li><p><strong>cel_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .cel file (cell parameters).</p></li>
<li><p><strong>evp_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Path to .evp file (timing).</p></li>
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Start time in ps.</p></li>
<li><p><strong>nframes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of frames to use (0=all).</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Stride for frames.</p></li>
<li><p><strong>time_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Default time between frames (ps) if no .evp.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(frames, dt)</dt><dd><p>frames: list of ASE Atoms objects with velocities.
dt: time step in ps.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.compute_vaf.compute_vaf">
<span class="sig-prename descclassname"><span class="pre">target.compute_vaf.</span></span><span class="sig-name descname"><span class="pre">compute_vaf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blocks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_start_fit_ps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize_t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize_tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_end_fit_ps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_vaf.html#compute_vaf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_vaf.compute_vaf" title="Link to this definition"></a></dt>
<dd><p>Compute the velocity autocorrelation function (VAF) for a given element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frames</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of ASE Atoms objects with velocities.</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time step in ps.</p></li>
<li><p><strong>element</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Element symbol (e.g. ‘Li’).</p></li>
<li><p><strong>blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of statistical blocks.</p></li>
<li><p><strong>out_prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Output file prefix.</p></li>
<li><p><strong>in_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .in file (for species).</p></li>
<li><p><strong>t_start_dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Start index for VAF calculation.</p></li>
<li><p><strong>stepsize_t</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Stride for t in VAF.</p></li>
<li><p><strong>stepsize_tau</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Stride for tau in VAF.</p></li>
<li><p><strong>t_end_fit_ps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – End of fit in ps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(t, vaf, vint)</dt><dd><p>t: time array (ps)
vaf: VAF array
vint: VAF integral array</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.compute_vaf.convert_symbols_to_atomic_numbers">
<span class="sig-prename descclassname"><span class="pre">target.compute_vaf.</span></span><span class="sig-name descname"><span class="pre">convert_symbols_to_atomic_numbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_vaf.html#convert_symbols_to_atomic_numbers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_vaf.convert_symbols_to_atomic_numbers" title="Link to this definition"></a></dt>
<dd><p>Convert a list of element symbols to atomic numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>symbols</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of element symbols (str).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of atomic numbers (int).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.compute_vaf.finite_diff_velocities">
<span class="sig-prename descclassname"><span class="pre">target.compute_vaf.</span></span><span class="sig-name descname"><span class="pre">finite_diff_velocities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_vaf.html#finite_diff_velocities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_vaf.finite_diff_velocities" title="Link to this definition"></a></dt>
<dd><p>Compute velocities using finite differences from positions and times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_arr</strong> (<em>np.ndarray</em>) – Array of shape (Nframes, natoms, 3) with positions.</p></li>
<li><p><strong>times</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of time values (ps), length Nframes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of velocities, same shape as pos_arr.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.compute_vaf.read_cel">
<span class="sig-prename descclassname"><span class="pre">target.compute_vaf.</span></span><span class="sig-name descname"><span class="pre">read_cel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cel_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_vaf.html#read_cel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_vaf.read_cel" title="Link to this definition"></a></dt>
<dd><p>Read cell parameters from a .cel file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cel_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .cel file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of 4-line blocks (cell info per frame).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.compute_vaf.read_evp">
<span class="sig-prename descclassname"><span class="pre">target.compute_vaf.</span></span><span class="sig-name descname"><span class="pre">read_evp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evp_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_vaf.html#read_evp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_vaf.read_evp" title="Link to this definition"></a></dt>
<dd><p>Read time steps from a .evp file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>evp_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .evp file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of times (float).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.compute_vaf.read_pos">
<span class="sig-prename descclassname"><span class="pre">target.compute_vaf.</span></span><span class="sig-name descname"><span class="pre">read_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natoms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/compute_vaf.html#read_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.compute_vaf.read_pos" title="Link to this definition"></a></dt>
<dd><p>Read atomic positions from a .pos file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .pos file.</p></li>
<li><p><strong>natoms</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of atoms.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of (natoms+1)-line blocks (positions per frame).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="plotting-and-visualization">
<h2>Plotting and Visualization<a class="headerlink" href="#plotting-and-visualization" title="Link to this heading"></a></h2>
<p>Plotting utilities for analysis results.</p>
<dl class="py function" id="module-target.plotting">
<dt class="sig sig-object py" id="target.plotting.int_or_float">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">int_or_float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#int_or_float"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.int_or_float" title="Link to this definition"></a></dt>
<dd><p>Helper function to convert a string to int if possible, else float.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Value to convert.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Converted value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.plotting.main">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.main" title="Link to this definition"></a></dt>
<dd><p>Main entry point for plotting CLI.
Dispatches to MSD or Van Hove plotting based on subcommand.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.plotting.msd_plot">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">msd_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Plot_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">First_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Last_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#msd_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.msd_plot" title="Link to this definition"></a></dt>
<dd><p>Plot Mean Squared Displacement (MSD) from JSON data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the JSON file with simulation data.</p></li>
<li><p><strong>Plot_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of plot instructions, each a list of [temp, element, msd_type, direction].</p></li>
<li><p><strong>First_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of start times for each time window.</p></li>
<li><p><strong>Last_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of end times for each time window.</p></li>
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – If provided, the plot is saved to this file (JPEG).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.plotting.parse_cli_args">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">parse_cli_args</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#parse_cli_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.parse_cli_args" title="Link to this definition"></a></dt>
<dd><p>Parse command-line arguments for MSD and Van Hove plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Parsed arguments.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/argparse.html#argparse.Namespace" title="(in Python v3.13)">argparse.Namespace</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.plotting.van_hove_plot">
<span class="sig-prename descclassname"><span class="pre">target.plotting.</span></span><span class="sig-name descname"><span class="pre">van_hove_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Plot_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">8)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/plotting.html#van_hove_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.plotting.van_hove_plot" title="Link to this definition"></a></dt>
<dd><p>Plot the Van Hove function (Self or Distinct) from a JSON file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the JSON file with simulation data.</p></li>
<li><p><strong>Plot_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of plot instructions, each a list of [temp, element, h_type].</p></li>
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – If provided, the plot is saved to this file (JPEG).</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>, </em><em>optional</em>) – Figure size (width, height).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<section id="plot-types">
<h3>Plot Types<a class="headerlink" href="#plot-types" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>MSD Plots</strong>: <a class="reference internal" href="#target.plotting.msd_plot" title="target.plotting.msd_plot"><code class="xref py py-func docutils literal notranslate"><span class="pre">target.plotting.msd_plot()</span></code></a></p></li>
<li><p><strong>Van Hove Plots</strong>: <a class="reference internal" href="#target.plotting.van_hove_plot" title="target.plotting.van_hove_plot"><code class="xref py py-func docutils literal notranslate"><span class="pre">target.plotting.van_hove_plot()</span></code></a></p></li>
<li><p><strong>Multi-panel Figures</strong>: Comparative analysis visualization</p></li>
</ul>
</section>
</section>
<section id="probability-density-analysis">
<h2>Probability Density Analysis<a class="headerlink" href="#probability-density-analysis" title="Link to this heading"></a></h2>
<p>3D ionic density mapping and spatial analysis.</p>
<p id="module-target.probability_density">Ultimate Probability Density Calculator (Extensible Version)
Integrates CPDyAna and SAMOS methodologies for direct use with .in, .pos, .cel, .evp files.
Now supports advanced options: frame stride, atom masking, recentering, and custom bounding box.</p>
<dl class="py function">
<dt class="sig sig-object py" id="target.probability_density.build_trajectory">
<span class="sig-prename descclassname"><span class="pre">target.probability_density.</span></span><span class="sig-name descname"><span class="pre">build_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cel_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_after_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.00193511</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/probability_density.html#build_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.probability_density.build_trajectory" title="Link to this definition"></a></dt>
<dd><p>Build an in-memory trajectory from .in, .pos, .cel files.
Returns a list of ASE Atoms objects.
Supports frame stride for subsampling.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.probability_density.calculate_probability_density">
<span class="sig-prename descclassname"><span class="pre">target.probability_density.</span></span><span class="sig-name descname"><span class="pre">calculate_probability_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Li'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recenter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/probability_density.html#calculate_probability_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.probability_density.calculate_probability_density" title="Link to this definition"></a></dt>
<dd><p>Calculate the Gaussian probability density for a given element in the trajectory.
Supports atom masking, recentering, and custom bounding box.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.probability_density.convert_symbols_to_atomic_numbers">
<span class="sig-prename descclassname"><span class="pre">target.probability_density.</span></span><span class="sig-name descname"><span class="pre">convert_symbols_to_atomic_numbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element_symbols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/probability_density.html#convert_symbols_to_atomic_numbers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.probability_density.convert_symbols_to_atomic_numbers" title="Link to this definition"></a></dt>
<dd><p>Convert element symbols to atomic numbers.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.probability_density.divide_chunks">
<span class="sig-prename descclassname"><span class="pre">target.probability_density.</span></span><span class="sig-name descname"><span class="pre">divide_chunks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/probability_density.html#divide_chunks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.probability_density.divide_chunks" title="Link to this definition"></a></dt>
<dd><p>Yield successive n-sized chunks from l.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.probability_density.main">
<span class="sig-prename descclassname"><span class="pre">target.probability_density.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/probability_density.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.probability_density.main" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.probability_density.parse_mask">
<span class="sig-prename descclassname"><span class="pre">target.probability_density.</span></span><span class="sig-name descname"><span class="pre">parse_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_atoms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/probability_density.html#parse_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.probability_density.parse_mask" title="Link to this definition"></a></dt>
<dd><p>Parse a mask string like ‘0,1,2,5-10’ into a list of atom indices.</p>
</dd></dl>

<section id="output-formats">
<h3>Output Formats<a class="headerlink" href="#output-formats" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>XSF Files</strong>: For visualization in VESTA, XCrySDen</p></li>
<li><p><strong>Grid Data</strong>: For custom visualization and analysis</p></li>
</ul>
</section>
</section>
<section id="vdos-analysis">
<h2>VDOS Analysis<a class="headerlink" href="#vdos-analysis" title="Link to this heading"></a></h2>
<p>Vibrational Density of States calculations.</p>
<p id="module-target.vdos">Compute and plot VDOS from .in/.pos/.cel[/.evp] using SAMOS.</p>
<p>This script reads Quantum ESPRESSO trajectory files, constructs ASE Atoms objects with velocities,
computes the vibrational density of states (VDOS) using the SAMOS library, and plots/saves the results.</p>
<dl class="simple">
<dt>Usage example:</dt><dd><p>python vdos.py –in_file LiAlPS.in –pos_file LiAlPS.pos –cel_file LiAlPS.cel –elements Li Al P S</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="target.vdos.build_trajectory">
<span class="sig-prename descclassname"><span class="pre">target.vdos.</span></span><span class="sig-name descname"><span class="pre">build_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cel_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evp_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nframes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.00193511</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/vdos.html#build_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.vdos.build_trajectory" title="Link to this definition"></a></dt>
<dd><p>Build a trajectory as a list of ASE Atoms objects with velocities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .in file (species).</p></li>
<li><p><strong>pos_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .pos file (positions).</p></li>
<li><p><strong>cel_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .cel file (cell parameters).</p></li>
<li><p><strong>evp_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Path to .evp file (timing).</p></li>
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Start time in ps.</p></li>
<li><p><strong>nframes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of frames to use (0=all).</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Stride for frames.</p></li>
<li><p><strong>time_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Default time between frames (ps) if no .evp.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of ASE Atoms objects with velocities.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.vdos.compute_plot_vdos">
<span class="sig-prename descclassname"><span class="pre">target.vdos.</span></span><span class="sig-name descname"><span class="pre">compute_plot_vdos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.00193511</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/vdos.html#compute_plot_vdos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.vdos.compute_plot_vdos" title="Link to this definition"></a></dt>
<dd><p>Compute and plot the vibrational density of states (VDOS) for the trajectory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frames</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of ASE Atoms objects with velocities.</p></li>
<li><p><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Output file prefix for plots.</p></li>
<li><p><strong>elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> or </em><em>None</em>) – List of elements to plot VDOS for (default: Li, Al, P, S).</p></li>
<li><p><strong>time_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time interval between frames in ps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.vdos.convert_symbols_to_atomic_numbers">
<span class="sig-prename descclassname"><span class="pre">target.vdos.</span></span><span class="sig-name descname"><span class="pre">convert_symbols_to_atomic_numbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/vdos.html#convert_symbols_to_atomic_numbers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.vdos.convert_symbols_to_atomic_numbers" title="Link to this definition"></a></dt>
<dd><p>Convert a list of element symbols to atomic numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>symbols</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of element symbols (str).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of atomic numbers (int).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.vdos.finite_diff_velocities">
<span class="sig-prename descclassname"><span class="pre">target.vdos.</span></span><span class="sig-name descname"><span class="pre">finite_diff_velocities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/vdos.html#finite_diff_velocities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.vdos.finite_diff_velocities" title="Link to this definition"></a></dt>
<dd><p>Compute velocities using finite differences from positions and times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_arr</strong> (<em>np.ndarray</em>) – Array of shape (Nframes, natoms, 3) with positions.</p></li>
<li><p><strong>times</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of time values (ps), length Nframes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of velocities, same shape as pos_arr.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.vdos.main">
<span class="sig-prename descclassname"><span class="pre">target.vdos.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/vdos.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.vdos.main" title="Link to this definition"></a></dt>
<dd><p>Main function for VDOS computation and plotting.
Parses command-line arguments, builds trajectory, and generates VDOS plots.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.vdos.read_cel">
<span class="sig-prename descclassname"><span class="pre">target.vdos.</span></span><span class="sig-name descname"><span class="pre">read_cel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cel_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/vdos.html#read_cel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.vdos.read_cel" title="Link to this definition"></a></dt>
<dd><p>Read cell parameters from a .cel file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cel_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .cel file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of 4-line blocks (cell info per frame).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.vdos.read_evp">
<span class="sig-prename descclassname"><span class="pre">target.vdos.</span></span><span class="sig-name descname"><span class="pre">read_evp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evp_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/vdos.html#read_evp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.vdos.read_evp" title="Link to this definition"></a></dt>
<dd><p>Read time steps from a .evp file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>evp_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .evp file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of times (float).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="target.vdos.read_pos">
<span class="sig-prename descclassname"><span class="pre">target.vdos.</span></span><span class="sig-name descname"><span class="pre">read_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natoms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/vdos.html#read_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.vdos.read_pos" title="Link to this definition"></a></dt>
<dd><p>Read atomic positions from a .pos file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to .pos file.</p></li>
<li><p><strong>natoms</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of atoms.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of (natoms+1)-line blocks (positions per frame).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="utility-modules">
<h2>Utility Modules<a class="headerlink" href="#utility-modules" title="Link to this heading"></a></h2>
<section id="module-target.json_serializable">
<span id="json-serialization"></span><h3>JSON Serialization<a class="headerlink" href="#module-target.json_serializable" title="Link to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="target.json_serializable.convert_to_serializable">
<span class="sig-prename descclassname"><span class="pre">target.json_serializable.</span></span><span class="sig-name descname"><span class="pre">convert_to_serializable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/target/json_serializable.html#convert_to_serializable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#target.json_serializable.convert_to_serializable" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-target.const">
<span id="constants"></span><h3>Constants<a class="headerlink" href="#module-target.const" title="Link to this heading"></a></h3>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="CPDyAna Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="samos_modules.html" class="btn btn-neutral float-right" title="SAMOS Modules" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Vinay Maithani.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>